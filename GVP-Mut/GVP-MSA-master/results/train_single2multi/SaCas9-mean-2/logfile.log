training on fold 0 
Epoch0,train total loss: 0.1650613172648427,  Spearman:0.18518526339338937
Epoch0,val total loss: 0.143781378865242,  Spearman:[0.9285714285714287]
Epoch0,test total loss: 0.049951916188001634,  Spearman is [-0.06913251813305744],
Epoch1,train total loss: 0.050110602064822346,  Spearman:0.5258842901999636
Epoch1,val total loss: 0.061764538288116455,  Spearman:[0.9761904761904763]
Epoch1,test total loss: 0.1760645855218172,  Spearman is [-0.033491786366649366],
Epoch2,train total loss: 0.030284499457010474,  Spearman:0.6072365495615423
Epoch2,val total loss: 0.0369013287127018,  Spearman:[0.9761904761904763]
Epoch2,test total loss: 0.31484669521451,  Spearman is [-0.03305491023171648],
Epoch3,train total loss: 0.02671578986188158,  Spearman:0.6348656245509963
Epoch3,val total loss: 0.028913425281643867,  Spearman:[0.9047619047619048]
Epoch3,test total loss: 0.47738676965236665,  Spearman is [-0.02165228133809056],
Epoch4,train total loss: 0.02219626437036846,  Spearman:0.6657466031380272
Epoch4,val total loss: 0.02857525646686554,  Spearman:[0.9047619047619048]
Epoch4,test total loss: 0.3132797881960869,  Spearman is [0.05988040303727227],
Epoch5,train total loss: 0.017409420754306782,  Spearman:0.7140050405136834
Epoch5,val total loss: 0.018721869215369225,  Spearman:[0.9285714285714287]
Epoch5,test total loss: 0.2353980902582407,  Spearman is [0.11139580915680844],
Epoch6,train total loss: 0.01528954525024463,  Spearman:0.7398298871985531
Epoch6,val total loss: 0.02306012436747551,  Spearman:[0.9285714285714287]
Epoch6,test total loss: 0.12111136326566338,  Spearman is [0.14129653274762097],
Epoch7,train total loss: 0.014542712906124787,  Spearman:0.7533734993878515
Epoch7,val total loss: 0.018692746758461,  Spearman:[0.9285714285714287]
Epoch7,test total loss: 0.1353823491372168,  Spearman is [0.14520724951997893],
Epoch8,train total loss: 0.013832865638109162,  Spearman:0.7629012230157797
Epoch8,val total loss: 0.012816837057471275,  Spearman:[0.9285714285714287]
Epoch8,test total loss: 0.18251068238168955,  Spearman is [0.15741706747430378],
Epoch9,train total loss: 0.013476109627682047,  Spearman:0.7685734627599857
Epoch9,val total loss: 0.018935218453407288,  Spearman:[0.9285714285714287]
Epoch9,test total loss: 0.1425587736070156,  Spearman is [0.15089873270837417],
Epoch10,train total loss: 0.012926298866752917,  Spearman:0.7769210842716121
Epoch10,val total loss: 0.02586643397808075,  Spearman:[0.9285714285714287]
Epoch10,test total loss: 0.10776713360100984,  Spearman is [0.15188758632679233],
Epoch11,train total loss: 0.012562821834133221,  Spearman:0.7813357721440074
Epoch11,val total loss: 0.03694231063127518,  Spearman:[0.9285714285714287]
Epoch11,test total loss: 0.07416097554378212,  Spearman is [0.15745599136632693],
Epoch12,train total loss: 0.012162480961519461,  Spearman:0.785864531356632
Epoch12,val total loss: 0.020236492156982422,  Spearman:[0.9285714285714287]
Epoch12,test total loss: 0.1284357354976237,  Spearman is [0.15841222756551301],
Epoch13,train total loss: 0.012032441273988344,  Spearman:0.7857947363732284
Epoch13,val total loss: 0.019101012498140335,  Spearman:[0.9285714285714287]
Epoch13,test total loss: 0.14759585969150066,  Spearman is [0.143479151029472],
Epoch14,train total loss: 0.01138604174588974,  Spearman:0.7930440495214307
Epoch14,val total loss: 0.03165523335337639,  Spearman:[0.9047619047619048]
Epoch14,test total loss: 0.08692886224016547,  Spearman is [0.14968108367666483],
Epoch15,train total loss: 0.011756702030722339,  Spearman:0.7871815937365935
Epoch15,val total loss: 0.024832576513290405,  Spearman:[0.9047619047619048]
Epoch15,test total loss: 0.10270084422081709,  Spearman is [0.1358626482580485],
Epoch16,train total loss: 0.01120570063059672,  Spearman:0.7982102426230774
Epoch16,val total loss: 0.030864937230944633,  Spearman:[0.9047619047619048]
Epoch16,test total loss: 0.08421858912333846,  Spearman is [0.15835957279216792],
Epoch17,train total loss: 0.010694353797962556,  Spearman:0.7966230105307869
Epoch17,val total loss: 0.020413342863321304,  Spearman:[0.9047619047619048]
Epoch17,test total loss: 0.11250121695920826,  Spearman is [0.13263331331910516],
Epoch18,train total loss: 0.010431374547083695,  Spearman:0.799135876791823
Epoch18,val total loss: 0.02061399631202221,  Spearman:[0.9047619047619048]
Epoch18,test total loss: 0.11384618589654565,  Spearman is [0.14863558359670118],
Epoch19,train total loss: 0.010377455405735722,  Spearman:0.7966607213494953
Epoch19,val total loss: 0.013541669584810734,  Spearman:[0.9047619047619048]
Epoch19,test total loss: 0.12642822079360486,  Spearman is [0.1541071688250756],
Epoch20,train total loss: 0.010217208800335916,  Spearman:0.8028488088722364
Epoch20,val total loss: 0.023524511605501175,  Spearman:[0.8333333333333335]
Epoch20,test total loss: 0.08680199384689331,  Spearman is [0.14826185767888245],
Epoch21,train total loss: 0.009677955955386354,  Spearman:0.8063744531457883
Epoch21,val total loss: 0.02052251435816288,  Spearman:[0.9047619047619048]
Epoch21,test total loss: 0.11857882533222437,  Spearman is [0.14133524620468133],
Epoch22,train total loss: 0.009014548864424562,  Spearman:0.8149587414256747
Epoch22,val total loss: 0.019247939810156822,  Spearman:[0.9047619047619048]
Epoch22,test total loss: 0.13306415174156427,  Spearman is [0.1625737302047735],
Epoch23,train total loss: 0.008594300639696227,  Spearman:0.8224695707507321
Epoch23,val total loss: 0.02159827947616577,  Spearman:[0.9047619047619048]
Epoch23,test total loss: 0.17758249286562205,  Spearman is [0.15791266153994707],
Epoch24,train total loss: 0.008141123095694452,  Spearman:0.8285536278007332
Epoch24,val total loss: 0.049094825983047485,  Spearman:[0.9047619047619048]
Epoch24,test total loss: 0.06811134088784457,  Spearman is [0.15806915939133542],
Epoch25,train total loss: 0.007888818201489555,  Spearman:0.8306241427538563
Epoch25,val total loss: 0.03292454779148102,  Spearman:[0.880952380952381]
Epoch25,test total loss: 0.0901297907344997,  Spearman is [0.15111973545194957],
Epoch26,train total loss: 0.007519378097733865,  Spearman:0.8357917735906303
Epoch26,val total loss: 0.03146558254957199,  Spearman:[0.9047619047619048]
Epoch26,test total loss: 0.11721459636464715,  Spearman is [0.1566940655509052],
Epoch27,train total loss: 0.007602394345807484,  Spearman:0.8303818725992751
Epoch27,val total loss: 0.0465012863278389,  Spearman:[0.9047619047619048]
Epoch27,test total loss: 0.07174168438650667,  Spearman is [0.16091331943526582],
Epoch28,train total loss: 0.007332824228050856,  Spearman:0.8406327112363152
Epoch28,val total loss: 0.04413660988211632,  Spearman:[0.9047619047619048]
Epoch28,test total loss: 0.07224011705256998,  Spearman is [0.16501422995742857],
Epoch29,train total loss: 0.007009354622240584,  Spearman:0.8417212053226115
Epoch29,val total loss: 0.02615705132484436,  Spearman:[0.9047619047619048]
Epoch29,test total loss: 0.11542785307392478,  Spearman is [0.1613128696686742],
Epoch30,train total loss: 0.006881688349098206,  Spearman:0.8447313884437567
Epoch30,val total loss: 0.03466253727674484,  Spearman:[0.8333333333333335]
Epoch30,test total loss: 0.09317903276532888,  Spearman is [0.15658475116382947],
Epoch31,train total loss: 0.0065850252009486444,  Spearman:0.8521290023912157
Epoch31,val total loss: 0.02469683438539505,  Spearman:[0.9523809523809524]
Epoch31,test total loss: 0.0946284992620349,  Spearman is [0.16894668729187962],
Epoch32,train total loss: 0.006504264672119648,  Spearman:0.8520371447230654
Epoch32,val total loss: 0.027865782380104065,  Spearman:[0.880952380952381]
Epoch32,test total loss: 0.12351027419790625,  Spearman is [0.16282698868248874],
Epoch33,train total loss: 0.006461461782097244,  Spearman:0.8541275079292723
Epoch33,val total loss: 0.053755465894937515,  Spearman:[0.880952380952381]
Epoch33,test total loss: 0.06468509994447232,  Spearman is [0.16129337813024597],
Epoch34,train total loss: 0.00628481409810961,  Spearman:0.8586759232644907
Epoch34,val total loss: 0.04393262416124344,  Spearman:[0.880952380952381]
Epoch34,test total loss: 0.08582398779690266,  Spearman is [0.16972388937038124],
Epoch35,train total loss: 0.005990415653333259,  Spearman:0.8608360013309796
Epoch35,val total loss: 0.04709663242101669,  Spearman:[0.880952380952381]
Epoch35,test total loss: 0.06949637895449996,  Spearman is [0.17508539738493986],
Epoch36,train total loss: 0.005810073686566634,  Spearman:0.8618071021054721
Epoch36,val total loss: 0.029226750135421753,  Spearman:[0.880952380952381]
Epoch36,test total loss: 0.09608849696815014,  Spearman is [0.17229955413007203],
Epoch37,train total loss: 0.0058134816697416585,  Spearman:0.8680692978126725
Epoch37,val total loss: 0.046241194009780884,  Spearman:[0.880952380952381]
Epoch37,test total loss: 0.07539002769626676,  Spearman is [0.1762312289095052],
Epoch38,train total loss: 0.005745464588145319,  Spearman:0.8672765780070136
Epoch38,val total loss: 0.04423500970005989,  Spearman:[0.8333333333333335]
Epoch38,test total loss: 0.06149373818188906,  Spearman is [0.17515176988742165],
Epoch39,train total loss: 0.0053879357352017015,  Spearman:0.8708942617377832
Epoch39,val total loss: 0.033936381340026855,  Spearman:[0.880952380952381]
Epoch39,test total loss: 0.06989252506755292,  Spearman is [0.17578871706322516],
Epoch40,train total loss: 0.005161157549502185,  Spearman:0.8726488989230791
Epoch40,val total loss: 0.03885509818792343,  Spearman:[0.880952380952381]
Epoch40,test total loss: 0.0588071845471859,  Spearman is [0.1730292965483724],
Epoch41,train total loss: 0.004922322553540699,  Spearman:0.8712204302305433
Epoch41,val total loss: 0.04218953102827072,  Spearman:[0.880952380952381]
Epoch41,test total loss: 0.046903413627296685,  Spearman is [0.18271950435621911],
Epoch42,train total loss: 0.004352143209708186,  Spearman:0.8730875562786617
Epoch42,val total loss: 0.03752311319112778,  Spearman:[0.880952380952381]
Epoch42,test total loss: 0.06016829670406878,  Spearman is [0.17758216218577033],
Epoch43,train total loss: 0.0038951113551425245,  Spearman:0.8788101662126656
Epoch43,val total loss: 0.02542867884039879,  Spearman:[0.9285714285714287]
Epoch43,test total loss: 0.0671281473711133,  Spearman is [0.19033160114560926],
Epoch44,train total loss: 0.003692395531032115,  Spearman:0.8814708036255741
Epoch44,val total loss: 0.039230622351169586,  Spearman:[0.9285714285714287]
Epoch44,test total loss: 0.04276776318438351,  Spearman is [0.18581591673569892],
Epoch45,train total loss: 0.0037596125195984943,  Spearman:0.8765440476504878
Epoch45,val total loss: 0.037035904824733734,  Spearman:[0.880952380952381]
Epoch45,test total loss: 0.04386489880271256,  Spearman is [0.18007184453488448],
Epoch46,train total loss: 0.0033103836045857184,  Spearman:0.8852359591168715
Epoch46,val total loss: 0.036622073501348495,  Spearman:[0.880952380952381]
Epoch46,test total loss: 0.03510479130782187,  Spearman is [0.17473725904337759],
Epoch47,train total loss: 0.0033355304540003627,  Spearman:0.8831592333712408
Epoch47,val total loss: 0.032141007483005524,  Spearman:[0.9285714285714287]
Epoch47,test total loss: 0.04154624904040247,  Spearman is [0.17736734096922682],
Epoch48,train total loss: 0.003321303909522099,  Spearman:0.8837409997502375
Epoch48,val total loss: 0.03407324105501175,  Spearman:[0.880952380952381]
Epoch48,test total loss: 0.05126087814569473,  Spearman is [0.17138241280131644],
Epoch49,train total loss: 0.003292749232152859,  Spearman:0.8860743393806553
Epoch49,val total loss: 0.022787272930145264,  Spearman:[0.880952380952381]
Epoch49,test total loss: 0.06113368987571448,  Spearman is [0.17521903016240276],
Early stop at epoch 49
ensemble idx 0, best epoch 1, best validation spearman is 0.9761904761904763,best test spearman is [-0.033491786366649366],

ensemble 1 models, fold 0, spearman is -0.033491786366649366, ndcg is 0.7486401624226097
training on fold 1 
Epoch0,train total loss: 0.08901947647786866,  Spearman:0.11537766719445486
Epoch0,val total loss: 0.11158648133277893,  Spearman:[0.14285714285714288]
Epoch0,test total loss: 0.09424934592097997,  Spearman is [-0.06627348954378756],
Epoch1,train total loss: 0.03930381598333136,  Spearman:0.5474797670690759
Epoch1,val total loss: 0.048870064318180084,  Spearman:[0.7857142857142858]
Epoch1,test total loss: 0.3668430298566818,  Spearman is [-0.04208690378033292],
Epoch2,train total loss: 0.02857662623342222,  Spearman:0.6311582745361511
Epoch2,val total loss: 0.03021872602403164,  Spearman:[0.7857142857142858]
Epoch2,test total loss: 0.28354622684419156,  Spearman is [-0.023675718722777753],
Epoch3,train total loss: 0.02432571841069521,  Spearman:0.6593984206690332
Epoch3,val total loss: 0.025439215824007988,  Spearman:[0.7619047619047621]
Epoch3,test total loss: 0.2668594092130661,  Spearman is [-0.016386810579674307],
Epoch4,train total loss: 0.017949175558243997,  Spearman:0.7017965901977243
Epoch4,val total loss: 0.024548012763261795,  Spearman:[0.8095238095238096]
Epoch4,test total loss: 0.13621020074933768,  Spearman is [0.10700533354975693],
Epoch5,train total loss: 0.014449143862853257,  Spearman:0.7511217639707727
Epoch5,val total loss: 0.015372385270893574,  Spearman:[0.7857142857142858]
Epoch5,test total loss: 0.07291017919778824,  Spearman is [0.12491329627426773],
Epoch6,train total loss: 0.012813553949877715,  Spearman:0.7726782740773173
Epoch6,val total loss: 0.017044994980096817,  Spearman:[0.7857142857142858]
Epoch6,test total loss: 0.03951881132088601,  Spearman is [0.14142491780319932],
Epoch7,train total loss: 0.011989846497248763,  Spearman:0.7886211341554474
Epoch7,val total loss: 0.01492059975862503,  Spearman:[0.7857142857142858]
Epoch7,test total loss: 0.043927316344343124,  Spearman is [0.1532861896982215],
Epoch8,train total loss: 0.01150429002994385,  Spearman:0.7947397973824679
Epoch8,val total loss: 0.016482481732964516,  Spearman:[0.7857142857142858]
Epoch8,test total loss: 0.07062438458669931,  Spearman is [0.15768595732409862],
Epoch9,train total loss: 0.010943634702692715,  Spearman:0.8040043008793275
Epoch9,val total loss: 0.016460496932268143,  Spearman:[0.7857142857142858]
Epoch9,test total loss: 0.06154873340856284,  Spearman is [0.15627478703973546],
Epoch10,train total loss: 0.010742207211501991,  Spearman:0.8069128859332443
Epoch10,val total loss: 0.017837855964899063,  Spearman:[0.7857142857142858]
Epoch10,test total loss: 0.05721736797131598,  Spearman is [0.16509121627334603],
Epoch11,train total loss: 0.010169380165349979,  Spearman:0.8158026677833208
Epoch11,val total loss: 0.017517056316137314,  Spearman:[0.7857142857142858]
Epoch11,test total loss: 0.058935902849771085,  Spearman is [0.16845972105971063],
Epoch12,train total loss: 0.010025769870620795,  Spearman:0.8179685529969077
Epoch12,val total loss: 0.017293507233262062,  Spearman:[0.7857142857142858]
Epoch12,test total loss: 0.05333479549735785,  Spearman is [0.17169716432081386],
Epoch13,train total loss: 0.009593740227268053,  Spearman:0.8259832591175122
Epoch13,val total loss: 0.019485043361783028,  Spearman:[0.7857142857142858]
Epoch13,test total loss: 0.051403209543786944,  Spearman is [0.17126597678753408],
Epoch14,train total loss: 0.009369170503655018,  Spearman:0.8263723352624495
Epoch14,val total loss: 0.025210697203874588,  Spearman:[0.7857142857142858]
Epoch14,test total loss: 0.06860215498600156,  Spearman is [0.16770055720317545],
Epoch15,train total loss: 0.009098888053976668,  Spearman:0.8330115712937699
Epoch15,val total loss: 0.019384505227208138,  Spearman:[0.7857142857142858]
Epoch15,test total loss: 0.04731796365231276,  Spearman is [0.17040643517218387],
Epoch16,train total loss: 0.0088824719177165,  Spearman:0.8315119883502773
Epoch16,val total loss: 0.015664618462324142,  Spearman:[0.7857142857142858]
Epoch16,test total loss: 0.04409344005398452,  Spearman is [0.17664089317331258],
Epoch17,train total loss: 0.008487650430582177,  Spearman:0.834403427444284
Epoch17,val total loss: 0.017196571454405785,  Spearman:[0.7857142857142858]
Epoch17,test total loss: 0.05072020459920168,  Spearman is [0.18502477991700517],
Epoch18,train total loss: 0.008479732082774624,  Spearman:0.8336861378895895
Epoch18,val total loss: 0.01614895649254322,  Spearman:[0.7857142857142858]
Epoch18,test total loss: 0.04632463245652616,  Spearman is [0.1752391069730712],
Epoch19,train total loss: 0.00817981807855316,  Spearman:0.8405929690711135
Epoch19,val total loss: 0.015951577574014664,  Spearman:[0.7857142857142858]
Epoch19,test total loss: 0.06694354289211332,  Spearman is [0.17877138276922552],
Epoch20,train total loss: 0.007876867492599651,  Spearman:0.8410996972098639
Epoch20,val total loss: 0.01480807550251484,  Spearman:[0.7857142857142858]
Epoch20,test total loss: 0.05304501843638718,  Spearman is [0.18027373715340175],
Epoch21,train total loss: 0.007756368722020386,  Spearman:0.8442540044871624
Epoch21,val total loss: 0.015850704163312912,  Spearman:[0.7857142857142858]
Epoch21,test total loss: 0.05232432740740478,  Spearman is [0.17288548397958464],
Epoch22,train total loss: 0.007556933305936699,  Spearman:0.8476730704318335
Epoch22,val total loss: 0.015113620087504387,  Spearman:[0.7857142857142858]
Epoch22,test total loss: 0.05873654140159488,  Spearman is [0.17934483777110036],
Epoch23,train total loss: 0.00723212668657279,  Spearman:0.8551036098595695
Epoch23,val total loss: 0.01492843683809042,  Spearman:[0.7857142857142858]
Epoch23,test total loss: 0.05812601502984762,  Spearman is [0.1790992535934343],
Epoch24,train total loss: 0.006942396793956271,  Spearman:0.8626035399852299
Epoch24,val total loss: 0.012626784853637218,  Spearman:[0.7857142857142858]
Epoch24,test total loss: 0.053633829951286315,  Spearman is [0.18329680637225737],
Epoch25,train total loss: 0.006985041794205944,  Spearman:0.8621294000284919
Epoch25,val total loss: 0.012800537049770355,  Spearman:[0.7857142857142858]
Epoch25,test total loss: 0.06293557344470173,  Spearman is [0.1822471436256861],
Epoch26,train total loss: 0.0068676473366884655,  Spearman:0.8618937996598277
Epoch26,val total loss: 0.014308735728263855,  Spearman:[0.7857142857142858]
Epoch26,test total loss: 0.07024969053454697,  Spearman is [0.18450000115246026],
Epoch27,train total loss: 0.006614114689933232,  Spearman:0.869234428983647
Epoch27,val total loss: 0.01654844358563423,  Spearman:[0.880952380952381]
Epoch27,test total loss: 0.08961323769763112,  Spearman is [0.17888919346792384],
Epoch28,train total loss: 0.0065294941342495475,  Spearman:0.8692761600690484
Epoch28,val total loss: 0.015749026089906693,  Spearman:[0.7857142857142858]
Epoch28,test total loss: 0.07571158660575747,  Spearman is [0.17751708517352816],
Epoch29,train total loss: 0.006336565860039674,  Spearman:0.873217552315505
Epoch29,val total loss: 0.014322902075946331,  Spearman:[0.880952380952381]
Epoch29,test total loss: 0.06806987589225173,  Spearman is [0.1788752126950836],
Epoch30,train total loss: 0.00634464338565102,  Spearman:0.8722656387584712
Epoch30,val total loss: 0.014556345529854298,  Spearman:[0.880952380952381]
Epoch30,test total loss: 0.06978327259421349,  Spearman is [0.1768731278830268],
Epoch31,train total loss: 0.0061650062345553385,  Spearman:0.8756714336208011
Epoch31,val total loss: 0.014220425859093666,  Spearman:[0.8095238095238096]
Epoch31,test total loss: 0.07681524814106525,  Spearman is [0.17510705903392182],
Epoch32,train total loss: 0.00615819917472366,  Spearman:0.8749733892223289
Epoch32,val total loss: 0.01504149567335844,  Spearman:[0.880952380952381]
Epoch32,test total loss: 0.07567144124768674,  Spearman is [0.17745538827287577],
Epoch33,train total loss: 0.006125017864038595,  Spearman:0.8763407466209622
Epoch33,val total loss: 0.01685258001089096,  Spearman:[0.880952380952381]
Epoch33,test total loss: 0.06445346041582525,  Spearman is [0.1752815622268137],
Epoch34,train total loss: 0.005953409739632685,  Spearman:0.8776206655219051
Epoch34,val total loss: 0.017378611490130424,  Spearman:[0.8571428571428572]
Epoch34,test total loss: 0.08906269371509552,  Spearman is [0.1805568576675551],
Epoch35,train total loss: 0.005989201876591557,  Spearman:0.8779926881080148
Epoch35,val total loss: 0.017232010141015053,  Spearman:[0.8095238095238096]
Epoch35,test total loss: 0.0827245709951967,  Spearman is [0.17424145454277148],
Epoch36,train total loss: 0.0055987773282536995,  Spearman:0.8853340893927265
Epoch36,val total loss: 0.015386858023703098,  Spearman:[0.880952380952381]
Epoch36,test total loss: 0.088722906075418,  Spearman is [0.17302955959207592],
Epoch37,train total loss: 0.005462100531589478,  Spearman:0.8823033047984512
Epoch37,val total loss: 0.021772058680653572,  Spearman:[0.880952380952381]
Epoch37,test total loss: 0.10142421913333237,  Spearman is [0.17078171304785317],
Epoch38,train total loss: 0.004649827045982537,  Spearman:0.8901108160615326
Epoch38,val total loss: 0.02067081816494465,  Spearman:[0.880952380952381]
Epoch38,test total loss: 0.09242078647948801,  Spearman is [0.16749077327355366],
Epoch39,train total loss: 0.0038366900124133397,  Spearman:0.8938199925896341
Epoch39,val total loss: 0.021584464237093925,  Spearman:[0.880952380952381]
Epoch39,test total loss: 0.07661580154672265,  Spearman is [0.17105734339254983],
Epoch40,train total loss: 0.003258620749618739,  Spearman:0.9006704868290254
Epoch40,val total loss: 0.021213216707110405,  Spearman:[0.880952380952381]
Epoch40,test total loss: 0.08689880692400039,  Spearman is [0.16974281536484698],
Epoch41,train total loss: 0.003248755391746855,  Spearman:0.8990762073673277
Epoch41,val total loss: 0.02283020317554474,  Spearman:[0.880952380952381]
Epoch41,test total loss: 0.08496104255318641,  Spearman is [0.17408191196051534],
Epoch42,train total loss: 0.002893727675351935,  Spearman:0.9101636723426384
Epoch42,val total loss: 0.022975189611315727,  Spearman:[0.880952380952381]
Epoch42,test total loss: 0.07802214948460459,  Spearman is [0.17517853458425126],
Epoch43,train total loss: 0.0029802663607719857,  Spearman:0.9065318003963221
Epoch43,val total loss: 0.024687420576810837,  Spearman:[0.880952380952381]
Epoch43,test total loss: 0.0736005158163607,  Spearman is [0.17962789910042043],
Epoch44,train total loss: 0.0029594887356581287,  Spearman:0.9070992807689643
Epoch44,val total loss: 0.022477593272924423,  Spearman:[0.880952380952381]
Epoch44,test total loss: 0.07347848881036043,  Spearman is [0.17825163471550973],
Epoch45,train total loss: 0.0029136501008253666,  Spearman:0.9073211469677055
Epoch45,val total loss: 0.026358265429735184,  Spearman:[0.880952380952381]
Epoch45,test total loss: 0.077007712633349,  Spearman is [0.17696835627978091],
Epoch46,train total loss: 0.0029174157780989143,  Spearman:0.9072294827196887
Epoch46,val total loss: 0.025794178247451782,  Spearman:[0.880952380952381]
Epoch46,test total loss: 0.06938764937222004,  Spearman is [0.17816636909902514],
Epoch47,train total loss: 0.0027788020968914796,  Spearman:0.9103460404105572
Epoch47,val total loss: 0.02772967889904976,  Spearman:[0.880952380952381]
Epoch47,test total loss: 0.08041045097634196,  Spearman is [0.1800847271002627],
Epoch48,train total loss: 0.0028051961958109853,  Spearman:0.9086268914271599
Epoch48,val total loss: 0.0262945257127285,  Spearman:[0.880952380952381]
Epoch48,test total loss: 0.06810365356504917,  Spearman is [0.18016851967200778],
Epoch49,train total loss: 0.002597753042116379,  Spearman:0.9165107220723018
Epoch49,val total loss: 0.02676801010966301,  Spearman:[0.880952380952381]
Epoch49,test total loss: 0.06602299399673939,  Spearman is [0.18057242327870884],
Early stop at epoch 49
ensemble idx 0, best epoch 27, best validation spearman is 0.880952380952381,best test spearman is [0.17889188308979198],

ensemble 1 models, fold 1, spearman is 0.17889188308979198, ndcg is 0.8052387642482254
training on fold 0 
Epoch0,train total loss: 0.12093154416204645,  Spearman:0.15211526404819295
Epoch0,val total loss: 0.05531781166791916,  Spearman:[0.880952380952381]
Epoch0,test total loss: 0.027554620150476695,  Spearman is [-0.04836699328792369],
Epoch1,train total loss: 0.04566738681079677,  Spearman:0.5273248470469897
Epoch1,val total loss: 0.0662502571940422,  Spearman:[0.9523809523809524]
Epoch1,test total loss: 0.10732099749147891,  Spearman is [-0.052610269638505056],
Epoch2,train total loss: 0.031148944987366214,  Spearman:0.6001034353837303
Epoch2,val total loss: 0.06783667206764221,  Spearman:[0.9523809523809524]
Epoch2,test total loss: 0.2066876355558634,  Spearman is [-0.024724651523071867],
Epoch3,train total loss: 0.024972415559041578,  Spearman:0.6409031322291309
Epoch3,val total loss: 0.026381276547908783,  Spearman:[0.9047619047619048]
Epoch3,test total loss: 0.23008189499378204,  Spearman is [0.0007407343570597516],
Epoch4,train total loss: 0.019017418207696233,  Spearman:0.6787690827221808
Epoch4,val total loss: 0.018126383423805237,  Spearman:[0.9047619047619048]
Epoch4,test total loss: 0.20390353221446275,  Spearman is [0.08249032457031623],
Epoch5,train total loss: 0.015902217632780474,  Spearman:0.7239794402791404
Epoch5,val total loss: 0.013422604650259018,  Spearman:[0.9047619047619048]
Epoch5,test total loss: 0.23090289924293755,  Spearman is [0.10527494657902968],
Epoch6,train total loss: 0.015033406954712402,  Spearman:0.7344258390189032
Epoch6,val total loss: 0.021270494908094406,  Spearman:[0.9285714285714287]
Epoch6,test total loss: 0.12380877938121557,  Spearman is [0.1195671302837149],
Epoch7,train total loss: 0.014283132282658838,  Spearman:0.7445372102477407
Epoch7,val total loss: 0.014833604916930199,  Spearman:[0.9047619047619048]
Epoch7,test total loss: 0.10125058232806623,  Spearman is [0.15505930811857987],
Epoch8,train total loss: 0.013676415036360804,  Spearman:0.755899824551897
Epoch8,val total loss: 0.01570029929280281,  Spearman:[0.9285714285714287]
Epoch8,test total loss: 0.09610342332161963,  Spearman is [0.1592626281306019],
Epoch9,train total loss: 0.013235108841819545,  Spearman:0.7640333020547835
Epoch9,val total loss: 0.01648326963186264,  Spearman:[0.9285714285714287]
Epoch9,test total loss: 0.07994721783325076,  Spearman is [0.1512276754356746],
Epoch10,train total loss: 0.01245909123472535,  Spearman:0.775876608071555
Epoch10,val total loss: 0.017952557653188705,  Spearman:[0.9285714285714287]
Epoch10,test total loss: 0.08915640143677592,  Spearman is [0.16125868266575633],
Epoch11,train total loss: 0.012354910149812125,  Spearman:0.7774281130966475
Epoch11,val total loss: 0.021520942449569702,  Spearman:[0.9285714285714287]
Epoch11,test total loss: 0.10666686240583659,  Spearman is [0.149298821990668],
Epoch12,train total loss: 0.011862184729976341,  Spearman:0.7824661657511608
Epoch12,val total loss: 0.02651456743478775,  Spearman:[0.9285714285714287]
Epoch12,test total loss: 0.10866741365753115,  Spearman is [0.1497457990038147],
Epoch13,train total loss: 0.011565766955475109,  Spearman:0.7870465885760288
Epoch13,val total loss: 0.01868780143558979,  Spearman:[0.9285714285714287]
Epoch13,test total loss: 0.1465029114857316,  Spearman is [0.14981582123768236],
Epoch14,train total loss: 0.01082832825023872,  Spearman:0.7967139704508187
Epoch14,val total loss: 0.016690876334905624,  Spearman:[0.9285714285714287]
Epoch14,test total loss: 0.11290451800450682,  Spearman is [0.15870475189206595],
Epoch15,train total loss: 0.010247969884986583,  Spearman:0.7952204914641338
Epoch15,val total loss: 0.02128247171640396,  Spearman:[0.9285714285714287]
Epoch15,test total loss: 0.20109236016869544,  Spearman is [0.13327779669701348],
Epoch16,train total loss: 0.009565338741641683,  Spearman:0.7999690764776782
Epoch16,val total loss: 0.01390160247683525,  Spearman:[0.9285714285714287]
Epoch16,test total loss: 0.23557354807853698,  Spearman is [0.12535408518428998],
Epoch17,train total loss: 0.0088332745542105,  Spearman:0.8042533616583987
Epoch17,val total loss: 0.023122230544686317,  Spearman:[0.9285714285714287]
Epoch17,test total loss: 0.19791385531425476,  Spearman is [0.12473931916878282],
Epoch18,train total loss: 0.008626790012782201,  Spearman:0.8061714532369515
Epoch18,val total loss: 0.027998171746730804,  Spearman:[0.9285714285714287]
Epoch18,test total loss: 0.19235633946955205,  Spearman is [0.1266670086454015],
Epoch19,train total loss: 0.00811512317084588,  Spearman:0.8130943988717577
Epoch19,val total loss: 0.024168938398361206,  Spearman:[0.9285714285714287]
Epoch19,test total loss: 0.2145254582166672,  Spearman is [0.12490318224386873],
Epoch20,train total loss: 0.007717297423648863,  Spearman:0.8189895121927981
Epoch20,val total loss: 0.019398419186472893,  Spearman:[0.9285714285714287]
Epoch20,test total loss: 0.2077020063996315,  Spearman is [0.128505539458724],
Epoch21,train total loss: 0.007043196668979736,  Spearman:0.8218856659726942
Epoch21,val total loss: 0.009719297289848328,  Spearman:[0.9761904761904763]
Epoch21,test total loss: 0.259105321764946,  Spearman is [0.12574129209191232],
Epoch22,train total loss: 0.0069035030759644145,  Spearman:0.8212116081303064
Epoch22,val total loss: 0.016595304012298584,  Spearman:[0.9285714285714287]
Epoch22,test total loss: 0.1787179397419095,  Spearman is [0.12884583909792238],
Epoch23,train total loss: 0.006076806450996978,  Spearman:0.8276028161827867
Epoch23,val total loss: 0.02144712209701538,  Spearman:[0.9285714285714287]
Epoch23,test total loss: 0.17816781923174857,  Spearman is [0.13133832286247868],
Epoch24,train total loss: 0.005439787500131971,  Spearman:0.8343220664128731
Epoch24,val total loss: 0.013316669501364231,  Spearman:[0.9285714285714287]
Epoch24,test total loss: 0.19775524009019135,  Spearman is [0.1304040179320707],
Epoch25,train total loss: 0.0047148261719251955,  Spearman:0.8373623777348
Epoch25,val total loss: 0.00944663118571043,  Spearman:[0.9285714285714287]
Epoch25,test total loss: 0.19914459213614463,  Spearman is [0.135768412851275],
Epoch26,train total loss: 0.004367593144520353,  Spearman:0.8383611161488032
Epoch26,val total loss: 0.027506470680236816,  Spearman:[0.9285714285714287]
Epoch26,test total loss: 0.15293076932430266,  Spearman is [0.1363534220478254],
Epoch27,train total loss: 0.004066559753249375,  Spearman:0.841715553256771
Epoch27,val total loss: 0.008710641413927078,  Spearman:[0.9285714285714287]
Epoch27,test total loss: 0.18914270717650652,  Spearman is [0.1360602006554582],
Epoch28,train total loss: 0.003725969899021901,  Spearman:0.8544823115344788
Epoch28,val total loss: 0.025965120643377304,  Spearman:[0.9761904761904763]
Epoch28,test total loss: 0.16055296882987022,  Spearman is [0.1321438679000308],
Epoch29,train total loss: 0.0037227348758068937,  Spearman:0.8513453541943143
Epoch29,val total loss: 0.023737283423542976,  Spearman:[0.9523809523809524]
Epoch29,test total loss: 0.16869854796677827,  Spearman is [0.1390714066032867],
Epoch30,train total loss: 0.0036152732783916574,  Spearman:0.8505940497112975
Epoch30,val total loss: 0.03384963795542717,  Spearman:[0.9523809523809524]
Epoch30,test total loss: 0.11249410957098008,  Spearman is [0.1399997404416256],
Epoch31,train total loss: 0.0035850465967833325,  Spearman:0.8556633105402143
Epoch31,val total loss: 0.018038243055343628,  Spearman:[0.9761904761904763]
Epoch31,test total loss: 0.1617715023458004,  Spearman is [0.14067817618556125],
Epoch32,train total loss: 0.003320444460349301,  Spearman:0.8615387899244468
Epoch32,val total loss: 0.026655862107872963,  Spearman:[0.9761904761904763]
Epoch32,test total loss: 0.14354442358016967,  Spearman is [0.13737881901275023],
Epoch33,train total loss: 0.0034421346850323086,  Spearman:0.8614610080372739
Epoch33,val total loss: 0.027816802263259888,  Spearman:[0.9761904761904763]
Epoch33,test total loss: 0.13123198347166182,  Spearman is [0.13502630737891086],
Epoch34,train total loss: 0.0033878130750217214,  Spearman:0.8624037190277022
Epoch34,val total loss: 0.015698757022619247,  Spearman:[0.9285714285714287]
Epoch34,test total loss: 0.1588370812125504,  Spearman is [0.13255440020805967],
Epoch35,train total loss: 0.003288479841639622,  Spearman:0.8696132174224529
Epoch35,val total loss: 0.01380361057817936,  Spearman:[0.9761904761904763]
Epoch35,test total loss: 0.14401909448206424,  Spearman is [0.138607785499802],
Epoch36,train total loss: 0.0031652721036852407,  Spearman:0.8743570967955601
Epoch36,val total loss: 0.022228457033634186,  Spearman:[0.9523809523809524]
Epoch36,test total loss: 0.12288498561829328,  Spearman is [0.13311874732170134],
Epoch37,train total loss: 0.0031369284839363387,  Spearman:0.8742349472278357
Epoch37,val total loss: 0.0185721293091774,  Spearman:[0.9523809523809524]
Epoch37,test total loss: 0.14395780293270946,  Spearman is [0.1369998585252321],
Epoch38,train total loss: 0.0030787397901384304,  Spearman:0.8752414711572833
Epoch38,val total loss: 0.016382258385419846,  Spearman:[0.9761904761904763]
Epoch38,test total loss: 0.13915232168510555,  Spearman is [0.1346218448043399],
Epoch39,train total loss: 0.003003006442061936,  Spearman:0.8774689779227017
Epoch39,val total loss: 0.010333837009966373,  Spearman:[0.9285714285714287]
Epoch39,test total loss: 0.18099259687587618,  Spearman is [0.1371676869841481],
Epoch40,train total loss: 0.0029845268561471947,  Spearman:0.8821568966384783
Epoch40,val total loss: 0.00769828911870718,  Spearman:[0.9761904761904763]
Epoch40,test total loss: 0.16667685601860285,  Spearman is [0.1322917642223152],
Epoch41,train total loss: 0.003074398285370523,  Spearman:0.8809833796644102
Epoch41,val total loss: 0.010317309759557247,  Spearman:[0.9523809523809524]
Epoch41,test total loss: 0.15693428739905357,  Spearman is [0.13136402223230914],
Epoch42,train total loss: 0.00293686919254609,  Spearman:0.8890345326892122
Epoch42,val total loss: 0.009361913427710533,  Spearman:[0.9761904761904763]
Epoch42,test total loss: 0.1852565363049507,  Spearman is [0.12865966991678096],
Epoch43,train total loss: 0.0028203676289801174,  Spearman:0.8918087576758187
Epoch43,val total loss: 0.013230412267148495,  Spearman:[0.9523809523809524]
Epoch43,test total loss: 0.15826936662197114,  Spearman is [0.13662520537835862],
Epoch44,train total loss: 0.0029503974902371946,  Spearman:0.8866534754085418
Epoch44,val total loss: 0.02921709604561329,  Spearman:[0.9285714285714287]
Epoch44,test total loss: 0.09860344221815467,  Spearman is [0.13696332833091068],
Epoch45,train total loss: 0.00273814754268059,  Spearman:0.8940865788476721
Epoch45,val total loss: 0.038370996713638306,  Spearman:[0.9285714285714287]
Epoch45,test total loss: 0.10995247899554669,  Spearman is [0.12971546158164346],
Epoch46,train total loss: 0.0027407480356020806,  Spearman:0.894501986502639
Epoch46,val total loss: 0.00839174259454012,  Spearman:[0.9285714285714287]
Epoch46,test total loss: 0.17230002330616118,  Spearman is [0.13456459334227638],
Epoch47,train total loss: 0.0027475829075018945,  Spearman:0.8939292611488856
Epoch47,val total loss: 0.010607251897454262,  Spearman:[0.9285714285714287]
Epoch47,test total loss: 0.21741684153676033,  Spearman is [0.1355183898111126],
Epoch48,train total loss: 0.002822002495239035,  Spearman:0.8964685099697124
Epoch48,val total loss: 0.015240030363202095,  Spearman:[0.9047619047619048]
Epoch48,test total loss: 0.1642340655438602,  Spearman is [0.13591102199511934],
Epoch49,train total loss: 0.0027571640170301693,  Spearman:0.8992408757048924
Epoch49,val total loss: 0.02460847795009613,  Spearman:[0.9047619047619048]
Epoch49,test total loss: 0.1258310333825648,  Spearman is [0.13342761981442589],
Early stop at epoch 49
ensemble idx 0, best epoch 21, best validation spearman is 0.9761904761904763,best test spearman is [0.1257396480687655],

ensemble 1 models, fold 0, spearman is 0.1257396480687655, ndcg is 0.7472292812341261
training on fold 1 
Epoch0,train total loss: 0.11831269481290992,  Spearman:0.09938197522555896
Epoch0,val total loss: 0.08213883638381958,  Spearman:[0.4523809523809524]
Epoch0,test total loss: 0.02185764559544623,  Spearman is [0.06874775753187749],
Epoch1,train total loss: 0.04997007728506548,  Spearman:0.4867783710386592
Epoch1,val total loss: 0.16338470578193665,  Spearman:[0.5952380952380953]
Epoch1,test total loss: 0.0768970413133502,  Spearman is [-0.045917734179942556],
Epoch2,train total loss: 0.03557736675541561,  Spearman:0.5865413741196384
Epoch2,val total loss: 0.04305065795779228,  Spearman:[0.7619047619047621]
Epoch2,test total loss: 0.3681540124118328,  Spearman is [-0.02505011549739373],
Epoch3,train total loss: 0.028384114699199412,  Spearman:0.630102506265929
Epoch3,val total loss: 0.02674379199743271,  Spearman:[0.880952380952381]
Epoch3,test total loss: 0.36947848573327063,  Spearman is [-0.022135321642985047],
Epoch4,train total loss: 0.024404333531259537,  Spearman:0.6593858508976153
Epoch4,val total loss: 0.01978108659386635,  Spearman:[0.7857142857142858]
Epoch4,test total loss: 0.232097140699625,  Spearman is [0.0512388847985319],
Epoch5,train total loss: 0.017726750808576934,  Spearman:0.7137391766771691
Epoch5,val total loss: 0.02439889684319496,  Spearman:[0.7857142857142858]
Epoch5,test total loss: 0.15839657001197338,  Spearman is [0.14120092951358937],
Epoch6,train total loss: 0.015340560372584524,  Spearman:0.7426267342381669
Epoch6,val total loss: 0.018290886655449867,  Spearman:[0.7857142857142858]
Epoch6,test total loss: 0.0954405979719013,  Spearman is [0.14085794025252282],
Epoch7,train total loss: 0.013749960208466897,  Spearman:0.7679380158521775
Epoch7,val total loss: 0.027843259274959564,  Spearman:[0.7619047619047621]
Epoch7,test total loss: 0.11283920668065547,  Spearman is [0.14100135825575535],
Epoch8,train total loss: 0.01267035728923451,  Spearman:0.7773948593584107
Epoch8,val total loss: 0.014215631410479546,  Spearman:[0.7857142857142858]
Epoch8,test total loss: 0.08101825201883912,  Spearman is [0.17408224734123726],
Epoch9,train total loss: 0.012008658407303767,  Spearman:0.7900558780390126
Epoch9,val total loss: 0.01473051868379116,  Spearman:[0.7857142857142858]
Epoch9,test total loss: 0.09755585948005319,  Spearman is [0.17227880655795966],
Epoch10,train total loss: 0.01126112079528423,  Spearman:0.8012020714397167
Epoch10,val total loss: 0.026471424847841263,  Spearman:[0.7857142857142858]
Epoch10,test total loss: 0.10832721600309014,  Spearman is [0.17941637908235566],
Epoch11,train total loss: 0.010730372162726827,  Spearman:0.8089499537282216
Epoch11,val total loss: 0.01620250940322876,  Spearman:[0.7857142857142858]
Epoch11,test total loss: 0.08060008701868356,  Spearman is [0.16776718617326816],
Epoch12,train total loss: 0.009958108107989224,  Spearman:0.8150533504929532
Epoch12,val total loss: 0.01840347610414028,  Spearman:[0.8095238095238096]
Epoch12,test total loss: 0.10925860740244389,  Spearman is [0.17543141164859646],
Epoch13,train total loss: 0.009729183989409834,  Spearman:0.8188506892313617
Epoch13,val total loss: 0.015511417761445045,  Spearman:[0.7857142857142858]
Epoch13,test total loss: 0.08818440120667219,  Spearman is [0.17808662740031367],
Epoch14,train total loss: 0.009276596126325715,  Spearman:0.8258678695862643
Epoch14,val total loss: 0.015329008921980858,  Spearman:[0.8095238095238096]
Epoch14,test total loss: 0.10370417758822441,  Spearman is [0.1779359625430501],
Epoch15,train total loss: 0.008942703486611255,  Spearman:0.8338737778583897
Epoch15,val total loss: 0.016590531915426254,  Spearman:[0.7857142857142858]
Epoch15,test total loss: 0.08432615734636784,  Spearman is [0.16828606618276248],
Epoch16,train total loss: 0.008427365759136872,  Spearman:0.8388084455672866
Epoch16,val total loss: 0.015747597441077232,  Spearman:[0.8095238095238096]
Epoch16,test total loss: 0.12358725275844336,  Spearman is [0.15753745600129623],
Epoch17,train total loss: 0.008307712307074465,  Spearman:0.8415240526242842
Epoch17,val total loss: 0.015750480815768242,  Spearman:[0.8095238095238096]
Epoch17,test total loss: 0.0809504687320441,  Spearman is [0.1566504529048674],
Epoch18,train total loss: 0.008238581824116409,  Spearman:0.8431014122830122
Epoch18,val total loss: 0.01534825749695301,  Spearman:[0.8095238095238096]
Epoch18,test total loss: 0.08070370345376432,  Spearman is [0.15499384311687509],
Epoch19,train total loss: 0.007785738068961132,  Spearman:0.8474343499133103
Epoch19,val total loss: 0.013920193538069725,  Spearman:[0.8095238095238096]
Epoch19,test total loss: 0.08822141629643739,  Spearman is [0.15710670878465455],
Epoch20,train total loss: 0.007523415831831069,  Spearman:0.852968664226981
Epoch20,val total loss: 0.015585003420710564,  Spearman:[0.8095238095238096]
Epoch20,test total loss: 0.10331869083456695,  Spearman is [0.15020997249907672],
Epoch21,train total loss: 0.007188926537473423,  Spearman:0.8588076204566674
Epoch21,val total loss: 0.016986820846796036,  Spearman:[0.8095238095238096]
Epoch21,test total loss: 0.10599939338862896,  Spearman is [0.15956346463818497],
Epoch22,train total loss: 0.007327922301975867,  Spearman:0.8592216580134114
Epoch22,val total loss: 0.017683228477835655,  Spearman:[0.8095238095238096]
Epoch22,test total loss: 0.10947879338636994,  Spearman is [0.15349195563527257],
Epoch23,train total loss: 0.006994047535744567,  Spearman:0.8617390420928365
Epoch23,val total loss: 0.01773383654654026,  Spearman:[0.880952380952381]
Epoch23,test total loss: 0.09111957014538348,  Spearman is [0.1503217200404097],
Epoch24,train total loss: 0.006816248767651045,  Spearman:0.8652574218858456
Epoch24,val total loss: 0.017151501029729843,  Spearman:[0.8095238095238096]
Epoch24,test total loss: 0.11459426991641522,  Spearman is [0.1500252369061193],
Epoch25,train total loss: 0.006647170353412198,  Spearman:0.8700359477147381
Epoch25,val total loss: 0.0158297847956419,  Spearman:[0.880952380952381]
Epoch25,test total loss: 0.11100000031292438,  Spearman is [0.15446160706333634],
Epoch26,train total loss: 0.006634231085906952,  Spearman:0.8686769364906343
Epoch26,val total loss: 0.018733976408839226,  Spearman:[0.9285714285714287]
Epoch26,test total loss: 0.1174696939997375,  Spearman is [0.15046989913467532],
Epoch27,train total loss: 0.006555519580918674,  Spearman:0.8678770573144651
Epoch27,val total loss: 0.01681871898472309,  Spearman:[0.8095238095238096]
Epoch27,test total loss: 0.13991694413125516,  Spearman is [0.145893642335945],
Epoch28,train total loss: 0.006157368891693365,  Spearman:0.8737842712844676
Epoch28,val total loss: 0.01756366342306137,  Spearman:[0.880952380952381]
Epoch28,test total loss: 0.1256844994612038,  Spearman is [0.1480943251441329],
Epoch29,train total loss: 0.006115288410234289,  Spearman:0.875361554267052
Epoch29,val total loss: 0.01610475219786167,  Spearman:[0.880952380952381]
Epoch29,test total loss: 0.12009813012555241,  Spearman is [0.14681250660095846],
Epoch30,train total loss: 0.005932664391972746,  Spearman:0.8701411395727355
Epoch30,val total loss: 0.018286781385540962,  Spearman:[0.880952380952381]
Epoch30,test total loss: 0.12378767915070057,  Spearman is [0.14451592463457255],
Epoch31,train total loss: 0.005454007498114011,  Spearman:0.8741020908026198
Epoch31,val total loss: 0.021742891520261765,  Spearman:[0.880952380952381]
Epoch31,test total loss: 0.11567029566504061,  Spearman is [0.14414295496740132],
Epoch32,train total loss: 0.004776024211493608,  Spearman:0.8798969257590635
Epoch32,val total loss: 0.02457631751894951,  Spearman:[0.880952380952381]
Epoch32,test total loss: 0.1352400079369545,  Spearman is [0.1547202184804175],
Epoch33,train total loss: 0.004296384585382513,  Spearman:0.8856700773300193
Epoch33,val total loss: 0.02710207924246788,  Spearman:[0.8095238095238096]
Epoch33,test total loss: 0.1715526747982949,  Spearman is [0.15133689775745413],
Epoch34,train total loss: 0.004303149675998168,  Spearman:0.8822269304914182
Epoch34,val total loss: 0.028877191245555878,  Spearman:[0.880952380952381]
Epoch34,test total loss: 0.1831307142972946,  Spearman is [0.15890596717304672],
Epoch35,train total loss: 0.004103355249987008,  Spearman:0.8840693772895963
Epoch35,val total loss: 0.02803102135658264,  Spearman:[0.880952380952381]
Epoch35,test total loss: 0.15690105119720102,  Spearman is [0.15827461625203487],
Epoch36,train total loss: 0.0038339635144578866,  Spearman:0.8893802319458967
Epoch36,val total loss: 0.023926055058836937,  Spearman:[0.880952380952381]
Epoch36,test total loss: 0.1500064785592258,  Spearman is [0.1472335540810341],
Epoch37,train total loss: 0.0037101895808845232,  Spearman:0.8889854283500104
Epoch37,val total loss: 0.027759680524468422,  Spearman:[0.8571428571428572]
Epoch37,test total loss: 0.15804326650686562,  Spearman is [0.15815235353865512],
Epoch38,train total loss: 0.003602036538769682,  Spearman:0.8907947463378553
Epoch38,val total loss: 0.028539519757032394,  Spearman:[0.880952380952381]
Epoch38,test total loss: 0.1744832480326295,  Spearman is [0.15407255884978957],
Epoch39,train total loss: 0.0035083019473136235,  Spearman:0.8933260162266151
Epoch39,val total loss: 0.028701066970825195,  Spearman:[0.9285714285714287]
Epoch39,test total loss: 0.16601313268765808,  Spearman is [0.15147587689819036],
Epoch40,train total loss: 0.003379490701869751,  Spearman:0.8954193610851398
Epoch40,val total loss: 0.028115931898355484,  Spearman:[0.9285714285714287]
Epoch40,test total loss: 0.14326931985560803,  Spearman is [0.15461947931807538],
Epoch41,train total loss: 0.0033879338174861353,  Spearman:0.8941433030626623
Epoch41,val total loss: 0.029762599617242813,  Spearman:[0.880952380952381]
Epoch41,test total loss: 0.11674410419072956,  Spearman is [0.15342616840503098],
Epoch42,train total loss: 0.0034098868599334634,  Spearman:0.8933459618326477
Epoch42,val total loss: 0.030910879373550415,  Spearman:[0.880952380952381]
Epoch42,test total loss: 0.12660776611883193,  Spearman is [0.15114182454694972],
Epoch43,train total loss: 0.003297635544022808,  Spearman:0.8972766009145943
Epoch43,val total loss: 0.028086170554161072,  Spearman:[0.880952380952381]
Epoch43,test total loss: 0.1310575630515814,  Spearman is [0.1587257690839744],
Epoch44,train total loss: 0.0031345909862862662,  Spearman:0.9034957355009389
Epoch44,val total loss: 0.029541777446866035,  Spearman:[0.9047619047619048]
Epoch44,test total loss: 0.12788173956796528,  Spearman is [0.15344692255323594],
Epoch45,train total loss: 0.003199105451364094,  Spearman:0.8990123677195161
Epoch45,val total loss: 0.03085925430059433,  Spearman:[0.9047619047619048]
Epoch45,test total loss: 0.16035815328359604,  Spearman is [0.1560477671714428],
Epoch46,train total loss: 0.0032890539296204224,  Spearman:0.896560825989269
Epoch46,val total loss: 0.0308977197855711,  Spearman:[0.9285714285714287]
Epoch46,test total loss: 0.1607717789709568,  Spearman is [0.1562740505173657],
Epoch47,train total loss: 0.003235450634234346,  Spearman:0.8963618263158314
Epoch47,val total loss: 0.031329382210969925,  Spearman:[0.9047619047619048]
Epoch47,test total loss: 0.1244338830234483,  Spearman is [0.15999070679747773],
Epoch48,train total loss: 0.003014352209552621,  Spearman:0.904740813233526
Epoch48,val total loss: 0.029931565746665,  Spearman:[0.8571428571428572]
Epoch48,test total loss: 0.1522337042260915,  Spearman is [0.15649579635940347],
Epoch49,train total loss: 0.0029984457837716224,  Spearman:0.9050851826697667
Epoch49,val total loss: 0.032169707119464874,  Spearman:[0.9047619047619048]
Epoch49,test total loss: 0.14132748036645354,  Spearman is [0.15110821413773695],
Early stop at epoch 49
ensemble idx 0, best epoch 26, best validation spearman is 0.9285714285714287,best test spearman is [0.1504729701699135],

ensemble 1 models, fold 1, spearman is 0.1504729701699135, ndcg is 0.7975024954216502
training on fold 2 
Epoch0,train total loss: 0.07606444799174102,  Spearman:0.058706028738001494
Epoch0,val total loss: 0.2762448489665985,  Spearman:[0.27545404024004955]
Epoch0,test total loss: 0.02514096200466156,  Spearman is [-0.09776580509518351],
Epoch1,train total loss: 0.04064395485851818,  Spearman:0.5200248740343405
Epoch1,val total loss: 0.11162860691547394,  Spearman:[0.6107893935757621]
Epoch1,test total loss: 0.0798166248947382,  Spearman is [-0.05090249127409233],
Epoch2,train total loss: 0.033496697612393364,  Spearman:0.6129028598594127
Epoch2,val total loss: 0.055207837373018265,  Spearman:[0.5149792926227014]
Epoch2,test total loss: 0.04769862201064825,  Spearman is [-0.05824316641804159],
Epoch3,train total loss: 0.026922835198302682,  Spearman:0.6631275847372541
Epoch3,val total loss: 0.047476593405008316,  Spearman:[0.5628843430992317]
Epoch3,test total loss: 0.23272682167589664,  Spearman is [-0.04076672031300517],
Epoch4,train total loss: 0.02278411287503938,  Spearman:0.6883245828884011
Epoch4,val total loss: 0.05487513169646263,  Spearman:[0.5389318178609664]
Epoch4,test total loss: 0.2496414091438055,  Spearman is [0.03374604441043787],
Epoch5,train total loss: 0.017162770856744967,  Spearman:0.7287204767142581
Epoch5,val total loss: 0.027463702484965324,  Spearman:[0.6586944440522925]
Epoch5,test total loss: 0.10001094453036785,  Spearman is [0.12175584809160996],
Epoch6,train total loss: 0.014702523622709589,  Spearman:0.76180454508326
Epoch6,val total loss: 0.02502899058163166,  Spearman:[0.6347419188140272]
Epoch6,test total loss: 0.10921332370489836,  Spearman is [0.1495451163863335],
Epoch7,train total loss: 0.013950892725589279,  Spearman:0.7782066254080626
Epoch7,val total loss: 0.021939052268862724,  Spearman:[0.7065994945288228]
Epoch7,test total loss: 0.10670896992087364,  Spearman is [0.15751301266514992],
Epoch8,train total loss: 0.012853215015732134,  Spearman:0.7899523858829722
Epoch8,val total loss: 0.014193029142916203,  Spearman:[0.7065994945288228]
Epoch8,test total loss: 0.05757688875310123,  Spearman is [0.15421760114789115],
Epoch9,train total loss: 0.01229665164823811,  Spearman:0.8013679731528466
Epoch9,val total loss: 0.016523100435733795,  Spearman:[0.6347419188140272]
Epoch9,test total loss: 0.05702529740519822,  Spearman is [0.15477903505251672],
Epoch10,train total loss: 0.011574393718873557,  Spearman:0.809002208365715
Epoch10,val total loss: 0.012896643951535225,  Spearman:[0.6826469692905576]
Epoch10,test total loss: 0.05195146007463336,  Spearman is [0.1654193764456286],
Epoch11,train total loss: 0.011109522978166262,  Spearman:0.8136800680146868
Epoch11,val total loss: 0.022861484438180923,  Spearman:[0.5868368683374969]
Epoch11,test total loss: 0.11363637149333954,  Spearman is [0.1573430601283283],
Epoch12,train total loss: 0.010926138209656645,  Spearman:0.815166228974114
Epoch12,val total loss: 0.012303882278501987,  Spearman:[0.6826469692905576]
Epoch12,test total loss: 0.07356059467419981,  Spearman is [0.15740723621588604],
Epoch13,train total loss: 0.010129650901012028,  Spearman:0.8224678379653442
Epoch13,val total loss: 0.014082074165344238,  Spearman:[0.6826469692905576]
Epoch13,test total loss: 0.08382385652512311,  Spearman is [0.15894981655841767],
Epoch14,train total loss: 0.009660103326985756,  Spearman:0.8256185764490419
Epoch14,val total loss: 0.011299896985292435,  Spearman:[0.5389318178609664]
Epoch14,test total loss: 0.08641207003965974,  Spearman is [0.1477334620634146],
Epoch15,train total loss: 0.009415049674526717,  Spearman:0.8272521398220797
Epoch15,val total loss: 0.011918232776224613,  Spearman:[0.6826469692905576]
Epoch15,test total loss: 0.06277885120362044,  Spearman is [0.15600965213880785],
Epoch16,train total loss: 0.00923867465611786,  Spearman:0.8296969100149892
Epoch16,val total loss: 0.01655404642224312,  Spearman:[0.7065994945288228]
Epoch16,test total loss: 0.1189376424998045,  Spearman is [0.153433605965747],
Epoch17,train total loss: 0.008953288724371351,  Spearman:0.8342756814537227
Epoch17,val total loss: 0.008438348770141602,  Spearman:[0.6347419188140272]
Epoch17,test total loss: 0.09321197103708982,  Spearman is [0.1586271605756305],
Epoch18,train total loss: 0.008703521320011275,  Spearman:0.8373903906517078
Epoch18,val total loss: 0.011987859383225441,  Spearman:[0.5868368683374969]
Epoch18,test total loss: 0.10027417652308941,  Spearman is [0.16086831265759957],
Epoch19,train total loss: 0.008787832816149322,  Spearman:0.8321645451604173
Epoch19,val total loss: 0.010835055261850357,  Spearman:[0.6347419188140272]
Epoch19,test total loss: 0.08268514070659876,  Spearman is [0.15746390240570926],
Epoch20,train total loss: 0.008463209086748509,  Spearman:0.8413890857067498
Epoch20,val total loss: 0.01597410812973976,  Spearman:[0.6826469692905576]
Epoch20,test total loss: 0.08745919307693839,  Spearman is [0.1587534873142291],
Epoch21,train total loss: 0.008171377805037757,  Spearman:0.8453455552793321
Epoch21,val total loss: 0.008328171446919441,  Spearman:[0.6826469692905576]
Epoch21,test total loss: 0.1131267037242651,  Spearman is [0.14895900898232103],
Epoch22,train total loss: 0.008054932383880114,  Spearman:0.8432777981784351
Epoch22,val total loss: 0.00801052525639534,  Spearman:[0.7545045450053531]
Epoch22,test total loss: 0.07978361900895833,  Spearman is [0.15191833613572972],
Epoch23,train total loss: 0.007924288118001407,  Spearman:0.8459392914904501
Epoch23,val total loss: 0.006263311021029949,  Spearman:[0.7065994945288228]
Epoch23,test total loss: 0.11403943486511707,  Spearman is [0.15650514098696977],
Epoch24,train total loss: 0.0076844463257704125,  Spearman:0.8486760446394446
Epoch24,val total loss: 0.010147426277399063,  Spearman:[0.7545045450053531]
Epoch24,test total loss: 0.08494577333331108,  Spearman is [0.16236878627929582],
Epoch25,train total loss: 0.007499909227660213,  Spearman:0.8471613558218597
Epoch25,val total loss: 0.005981229245662689,  Spearman:[0.6826469692905576]
Epoch25,test total loss: 0.1140013337135315,  Spearman is [0.157858270678159],
Epoch26,train total loss: 0.007001851166699989,  Spearman:0.8524463661842698
Epoch26,val total loss: 0.011138389818370342,  Spearman:[0.7065994945288228]
Epoch26,test total loss: 0.12526177205145358,  Spearman is [0.15989523508529788],
Epoch27,train total loss: 0.006321054436296272,  Spearman:0.8543117604265893
Epoch27,val total loss: 0.007408672012388706,  Spearman:[0.8503146459584139]
Epoch27,test total loss: 0.08852555938065051,  Spearman is [0.16883841850352524],
Epoch28,train total loss: 0.005292950530882734,  Spearman:0.8641849050114586
Epoch28,val total loss: 0.005444213282316923,  Spearman:[0.8263621207201486]
Epoch28,test total loss: 0.12612203061580657,  Spearman is [0.17050918004276505],
Epoch29,train total loss: 0.004484877499262205,  Spearman:0.8671462271119803
Epoch29,val total loss: 0.01687697321176529,  Spearman:[0.8024095954818835]
Epoch29,test total loss: 0.1296986292116344,  Spearman is [0.16950318255097224],
Epoch30,train total loss: 0.0042145584336070055,  Spearman:0.8663052453539266
Epoch30,val total loss: 0.008121006190776825,  Spearman:[0.7784570702436182]
Epoch30,test total loss: 0.14713105335831642,  Spearman is [0.16890076643734372],
Epoch31,train total loss: 0.003898004642672813,  Spearman:0.8679895757342482
Epoch31,val total loss: 0.00604584626853466,  Spearman:[0.6586944440522925]
Epoch31,test total loss: 0.07527910890057683,  Spearman is [0.1768473496000853],
Epoch32,train total loss: 0.0035364640263231615,  Spearman:0.8731793001851714
Epoch32,val total loss: 0.00763151329010725,  Spearman:[0.6586944440522925]
Epoch32,test total loss: 0.1074950153939426,  Spearman is [0.17527148765297024],
Epoch33,train total loss: 0.0034400790840990315,  Spearman:0.8771925250055211
Epoch33,val total loss: 0.004999800585210323,  Spearman:[0.730552019767088]
Epoch33,test total loss: 0.06507900347933174,  Spearman is [0.17697615552558926],
Epoch34,train total loss: 0.0033283241198380263,  Spearman:0.8795168168859766
Epoch34,val total loss: 0.003984697163105011,  Spearman:[0.6586944440522925]
Epoch34,test total loss: 0.06344951558858156,  Spearman is [0.17652790275048066],
Epoch35,train total loss: 0.0031047727780577797,  Spearman:0.8868162513518558
Epoch35,val total loss: 0.004844003822654486,  Spearman:[0.6586944440522925]
Epoch35,test total loss: 0.04967429721727967,  Spearman is [0.17386558481876935],
Epoch36,train total loss: 0.0030059344538200935,  Spearman:0.891394074986427
Epoch36,val total loss: 0.004292303696274757,  Spearman:[0.730552019767088]
Epoch36,test total loss: 0.051789604406803844,  Spearman is [0.1779922341673181],
Epoch37,train total loss: 0.0028073062776223733,  Spearman:0.8970563956728965
Epoch37,val total loss: 0.004481294192373753,  Spearman:[0.8024095954818835]
Epoch37,test total loss: 0.053223548969253895,  Spearman is [0.18330535529262068],
Epoch38,train total loss: 0.002926938079793054,  Spearman:0.8909473887110464
Epoch38,val total loss: 0.0033091502264142036,  Spearman:[0.730552019767088]
Epoch38,test total loss: 0.051253271335735914,  Spearman is [0.17951325807834917],
Epoch39,train total loss: 0.0029082656390248584,  Spearman:0.8939839298336786
Epoch39,val total loss: 0.0036284136585891247,  Spearman:[0.6586944440522925]
Epoch39,test total loss: 0.04496071431785822,  Spearman is [0.18519611343327005],
Epoch40,train total loss: 0.002708901717060377,  Spearman:0.8957211068681104
Epoch40,val total loss: 0.013434143736958504,  Spearman:[0.730552019767088]
Epoch40,test total loss: 0.038428841065615414,  Spearman is [0.18346739679005994],
Epoch41,train total loss: 0.002780682954695434,  Spearman:0.8992399423683926
Epoch41,val total loss: 0.004631531424820423,  Spearman:[0.730552019767088]
Epoch41,test total loss: 0.0534055374795571,  Spearman is [0.17981962507979798],
Epoch42,train total loss: 0.0027818870549731986,  Spearman:0.8982097334403223
Epoch42,val total loss: 0.004796460270881653,  Spearman:[0.730552019767088]
Epoch42,test total loss: 0.03816486597061157,  Spearman is [0.18460118748909826],
Epoch43,train total loss: 0.0025743451919063376,  Spearman:0.9026145368754858
Epoch43,val total loss: 0.004546266980469227,  Spearman:[0.730552019767088]
Epoch43,test total loss: 0.03948583002202213,  Spearman is [0.18491320335407946],
Epoch44,train total loss: 0.0026606916161164497,  Spearman:0.9031711053830324
Epoch44,val total loss: 0.0032683585304766893,  Spearman:[0.730552019767088]
Epoch44,test total loss: 0.03774791401810944,  Spearman is [0.1851215997281654],
Epoch45,train total loss: 0.0024906864316271357,  Spearman:0.9082395977822539
Epoch45,val total loss: 0.003778067883104086,  Spearman:[0.730552019767088]
Epoch45,test total loss: 0.031314754486083986,  Spearman is [0.18629384741665322],
Epoch46,train total loss: 0.0024875805144965388,  Spearman:0.9071490040421143
Epoch46,val total loss: 0.0036342788953334093,  Spearman:[0.730552019767088]
Epoch46,test total loss: 0.02875737603753805,  Spearman is [0.183609644248812],
Epoch47,train total loss: 0.002569963312476503,  Spearman:0.9068585222138349
Epoch47,val total loss: 0.004935811273753643,  Spearman:[0.730552019767088]
Epoch47,test total loss: 0.03945357606280595,  Spearman is [0.18895172648586822],
Epoch48,train total loss: 0.0024488918962351116,  Spearman:0.9095467645131233
Epoch48,val total loss: 0.010758765041828156,  Spearman:[0.730552019767088]
Epoch48,test total loss: 0.04188168551772833,  Spearman is [0.19408479419613536],
Epoch49,train total loss: 0.002422965300912694,  Spearman:0.9113221862864457
Epoch49,val total loss: 0.007045939564704895,  Spearman:[0.730552019767088]
Epoch49,test total loss: 0.029093358665704727,  Spearman is [0.1859236660127389],
Early stop at epoch 49
ensemble idx 0, best epoch 27, best validation spearman is 0.8503146459584139,best test spearman is [0.16884411997579826],

ensemble 1 models, fold 2, spearman is 0.16884411997579826, ndcg is 0.7569235609409918
training on fold 3 
Epoch0,train total loss: 0.09300243648557135,  Spearman:0.18315446863672305
Epoch0,val total loss: 0.06019046530127525,  Spearman:[0.2380952380952381]
Epoch0,test total loss: 0.024708564300090073,  Spearman is [-0.02893891415315886],
Epoch1,train total loss: 0.03941076397537612,  Spearman:0.5610535193099898
Epoch1,val total loss: 0.07289226353168488,  Spearman:[0.7142857142857144]
Epoch1,test total loss: 0.12269639559090137,  Spearman is [-0.04060740131789696],
Epoch2,train total loss: 0.029520401140101828,  Spearman:0.6244044661658062
Epoch2,val total loss: 0.035168252885341644,  Spearman:[0.7857142857142858]
Epoch2,test total loss: 0.3894780382514,  Spearman is [-0.03223470708378765],
Epoch3,train total loss: 0.0261594944824584,  Spearman:0.6437477275091923
Epoch3,val total loss: 0.024813661351799965,  Spearman:[0.7857142857142858]
Epoch3,test total loss: 0.4361194260418415,  Spearman is [-0.008442200244708901],
Epoch4,train total loss: 0.019953729963909168,  Spearman:0.6727986864783999
Epoch4,val total loss: 0.018928850069642067,  Spearman:[0.7142857142857144]
Epoch4,test total loss: 0.14732353147119284,  Spearman is [0.07321862587080659],
Epoch5,train total loss: 0.014801773557570787,  Spearman:0.7274367025324769
Epoch5,val total loss: 0.02233687788248062,  Spearman:[0.7142857142857144]
Epoch5,test total loss: 0.11718721389770508,  Spearman is [0.12238561068609259],
Epoch6,train total loss: 0.013725639885076536,  Spearman:0.749558520799859
Epoch6,val total loss: 0.019752856343984604,  Spearman:[0.7142857142857144]
Epoch6,test total loss: 0.10391116049140692,  Spearman is [0.1525599391850849],
Epoch7,train total loss: 0.012040645519916255,  Spearman:0.7653760579597215
Epoch7,val total loss: 0.024082006886601448,  Spearman:[0.7142857142857144]
Epoch7,test total loss: 0.06077213725075126,  Spearman is [0.1648927958317148],
Epoch8,train total loss: 0.011685851512130542,  Spearman:0.7708058418798264
Epoch8,val total loss: 0.02888372726738453,  Spearman:[0.7142857142857144]
Epoch8,test total loss: 0.11238397192209959,  Spearman is [0.1457868728967005],
Epoch9,train total loss: 0.011111748601811437,  Spearman:0.7774625290818763
Epoch9,val total loss: 0.028478220105171204,  Spearman:[0.7857142857142858]
Epoch9,test total loss: 0.10480197239667177,  Spearman is [0.15548122364287706],
Epoch10,train total loss: 0.010368682010523163,  Spearman:0.7845600234544493
Epoch10,val total loss: 0.022971801459789276,  Spearman:[0.8571428571428572]
Epoch10,test total loss: 0.10613540336489677,  Spearman is [0.15768592444363566],
Epoch11,train total loss: 0.009980442378526697,  Spearman:0.7863896555837828
Epoch11,val total loss: 0.023309163749217987,  Spearman:[0.7857142857142858]
Epoch11,test total loss: 0.10869950763881206,  Spearman is [0.1423225084086934],
Epoch12,train total loss: 0.009450626071506681,  Spearman:0.7932944386163849
Epoch12,val total loss: 0.02936415933072567,  Spearman:[0.8571428571428572]
Epoch12,test total loss: 0.11369119212031364,  Spearman is [0.14297692168640833],
Epoch13,train total loss: 0.009177432830582779,  Spearman:0.7984346211352277
Epoch13,val total loss: 0.026716388761997223,  Spearman:[0.7380952380952381]
Epoch13,test total loss: 0.15122150778770446,  Spearman is [0.14922874057196703],
Epoch14,train total loss: 0.008559731575541006,  Spearman:0.8038753975210551
Epoch14,val total loss: 0.027443692088127136,  Spearman:[0.7857142857142858]
Epoch14,test total loss: 0.1441162534058094,  Spearman is [0.14103285773924767],
Epoch15,train total loss: 0.008273596393290715,  Spearman:0.8063062447293133
Epoch15,val total loss: 0.032020144164562225,  Spearman:[0.8095238095238096]
Epoch15,test total loss: 0.12929661013185978,  Spearman is [0.15497398331726198],
Epoch16,train total loss: 0.008035712010519674,  Spearman:0.8098065189971176
Epoch16,val total loss: 0.02934393845498562,  Spearman:[0.6904761904761906]
Epoch16,test total loss: 0.1427056834101677,  Spearman is [0.1467509280699726],
Epoch17,train total loss: 0.007975695439083025,  Spearman:0.8110268491994896
Epoch17,val total loss: 0.029666785150766373,  Spearman:[0.6904761904761906]
Epoch17,test total loss: 0.17760793082416057,  Spearman is [0.1490338975247032],
Epoch18,train total loss: 0.007657611479934974,  Spearman:0.8179502999272948
Epoch18,val total loss: 0.03047257848083973,  Spearman:[0.8095238095238096]
Epoch18,test total loss: 0.14726030565798282,  Spearman is [0.14867126547507892],
Epoch19,train total loss: 0.007722738119087015,  Spearman:0.8183370985295085
Epoch19,val total loss: 0.025088049471378326,  Spearman:[0.7619047619047621]
Epoch19,test total loss: 0.15589249022305013,  Spearman is [0.14809561405828],
Epoch20,train total loss: 0.007668213138971716,  Spearman:0.8187039103818207
Epoch20,val total loss: 0.029628701508045197,  Spearman:[0.7619047619047621]
Epoch20,test total loss: 0.15275437273085118,  Spearman is [0.15161440886463065],
Epoch21,train total loss: 0.007373024641613786,  Spearman:0.8228428600488302
Epoch21,val total loss: 0.03780315816402435,  Spearman:[0.7619047619047621]
Epoch21,test total loss: 0.1274634011089802,  Spearman is [0.14753890178813198],
Epoch22,train total loss: 0.007416126623493022,  Spearman:0.822785632034366
Epoch22,val total loss: 0.03053009882569313,  Spearman:[0.7619047619047621]
Epoch22,test total loss: 0.13802802488207816,  Spearman is [0.15069574188239487],
Epoch23,train total loss: 0.0070284500983782494,  Spearman:0.8279050935401109
Epoch23,val total loss: 0.03036872111260891,  Spearman:[0.7619047619047621]
Epoch23,test total loss: 0.12745856698602437,  Spearman is [0.15390915610118477],
Epoch24,train total loss: 0.006668214639947296,  Spearman:0.832251683491096
Epoch24,val total loss: 0.03996003046631813,  Spearman:[0.7619047619047621]
Epoch24,test total loss: 0.13886865340173243,  Spearman is [0.15708014137060256],
Epoch25,train total loss: 0.006256226797958311,  Spearman:0.8341003910507919
Epoch25,val total loss: 0.034413427114486694,  Spearman:[0.7619047619047621]
Epoch25,test total loss: 0.13079738095402718,  Spearman is [0.15346250131657485],
Epoch26,train total loss: 0.005480060025524252,  Spearman:0.8387972142341642
Epoch26,val total loss: 0.034349504858255386,  Spearman:[0.7857142857142858]
Epoch26,test total loss: 0.14975305497646332,  Spearman is [0.1563443686753998],
Epoch27,train total loss: 0.00475721212681562,  Spearman:0.8475505467294987
Epoch27,val total loss: 0.03209417313337326,  Spearman:[0.8095238095238096]
Epoch27,test total loss: 0.15067342296242714,  Spearman is [0.1532507511352695],
Epoch28,train total loss: 0.004310326026498865,  Spearman:0.8491988957145609
Epoch28,val total loss: 0.027936166152358055,  Spearman:[0.8095238095238096]
Epoch28,test total loss: 0.15251835845410824,  Spearman is [0.1590515815912034],
Epoch29,train total loss: 0.004172857690718956,  Spearman:0.8537164375966274
Epoch29,val total loss: 0.03223099559545517,  Spearman:[0.9047619047619048]
Epoch29,test total loss: 0.11327764857560396,  Spearman is [0.16790993341505683],
Epoch30,train total loss: 0.003976389517983756,  Spearman:0.854324306095477
Epoch30,val total loss: 0.0355708971619606,  Spearman:[0.8571428571428572]
Epoch30,test total loss: 0.12251664604991674,  Spearman is [0.15935177364171293],
Epoch31,train total loss: 0.003977333863776249,  Spearman:0.8534384196918009
Epoch31,val total loss: 0.0264347642660141,  Spearman:[0.8571428571428572]
Epoch31,test total loss: 0.15291781201958657,  Spearman is [0.17014388467564298],
Epoch32,train total loss: 0.0036146057182355807,  Spearman:0.8637594367104717
Epoch32,val total loss: 0.026180358603596687,  Spearman:[0.8571428571428572]
Epoch32,test total loss: 0.11998643577098847,  Spearman is [0.16803443199991625],
Epoch33,train total loss: 0.00366332092082116,  Spearman:0.8639672122648557
Epoch33,val total loss: 0.0385732464492321,  Spearman:[0.8571428571428572]
Epoch33,test total loss: 0.11174444295465946,  Spearman is [0.1688087603259573],
Epoch34,train total loss: 0.0035090336463420102,  Spearman:0.8703760459562151
Epoch34,val total loss: 0.024967767298221588,  Spearman:[0.9047619047619048]
Epoch34,test total loss: 0.1276102140545845,  Spearman is [0.17109638565423954],
Epoch35,train total loss: 0.003481830150121823,  Spearman:0.8704640078499913
Epoch35,val total loss: 0.022610312327742577,  Spearman:[0.9047619047619048]
Epoch35,test total loss: 0.09918485581874847,  Spearman is [0.17032929103004432],
Epoch36,train total loss: 0.0035115777591738897,  Spearman:0.87114633346466
Epoch36,val total loss: 0.028071150183677673,  Spearman:[0.880952380952381]
Epoch36,test total loss: 0.1197281552478671,  Spearman is [0.17477818206754725],
Epoch37,train total loss: 0.003380711987026585,  Spearman:0.8729217745882862
Epoch37,val total loss: 0.02519884891808033,  Spearman:[0.9047619047619048]
Epoch37,test total loss: 0.1147696103900671,  Spearman is [0.1734769903556111],
Epoch38,train total loss: 0.0032181423261928824,  Spearman:0.881449772233036
Epoch38,val total loss: 0.02945706620812416,  Spearman:[0.880952380952381]
Epoch38,test total loss: 0.1009926063939929,  Spearman is [0.17733238246103364],
Epoch39,train total loss: 0.003230119116592388,  Spearman:0.8814262009511431
Epoch39,val total loss: 0.03759061172604561,  Spearman:[0.9285714285714287]
Epoch39,test total loss: 0.08809380028396845,  Spearman is [0.1708115750842913],
Epoch40,train total loss: 0.0031071323005912397,  Spearman:0.8853881795963024
Epoch40,val total loss: 0.038594625890254974,  Spearman:[0.9047619047619048]
Epoch40,test total loss: 0.0867923516780138,  Spearman is [0.17691007237118125],
Epoch41,train total loss: 0.003128748977010568,  Spearman:0.8865434536260378
Epoch41,val total loss: 0.030984262004494667,  Spearman:[0.880952380952381]
Epoch41,test total loss: 0.0860247403383255,  Spearman is [0.18251934125005229],
Epoch42,train total loss: 0.002985118998390718,  Spearman:0.8867379753273633
Epoch42,val total loss: 0.028418848291039467,  Spearman:[0.9523809523809524]
Epoch42,test total loss: 0.08533907160162926,  Spearman is [0.18035419594271165],
Epoch43,train total loss: 0.0030868200224060086,  Spearman:0.8863730737758841
Epoch43,val total loss: 0.021786686033010483,  Spearman:[0.880952380952381]
Epoch43,test total loss: 0.09547495171427726,  Spearman is [0.1841091642417298],
Epoch44,train total loss: 0.003154329739164752,  Spearman:0.8854205930931545
Epoch44,val total loss: 0.02372955158352852,  Spearman:[0.880952380952381]
Epoch44,test total loss: 0.08828698936849833,  Spearman is [0.18515511807208196],
Epoch45,train total loss: 0.0030957720367811047,  Spearman:0.8851849539531543
Epoch45,val total loss: 0.028146563097834587,  Spearman:[0.880952380952381]
Epoch45,test total loss: 0.08399522881954909,  Spearman is [0.1844733877057601],
Epoch46,train total loss: 0.003011541270937484,  Spearman:0.8880897718279109
Epoch46,val total loss: 0.030384520068764687,  Spearman:[0.9047619047619048]
Epoch46,test total loss: 0.07681433744728565,  Spearman is [0.193280176387638],
Epoch47,train total loss: 0.0028118561999573824,  Spearman:0.8949357081845618
Epoch47,val total loss: 0.025312896817922592,  Spearman:[0.880952380952381]
Epoch47,test total loss: 0.07735106088221073,  Spearman is [0.1862874225741956],
Epoch48,train total loss: 0.0029245854531883453,  Spearman:0.8891058155917645
Epoch48,val total loss: 0.02470732294023037,  Spearman:[0.9047619047619048]
Epoch48,test total loss: 0.09114068374037743,  Spearman is [0.1883046258231102],
Epoch49,train total loss: 0.002924053326401358,  Spearman:0.8924971448166508
Epoch49,val total loss: 0.026413574814796448,  Spearman:[0.880952380952381]
Epoch49,test total loss: 0.07603709641844034,  Spearman is [0.18931902098513675],
Early stop at epoch 49
ensemble idx 0, best epoch 42, best validation spearman is 0.9523809523809524,best test spearman is [0.18035272260146565],

ensemble 1 models, fold 3, spearman is 0.18035272260146565, ndcg is 0.7831043040424974
training on fold 4 
Epoch0,train total loss: 0.09732078534598725,  Spearman:0.1442707833435885
Epoch0,val total loss: 0.18901005387306213,  Spearman:[0.523809523809524]
Epoch0,test total loss: 0.13628680258989334,  Spearman is [-0.011904036244686746],
Epoch1,train total loss: 0.04233648075172917,  Spearman:0.5703043157751183
Epoch1,val total loss: 0.06620851904153824,  Spearman:[0.880952380952381]
Epoch1,test total loss: 0.15584344789385796,  Spearman is [-0.03090773051281741],
Epoch2,train total loss: 0.030020529511742867,  Spearman:0.6394874894060031
Epoch2,val total loss: 0.04383757710456848,  Spearman:[0.8095238095238096]
Epoch2,test total loss: 0.38327886909246445,  Spearman is [-0.02171842367733184],
Epoch3,train total loss: 0.025850503377091043,  Spearman:0.672336270880551
Epoch3,val total loss: 0.03697935491800308,  Spearman:[0.8333333333333335]
Epoch3,test total loss: 0.36434016600251196,  Spearman is [-0.01648479435922243],
Epoch4,train total loss: 0.020621232664546907,  Spearman:0.7042790150787327
Epoch4,val total loss: 0.01326700672507286,  Spearman:[0.8095238095238096]
Epoch4,test total loss: 0.25160862058401107,  Spearman is [0.07053090449343125],
Epoch5,train total loss: 0.016341531180585615,  Spearman:0.7525718053305346
Epoch5,val total loss: 0.005055444315075874,  Spearman:[0.8095238095238096]
Epoch5,test total loss: 0.21372903380542993,  Spearman is [0.1318536057493278],
Epoch6,train total loss: 0.01450766969878131,  Spearman:0.7773458538835778
Epoch6,val total loss: 0.010092530399560928,  Spearman:[0.8095238095238096]
Epoch6,test total loss: 0.14245883524417877,  Spearman is [0.1185110887273341],
Epoch7,train total loss: 0.013475488826560859,  Spearman:0.7889016464979511
Epoch7,val total loss: 0.004834004677832127,  Spearman:[0.7380952380952381]
Epoch7,test total loss: 0.14395300187170507,  Spearman is [0.14110151872194981],
Epoch8,train total loss: 0.013056251193540027,  Spearman:0.7936002550581209
Epoch8,val total loss: 0.010152999311685562,  Spearman:[0.8095238095238096]
Epoch8,test total loss: 0.09947276897728444,  Spearman is [0.14735851299237462],
Epoch9,train total loss: 0.01264396079409963,  Spearman:0.8024455089729143
Epoch9,val total loss: 0.013261595740914345,  Spearman:[0.8333333333333335]
Epoch9,test total loss: 0.10891291545704007,  Spearman is [0.14609012283026304],
Epoch10,train total loss: 0.012054886551012691,  Spearman:0.8084560878599525
Epoch10,val total loss: 0.007202155888080597,  Spearman:[0.8571428571428572]
Epoch10,test total loss: 0.0878870845772326,  Spearman is [0.15155069967964663],
Epoch11,train total loss: 0.011823465002891727,  Spearman:0.8105847380537602
Epoch11,val total loss: 0.007216788828372955,  Spearman:[0.8333333333333335]
Epoch11,test total loss: 0.09085962297394871,  Spearman is [0.16528192953446516],
Epoch12,train total loss: 0.011097147726477722,  Spearman:0.8172690523427245
Epoch12,val total loss: 0.016348646953701973,  Spearman:[0.8333333333333335]
Epoch12,test total loss: 0.06701650768518448,  Spearman is [0.16112058472142674],
Epoch13,train total loss: 0.010748035119225582,  Spearman:0.8218643000796105
Epoch13,val total loss: 0.010208696126937866,  Spearman:[0.7619047619047621]
Epoch13,test total loss: 0.08559488784521818,  Spearman is [0.1704351726967896],
Epoch14,train total loss: 0.010203885659276962,  Spearman:0.8296073638611312
Epoch14,val total loss: 0.00828504003584385,  Spearman:[0.7619047619047621]
Epoch14,test total loss: 0.09824514286592603,  Spearman is [0.15904442680246858],
Epoch15,train total loss: 0.009855343410984064,  Spearman:0.8349514750558535
Epoch15,val total loss: 0.01302843727171421,  Spearman:[0.7619047619047621]
Epoch15,test total loss: 0.09498776821419597,  Spearman is [0.17032421428656705],
Epoch16,train total loss: 0.009500783405457743,  Spearman:0.8362768017612622
Epoch16,val total loss: 0.012709573842585087,  Spearman:[0.7619047619047621]
Epoch16,test total loss: 0.09659161949530244,  Spearman is [0.1596414373679905],
Epoch17,train total loss: 0.008421129487359371,  Spearman:0.8513962361531932
Epoch17,val total loss: 0.014046819880604744,  Spearman:[0.7619047619047621]
Epoch17,test total loss: 0.1836582132615149,  Spearman is [0.15233615475434512],
Epoch18,train total loss: 0.007757244549560336,  Spearman:0.8568524706963108
Epoch18,val total loss: 0.018394317477941513,  Spearman:[0.7619047619047621]
Epoch18,test total loss: 0.2852471962571144,  Spearman is [0.14483596333251003],
Epoch19,train total loss: 0.007229655551222654,  Spearman:0.8653578872115164
Epoch19,val total loss: 0.01536962203681469,  Spearman:[0.7619047619047621]
Epoch19,test total loss: 0.24650375433266164,  Spearman is [0.13952939857151683],
Epoch20,train total loss: 0.0071115176632212335,  Spearman:0.8673800040927889
Epoch20,val total loss: 0.017653387039899826,  Spearman:[0.7619047619047621]
Epoch20,test total loss: 0.2075225282460451,  Spearman is [0.1394305072911917],
Epoch21,train total loss: 0.006657630022322663,  Spearman:0.8741603860776452
Epoch21,val total loss: 0.025015704333782196,  Spearman:[0.7142857142857144]
Epoch21,test total loss: 0.20785042010247706,  Spearman is [0.12756129805241687],
Epoch22,train total loss: 0.006551560865959917,  Spearman:0.8769674447913549
Epoch22,val total loss: 0.024679239839315414,  Spearman:[0.7619047619047621]
Epoch22,test total loss: 0.19838364645838738,  Spearman is [0.1234074828653907],
Epoch23,train total loss: 0.006389180081150232,  Spearman:0.8816221911878662
Epoch23,val total loss: 0.017862191423773766,  Spearman:[0.7619047619047621]
Epoch23,test total loss: 0.25059306193143127,  Spearman is [0.12650884704258863],
Epoch24,train total loss: 0.0062894505621769875,  Spearman:0.8824255480617862
Epoch24,val total loss: 0.020913805812597275,  Spearman:[0.7142857142857144]
Epoch24,test total loss: 0.23115487629547715,  Spearman is [0.12200144193324548],
Epoch25,train total loss: 0.006243746057570649,  Spearman:0.8840540991967953
Epoch25,val total loss: 0.017411446198821068,  Spearman:[0.7619047619047621]
Epoch25,test total loss: 0.2499974938109517,  Spearman is [0.1195467509727874],
Epoch26,train total loss: 0.006216931340392106,  Spearman:0.8842466360732428
Epoch26,val total loss: 0.02027689851820469,  Spearman:[0.7619047619047621]
Epoch26,test total loss: 0.3130843723192811,  Spearman is [0.1163304763449721],
Epoch27,train total loss: 0.0060421531625951715,  Spearman:0.8882297408818437
Epoch27,val total loss: 0.02163722552359104,  Spearman:[0.7619047619047621]
Epoch27,test total loss: 0.23569937916472555,  Spearman is [0.1144749461410619],
Epoch28,train total loss: 0.005926629913469346,  Spearman:0.8890105164114814
Epoch28,val total loss: 0.019780615344643593,  Spearman:[0.7619047619047621]
Epoch28,test total loss: 0.2576062746345997,  Spearman is [0.11402753510580445],
Epoch29,train total loss: 0.005957208691726033,  Spearman:0.8882530758774773
Epoch29,val total loss: 0.019714416936039925,  Spearman:[0.7619047619047621]
Epoch29,test total loss: 0.2672327272593975,  Spearman is [0.11368792595632768],
Epoch30,train total loss: 0.0057660144435104504,  Spearman:0.8871607898404177
Epoch30,val total loss: 0.015422373078763485,  Spearman:[0.7619047619047621]
Epoch30,test total loss: 0.30189995355904103,  Spearman is [0.11298915693411266],
Epoch31,train total loss: 0.005035069804319228,  Spearman:0.8902596262588209
Epoch31,val total loss: 0.012227137573063374,  Spearman:[0.7619047619047621]
Epoch31,test total loss: 0.3236267173662782,  Spearman is [0.10606324910181836],
Epoch32,train total loss: 0.004416724684116884,  Spearman:0.8918390993326358
Epoch32,val total loss: 0.0060976529493927956,  Spearman:[0.7619047619047621]
Epoch32,test total loss: 0.37552030831575395,  Spearman is [0.0947843756945895],
Epoch33,train total loss: 0.00385955585545908,  Spearman:0.9007285145871116
Epoch33,val total loss: 0.00697336858138442,  Spearman:[0.7619047619047621]
Epoch33,test total loss: 0.3821792395785451,  Spearman is [0.08599803208456502],
Epoch34,train total loss: 0.0038587215482645356,  Spearman:0.8987166615013282
Epoch34,val total loss: 0.00682345824316144,  Spearman:[0.8333333333333335]
Epoch34,test total loss: 0.3878248054534197,  Spearman is [0.07517037069410898],
Epoch35,train total loss: 0.0037793985199338445,  Spearman:0.9018554940361788
Epoch35,val total loss: 0.006832492537796497,  Spearman:[0.8095238095238096]
Epoch35,test total loss: 0.43987602218985555,  Spearman is [0.08146398722415145],
Epoch36,train total loss: 0.003376982784128557,  Spearman:0.9124775322520258
Epoch36,val total loss: 0.0068587446585297585,  Spearman:[0.8333333333333335]
Epoch36,test total loss: 0.39900587052106856,  Spearman is [0.07792585870559463],
Epoch37,train total loss: 0.00354801217364207,  Spearman:0.9039476803085087
Epoch37,val total loss: 0.004715449176728725,  Spearman:[0.8571428571428572]
Epoch37,test total loss: 0.375548380240798,  Spearman is [0.0671480704013193],
Epoch38,train total loss: 0.0035727386141213803,  Spearman:0.9079805046114704
Epoch38,val total loss: 0.00602960167452693,  Spearman:[0.8571428571428572]
Epoch38,test total loss: 0.4701720613986254,  Spearman is [0.07352972108282557],
Epoch39,train total loss: 0.0033170341208833866,  Spearman:0.909207978462564
Epoch39,val total loss: 0.0045706299133598804,  Spearman:[0.8571428571428572]
Epoch39,test total loss: 0.4155949678272009,  Spearman is [0.07421235237383182],
Epoch40,train total loss: 0.0031752468841239954,  Spearman:0.914725182141449
Epoch40,val total loss: 0.00594920851290226,  Spearman:[0.8571428571428572]
Epoch40,test total loss: 0.3441610120236874,  Spearman is [0.07259807289382281],
Epoch41,train total loss: 0.0032672886035214057,  Spearman:0.9131662857710736
Epoch41,val total loss: 0.005023150704801083,  Spearman:[0.8571428571428572]
Epoch41,test total loss: 0.36987344436347486,  Spearman is [0.07194463287781079],
Epoch42,train total loss: 0.0031617267593854847,  Spearman:0.9149783086335097
Epoch42,val total loss: 0.006878286600112915,  Spearman:[0.8095238095238096]
Epoch42,test total loss: 0.32437843941152095,  Spearman is [0.06922289994957485],
Epoch43,train total loss: 0.00309098985841653,  Spearman:0.9147001225118947
Epoch43,val total loss: 0.004421800374984741,  Spearman:[0.8571428571428572]
Epoch43,test total loss: 0.3334954407066107,  Spearman is [0.07702678190317586],
Epoch44,train total loss: 0.0030016480293572666,  Spearman:0.9174010463862102
Epoch44,val total loss: 0.0070737311616539955,  Spearman:[0.7857142857142858]
Epoch44,test total loss: 0.2491715645417571,  Spearman is [0.0720331273557557],
Epoch45,train total loss: 0.0029987285162907285,  Spearman:0.9175586951391015
Epoch45,val total loss: 0.006799917668104172,  Spearman:[0.8333333333333335]
Epoch45,test total loss: 0.2603505773469806,  Spearman is [0.0780483713104927],
Epoch46,train total loss: 0.0029956315991465743,  Spearman:0.9209353833958241
Epoch46,val total loss: 0.007586885709315538,  Spearman:[0.8571428571428572]
Epoch46,test total loss: 0.23358686789870262,  Spearman is [0.07145992882149178],
Epoch47,train total loss: 0.002696267117220813,  Spearman:0.9256478840072715
Epoch47,val total loss: 0.006759103387594223,  Spearman:[0.7857142857142858]
Epoch47,test total loss: 0.25007980708032845,  Spearman is [0.07851717437493608],
Epoch48,train total loss: 0.0027624015494485577,  Spearman:0.9245962643757274
Epoch48,val total loss: 0.006178789772093296,  Spearman:[0.7857142857142858]
Epoch48,test total loss: 0.27812692485749724,  Spearman is [0.08159723201215173],
Epoch49,train total loss: 0.0029966760783468206,  Spearman:0.9172882837588199
Epoch49,val total loss: 0.005055760033428669,  Spearman:[0.8333333333333335]
Epoch49,test total loss: 0.22243963740766048,  Spearman is [0.07409436412063368],
Early stop at epoch 49
ensemble idx 0, best epoch 1, best validation spearman is 0.880952380952381,best test spearman is [-0.030901588442341036],

ensemble 1 models, fold 4, spearman is -0.030901588442341036, ndcg is 0.7503665229902348
ensemble 5 fold, for test dataset SaCas9-mean-2,spearman is 0.15189268937463993, ndcg is 0.8061037454471403
training on fold 0 
Epoch0,train total loss: 0.1353398431211901,  Spearman:0.09126301268627136
Epoch0,val total loss: 0.24227343499660492,  Spearman:[0.7380952380952381]
Epoch0,test total loss: 0.1128799483180046,  Spearman is [-0.020971807005452908],
Epoch1,train total loss: 0.049336048744571134,  Spearman:0.47608420537325885
Epoch1,val total loss: 0.051318101584911346,  Spearman:[0.8571428571428572]
Epoch1,test total loss: 0.09564739782363177,  Spearman is [-0.06215296911352999],
Epoch2,train total loss: 0.03229087040735743,  Spearman:0.5981668927939633
Epoch2,val total loss: 0.024639219045639038,  Spearman:[0.9523809523809524]
Epoch2,test total loss: 0.3721575662493706,  Spearman is [-0.03590565294432659],
Epoch3,train total loss: 0.028293523979253877,  Spearman:0.627910449575533
Epoch3,val total loss: 0.033084288239479065,  Spearman:[0.9285714285714287]
Epoch3,test total loss: 0.31933628395199776,  Spearman is [-0.03513198880363683],
Epoch4,train total loss: 0.024655595215825506,  Spearman:0.6470461552792716
Epoch4,val total loss: 0.014903976581990719,  Spearman:[0.9047619047619048]
Epoch4,test total loss: 0.31769735626876355,  Spearman is [0.01543822237616709],
Epoch5,train total loss: 0.01882812654515967,  Spearman:0.6955501653973469
Epoch5,val total loss: 0.012959807179868221,  Spearman:[0.9285714285714287]
Epoch5,test total loss: 0.16414288990199566,  Spearman is [0.12564660293475033],
Epoch6,train total loss: 0.015731114177749708,  Spearman:0.7290273828134813
Epoch6,val total loss: 0.011069012805819511,  Spearman:[0.9761904761904763]
Epoch6,test total loss: 0.17918545566499233,  Spearman is [0.12717180924066676],
Epoch7,train total loss: 0.014486298247133024,  Spearman:0.7467818567289651
Epoch7,val total loss: 0.019687127321958542,  Spearman:[0.9285714285714287]
Epoch7,test total loss: 0.08713635178282857,  Spearman is [0.14482759196664663],
Epoch8,train total loss: 0.013618778017982364,  Spearman:0.7584142487349713
Epoch8,val total loss: 0.011444276198744774,  Spearman:[0.9761904761904763]
Epoch8,test total loss: 0.11145614217966796,  Spearman is [0.15921987037660043],
Epoch9,train total loss: 0.01256979716111882,  Spearman:0.7726204291830583
Epoch9,val total loss: 0.014813696034252644,  Spearman:[0.9761904761904763]
Epoch9,test total loss: 0.10700745871290565,  Spearman is [0.1627555394365297],
Epoch10,train total loss: 0.011504923111388985,  Spearman:0.7861631503033408
Epoch10,val total loss: 0.01935308426618576,  Spearman:[0.9285714285714287]
Epoch10,test total loss: 0.1031105007044971,  Spearman is [0.14258131710855218],
Epoch11,train total loss: 0.01112206701714641,  Spearman:0.7903929717943093
Epoch11,val total loss: 0.02346784621477127,  Spearman:[0.9047619047619048]
Epoch11,test total loss: 0.09738159300759434,  Spearman is [0.15798336111135125],
Epoch12,train total loss: 0.010535974437609697,  Spearman:0.7930938756353997
Epoch12,val total loss: 0.020047932863235474,  Spearman:[0.9047619047619048]
Epoch12,test total loss: 0.08977564815431834,  Spearman is [0.16893823701290517],
Epoch13,train total loss: 0.009990217580567472,  Spearman:0.8034155065175466
Epoch13,val total loss: 0.014717630110681057,  Spearman:[0.9047619047619048]
Epoch13,test total loss: 0.09968749377876521,  Spearman is [0.16110102084598008],
Epoch14,train total loss: 0.009689656962365963,  Spearman:0.8088935956761507
Epoch14,val total loss: 0.014429719187319279,  Spearman:[0.9523809523809524]
Epoch14,test total loss: 0.11677968166768551,  Spearman is [0.16370507459736944],
Epoch15,train total loss: 0.009468397428580105,  Spearman:0.8092603730674988
Epoch15,val total loss: 0.01269529014825821,  Spearman:[0.9047619047619048]
Epoch15,test total loss: 0.11100625172257424,  Spearman is [0.15444507476657232],
Epoch16,train total loss: 0.009208153766126204,  Spearman:0.8118798445827744
Epoch16,val total loss: 0.013121703639626503,  Spearman:[0.9047619047619048]
Epoch16,test total loss: 0.13373983297497033,  Spearman is [0.1687179379112366],
Epoch17,train total loss: 0.00920981968430659,  Spearman:0.8174647050621633
Epoch17,val total loss: 0.01420128159224987,  Spearman:[0.9047619047619048]
Epoch17,test total loss: 0.12764033023267984,  Spearman is [0.1670288093454009],
Epoch18,train total loss: 0.008823973859528987,  Spearman:0.81996450141515
Epoch18,val total loss: 0.022436421364545822,  Spearman:[0.9047619047619048]
Epoch18,test total loss: 0.10767798572778702,  Spearman is [0.16191266849745306],
Epoch19,train total loss: 0.008691582658614676,  Spearman:0.8213993708718096
Epoch19,val total loss: 0.0190059132874012,  Spearman:[0.9047619047619048]
Epoch19,test total loss: 0.10313841067254544,  Spearman is [0.1748212949305484],
Epoch20,train total loss: 0.008540748815553693,  Spearman:0.8208381088256647
Epoch20,val total loss: 0.019961170852184296,  Spearman:[0.9047619047619048]
Epoch20,test total loss: 0.11352919209748506,  Spearman is [0.17164119519680487],
Epoch21,train total loss: 0.007982436649632664,  Spearman:0.8304942406283443
Epoch21,val total loss: 0.015330891124904156,  Spearman:[0.9047619047619048]
Epoch21,test total loss: 0.1353095294907689,  Spearman is [0.1691663813930302],
Epoch22,train total loss: 0.007675246038557723,  Spearman:0.8338910263448944
Epoch22,val total loss: 0.014926429837942123,  Spearman:[0.9523809523809524]
Epoch22,test total loss: 0.15885211834684015,  Spearman is [0.17153687206400275],
Epoch23,train total loss: 0.0074751317487635575,  Spearman:0.8335357348784591
Epoch23,val total loss: 0.01674851030111313,  Spearman:[0.9047619047619048]
Epoch23,test total loss: 0.12404568968340754,  Spearman is [0.16314132590815322],
Epoch24,train total loss: 0.00750528442977856,  Spearman:0.8342760285881174
Epoch24,val total loss: 0.01642245426774025,  Spearman:[0.9047619047619048]
Epoch24,test total loss: 0.1521774573251605,  Spearman is [0.16828015427552667],
Epoch25,train total loss: 0.007257214666774066,  Spearman:0.8369171628060957
Epoch25,val total loss: 0.018799003213644028,  Spearman:[0.9047619047619048]
Epoch25,test total loss: 0.15422819927334785,  Spearman is [0.15508884135038864],
Epoch26,train total loss: 0.007319215432149717,  Spearman:0.8350308501876194
Epoch26,val total loss: 0.02014581486582756,  Spearman:[0.9047619047619048]
Epoch26,test total loss: 0.1351001899689436,  Spearman is [0.158403849623557],
Epoch27,train total loss: 0.007182128125956903,  Spearman:0.83612583464065
Epoch27,val total loss: 0.02158268913626671,  Spearman:[0.9047619047619048]
Epoch27,test total loss: 0.13275213893502952,  Spearman is [0.161001984891618],
Epoch28,train total loss: 0.006916715826940699,  Spearman:0.8395595079527574
Epoch28,val total loss: 0.02084592543542385,  Spearman:[0.880952380952381]
Epoch28,test total loss: 0.1427073936909437,  Spearman is [0.1638718311531937],
Epoch29,train total loss: 0.006836205128377351,  Spearman:0.8404230346469158
Epoch29,val total loss: 0.027608148753643036,  Spearman:[0.9047619047619048]
Epoch29,test total loss: 0.11104737482964992,  Spearman is [0.16589762935511967],
Epoch30,train total loss: 0.006826368817993893,  Spearman:0.8425140345480033
Epoch30,val total loss: 0.02240530401468277,  Spearman:[0.880952380952381]
Epoch30,test total loss: 0.1348598228767514,  Spearman is [0.1663765398738694],
Epoch31,train total loss: 0.006459419979737737,  Spearman:0.8461824188767868
Epoch31,val total loss: 0.023764364421367645,  Spearman:[0.880952380952381]
Epoch31,test total loss: 0.1219294300302863,  Spearman is [0.16021098617086854],
Epoch32,train total loss: 0.006510396133541154,  Spearman:0.8447398405901665
Epoch32,val total loss: 0.021995894610881805,  Spearman:[0.9047619047619048]
Epoch32,test total loss: 0.13916807826608418,  Spearman is [0.16444537822036476],
Epoch33,train total loss: 0.00628051341090423,  Spearman:0.8465297176273786
Epoch33,val total loss: 0.021005842834711075,  Spearman:[0.9047619047619048]
Epoch33,test total loss: 0.12587169157341122,  Spearman is [0.17156067751916815],
Epoch34,train total loss: 0.00606615455651011,  Spearman:0.8496066776772129
Epoch34,val total loss: 0.0238763727247715,  Spearman:[0.880952380952381]
Epoch34,test total loss: 0.12125933431088924,  Spearman is [0.16845670920930572],
Epoch35,train total loss: 0.005862550301035532,  Spearman:0.8519069968370969
Epoch35,val total loss: 0.018611470237374306,  Spearman:[0.880952380952381]
Epoch35,test total loss: 0.12910113744437696,  Spearman is [0.169768968485066],
Epoch36,train total loss: 0.005555128990612828,  Spearman:0.8563482774905983
Epoch36,val total loss: 0.037458375096321106,  Spearman:[0.9047619047619048]
Epoch36,test total loss: 0.10692901629954576,  Spearman is [0.1747979892584197],
Epoch37,train total loss: 0.005004330030015598,  Spearman:0.8586389480065195
Epoch37,val total loss: 0.019286099821329117,  Spearman:[0.9047619047619048]
Epoch37,test total loss: 0.11478508245199918,  Spearman is [0.17497998262076828],
Epoch38,train total loss: 0.004600190478436745,  Spearman:0.8576841454157753
Epoch38,val total loss: 0.02217746526002884,  Spearman:[0.9047619047619048]
Epoch38,test total loss: 0.0938492501154542,  Spearman is [0.16620787625119493],
Epoch39,train total loss: 0.004288245998442364,  Spearman:0.8599250766210723
Epoch39,val total loss: 0.013928018510341644,  Spearman:[0.9047619047619048]
Epoch39,test total loss: 0.10038632825016976,  Spearman is [0.17222219955296975],
Epoch40,train total loss: 0.0041089925436655255,  Spearman:0.8575970190211532
Epoch40,val total loss: 0.02034950815141201,  Spearman:[0.9047619047619048]
Epoch40,test total loss: 0.10867202021181584,  Spearman is [0.17298918895968357],
Epoch41,train total loss: 0.0040449927958737435,  Spearman:0.8559760246525034
Epoch41,val total loss: 0.013116768561303616,  Spearman:[0.9047619047619048]
Epoch41,test total loss: 0.0967145673930645,  Spearman is [0.1752358518072406],
Epoch42,train total loss: 0.004091590352263899,  Spearman:0.8586030348413412
Epoch42,val total loss: 0.011024787090718746,  Spearman:[0.9047619047619048]
Epoch42,test total loss: 0.10338416490703821,  Spearman is [0.17982031556951963],
Epoch43,train total loss: 0.003808964103928958,  Spearman:0.8658796752513093
Epoch43,val total loss: 0.012376612052321434,  Spearman:[0.9047619047619048]
Epoch43,test total loss: 0.10282999323680997,  Spearman is [0.17543800089336875],
Epoch44,train total loss: 0.0037049559155443255,  Spearman:0.8683084028016258
Epoch44,val total loss: 0.009632930159568787,  Spearman:[0.9047619047619048]
Epoch44,test total loss: 0.10182367507368326,  Spearman is [0.17644880550884273],
Epoch45,train total loss: 0.0037342140657039215,  Spearman:0.8690710988697792
Epoch45,val total loss: 0.010638403706252575,  Spearman:[0.9047619047619048]
Epoch45,test total loss: 0.09888125378638506,  Spearman is [0.17166740092576455],
Epoch46,train total loss: 0.0037450762693203078,  Spearman:0.8647538466363518
Epoch46,val total loss: 0.008922310546040535,  Spearman:[0.9047619047619048]
Epoch46,test total loss: 0.08674448477104306,  Spearman is [0.17499220757688774],
Epoch47,train total loss: 0.0036506271974828383,  Spearman:0.8657148634655327
Epoch47,val total loss: 0.011054604314267635,  Spearman:[0.9047619047619048]
Epoch47,test total loss: 0.10089936563745142,  Spearman is [0.1758509926600252],
Epoch48,train total loss: 0.0036487374738312494,  Spearman:0.8693986253992005
Epoch48,val total loss: 0.01474590040743351,  Spearman:[0.9047619047619048]
Epoch48,test total loss: 0.1229488561861217,  Spearman is [0.17118439350133302],
Epoch49,train total loss: 0.0035907120737903872,  Spearman:0.8690060347249404
Epoch49,val total loss: 0.008406322449445724,  Spearman:[0.9047619047619048]
Epoch49,test total loss: 0.09043366126716137,  Spearman is [0.18142903167519997],
Early stop at epoch 49
ensemble idx 0, best epoch 6, best validation spearman is 0.9761904761904763,best test spearman is [0.12717386755764656],

ensemble 1 models, fold 0, spearman is 0.12717386755764656, ndcg is 0.7907871722648122
training on fold 1 
Epoch0,train total loss: 0.10899053951008962,  Spearman:0.14694078099073718
Epoch0,val total loss: 0.07654722034931183,  Spearman:[0.5714285714285715]
Epoch0,test total loss: 0.014814233733341097,  Spearman is [0.05659007483958337],
Epoch1,train total loss: 0.04805773970647118,  Spearman:0.5255214876292145
Epoch1,val total loss: 0.07780852913856506,  Spearman:[0.5952380952380953]
Epoch1,test total loss: 0.10417556446045637,  Spearman is [-0.03897911476067737],
Epoch2,train total loss: 0.03469648990087593,  Spearman:0.6027572031268239
Epoch2,val total loss: 0.04936227202415466,  Spearman:[0.8095238095238096]
Epoch2,test total loss: 0.14602744728326797,  Spearman is [-0.030539614001975475],
Epoch3,train total loss: 0.027059584569472533,  Spearman:0.6469508543761076
Epoch3,val total loss: 0.035057105123996735,  Spearman:[0.6428571428571429]
Epoch3,test total loss: 0.1977671381086111,  Spearman is [-0.005289121675405839],
Epoch4,train total loss: 0.020365984501460425,  Spearman:0.6941952528440096
Epoch4,val total loss: 0.01967906579375267,  Spearman:[0.8095238095238096]
Epoch4,test total loss: 0.1352812223136425,  Spearman is [0.10038515483793055],
Epoch5,train total loss: 0.016168334572098386,  Spearman:0.7347953921500816
Epoch5,val total loss: 0.018823105841875076,  Spearman:[0.8095238095238096]
Epoch5,test total loss: 0.10181351457722485,  Spearman is [0.15097746826491976],
Epoch6,train total loss: 0.014334612573759679,  Spearman:0.7620355023519892
Epoch6,val total loss: 0.014777254313230515,  Spearman:[0.7857142857142858]
Epoch6,test total loss: 0.07566468538716435,  Spearman is [0.16887928234286162],
Epoch7,train total loss: 0.013292223155402984,  Spearman:0.7778260344729495
Epoch7,val total loss: 0.016778485849499702,  Spearman:[0.7857142857142858]
Epoch7,test total loss: 0.050311666913330555,  Spearman is [0.1820697403759633],
Epoch8,train total loss: 0.012584468796073148,  Spearman:0.7870842156056623
Epoch8,val total loss: 0.013471247628331184,  Spearman:[0.8333333333333335]
Epoch8,test total loss: 0.038189962552860376,  Spearman is [0.18450807659415722],
Epoch9,train total loss: 0.011877872879640797,  Spearman:0.7940185661787353
Epoch9,val total loss: 0.01516583003103733,  Spearman:[0.7857142857142858]
Epoch9,test total loss: 0.05120119210332632,  Spearman is [0.20532870251907848],
Epoch10,train total loss: 0.011129206667343775,  Spearman:0.8050106214774222
Epoch10,val total loss: 0.0180245041847229,  Spearman:[0.7857142857142858]
Epoch10,test total loss: 0.05930871143937111,  Spearman is [0.19241186254634174],
Epoch11,train total loss: 0.010654724038874682,  Spearman:0.8111234741097797
Epoch11,val total loss: 0.017839092761278152,  Spearman:[0.7857142857142858]
Epoch11,test total loss: 0.05123108355328441,  Spearman is [0.19476142151460954],
Epoch12,train total loss: 0.010451574224787645,  Spearman:0.8144510308890613
Epoch12,val total loss: 0.018070582300424576,  Spearman:[0.8333333333333335]
Epoch12,test total loss: 0.04566462729126215,  Spearman is [0.18742436979767577],
Epoch13,train total loss: 0.010002326523252308,  Spearman:0.8177102691878413
Epoch13,val total loss: 0.019833246245980263,  Spearman:[0.8333333333333335]
Epoch13,test total loss: 0.04424571814015508,  Spearman is [0.19309063367099938],
Epoch14,train total loss: 0.009847200175639816,  Spearman:0.8190290475836048
Epoch14,val total loss: 0.018650822341442108,  Spearman:[0.8333333333333335]
Epoch14,test total loss: 0.07337573254480959,  Spearman is [0.20003682874892495],
Epoch15,train total loss: 0.00958731439925778,  Spearman:0.8204835787653058
Epoch15,val total loss: 0.019753320142626762,  Spearman:[0.8333333333333335]
Epoch15,test total loss: 0.07343829879537225,  Spearman is [0.20141171215439235],
Epoch16,train total loss: 0.009373189178474534,  Spearman:0.8226651267582027
Epoch16,val total loss: 0.018167832866311073,  Spearman:[0.8333333333333335]
Epoch16,test total loss: 0.04466758957132697,  Spearman is [0.1970504541267054],
Epoch17,train total loss: 0.008877257597095404,  Spearman:0.829681042554358
Epoch17,val total loss: 0.015664637088775635,  Spearman:[0.8333333333333335]
Epoch17,test total loss: 0.06288542980328202,  Spearman is [0.20703058870453317],
Epoch18,train total loss: 0.00857058836472555,  Spearman:0.8347590755989635
Epoch18,val total loss: 0.015739805996418,  Spearman:[0.8333333333333335]
Epoch18,test total loss: 0.06525993095710873,  Spearman is [0.20583139876471584],
Epoch19,train total loss: 0.008291628398299694,  Spearman:0.8365644502136673
Epoch19,val total loss: 0.01599646732211113,  Spearman:[0.8333333333333335]
Epoch19,test total loss: 0.06827198681421578,  Spearman is [0.19716625911716462],
Epoch20,train total loss: 0.007889033677295232,  Spearman:0.8456779525566386
Epoch20,val total loss: 0.016700826585292816,  Spearman:[0.8333333333333335]
Epoch20,test total loss: 0.06733588785864413,  Spearman is [0.19746135469591916],
Epoch21,train total loss: 0.007797105107247495,  Spearman:0.8463015639617072
Epoch21,val total loss: 0.01680295541882515,  Spearman:[0.8333333333333335]
Epoch21,test total loss: 0.055008528055623174,  Spearman is [0.20070146127452018],
Epoch22,train total loss: 0.007747721831457546,  Spearman:0.8485161617175403
Epoch22,val total loss: 0.01647769846022129,  Spearman:[0.8333333333333335]
Epoch22,test total loss: 0.06530528073199093,  Spearman is [0.1933498698168763],
Epoch23,train total loss: 0.0075218625335345185,  Spearman:0.8492685817099065
Epoch23,val total loss: 0.0251359511166811,  Spearman:[0.8333333333333335]
Epoch23,test total loss: 0.049222160642966625,  Spearman is [0.19931188687821313],
Epoch24,train total loss: 0.007246312081592922,  Spearman:0.8548709577586817
Epoch24,val total loss: 0.015448849648237228,  Spearman:[0.7857142857142858]
Epoch24,test total loss: 0.06917087491601706,  Spearman is [0.20075469474401295],
Epoch25,train total loss: 0.00721627412041506,  Spearman:0.8572790327880148
Epoch25,val total loss: 0.01614493504166603,  Spearman:[0.880952380952381]
Epoch25,test total loss: 0.059458930417895316,  Spearman is [0.20027129933011875],
Epoch26,train total loss: 0.0071616656585739786,  Spearman:0.8609155685906106
Epoch26,val total loss: 0.016932740807533264,  Spearman:[0.8333333333333335]
Epoch26,test total loss: 0.05739677781239152,  Spearman is [0.2032752189673607],
Epoch27,train total loss: 0.006710498301216807,  Spearman:0.8650727295383435
Epoch27,val total loss: 0.02034875750541687,  Spearman:[0.8333333333333335]
Epoch27,test total loss: 0.06180871310643852,  Spearman is [0.18836682250679918],
Epoch28,train total loss: 0.006943152903262764,  Spearman:0.8606873391061202
Epoch28,val total loss: 0.016786890104413033,  Spearman:[0.8095238095238096]
Epoch28,test total loss: 0.06942939213477076,  Spearman is [0.20098259580871228],
Epoch29,train total loss: 0.006497957347444474,  Spearman:0.8662000055797232
Epoch29,val total loss: 0.017507735639810562,  Spearman:[0.9047619047619048]
Epoch29,test total loss: 0.06300678309053183,  Spearman is [0.19443241960247581],
Epoch30,train total loss: 0.00601701115971455,  Spearman:0.8673047782479184
Epoch30,val total loss: 0.02048414573073387,  Spearman:[0.880952380952381]
Epoch30,test total loss: 0.07740555861964822,  Spearman is [0.19248769804605648],
Epoch31,train total loss: 0.005584963963767036,  Spearman:0.8654019998708
Epoch31,val total loss: 0.02518531307578087,  Spearman:[0.7857142857142858]
Epoch31,test total loss: 0.08706560544669628,  Spearman is [0.18937881739503148],
Epoch32,train total loss: 0.00489727584257101,  Spearman:0.8726164987764644
Epoch32,val total loss: 0.023827511817216873,  Spearman:[0.8571428571428572]
Epoch32,test total loss: 0.07985430872067809,  Spearman is [0.1938344818078991],
Epoch33,train total loss: 0.004643204083922916,  Spearman:0.8707944412908555
Epoch33,val total loss: 0.02000338025391102,  Spearman:[0.9047619047619048]
Epoch33,test total loss: 0.08201195290312172,  Spearman is [0.1889338000574757],
Epoch34,train total loss: 0.004314891860047236,  Spearman:0.8726015067231645
Epoch34,val total loss: 0.0250175129622221,  Spearman:[0.8571428571428572]
Epoch34,test total loss: 0.08997592674568296,  Spearman is [0.18350659030187919],
Epoch35,train total loss: 0.0041506069328767275,  Spearman:0.8734676812173672
Epoch35,val total loss: 0.027700897306203842,  Spearman:[0.9047619047619048]
Epoch35,test total loss: 0.10043634288012981,  Spearman is [0.18540337214333838],
Epoch36,train total loss: 0.004163558443020194,  Spearman:0.873655850615465
Epoch36,val total loss: 0.02809891477227211,  Spearman:[0.8571428571428572]
Epoch36,test total loss: 0.09003585614264012,  Spearman is [0.18645354124903893],
Epoch37,train total loss: 0.0039074079223866695,  Spearman:0.8785355850833109
Epoch37,val total loss: 0.028466209769248962,  Spearman:[0.8571428571428572]
Epoch37,test total loss: 0.09335841815918684,  Spearman is [0.1870541818176689],
Epoch38,train total loss: 0.003957425622875468,  Spearman:0.8726480339107685
Epoch38,val total loss: 0.04628597944974899,  Spearman:[0.8571428571428572]
Epoch38,test total loss: 0.14582488900050522,  Spearman is [0.18553800448687455],
Epoch39,train total loss: 0.0036439446162265274,  Spearman:0.882690593413485
Epoch39,val total loss: 0.03275701403617859,  Spearman:[0.9047619047619048]
Epoch39,test total loss: 0.10491299843415618,  Spearman is [0.18734609456761125],
Epoch40,train total loss: 0.003534745906691592,  Spearman:0.8883060749114822
Epoch40,val total loss: 0.05482975021004677,  Spearman:[0.9047619047619048]
Epoch40,test total loss: 0.16243243394419551,  Spearman is [0.18433858438381676],
Epoch41,train total loss: 0.003636992559245883,  Spearman:0.8846524411801091
Epoch41,val total loss: 0.02782255783677101,  Spearman:[0.9047619047619048]
Epoch41,test total loss: 0.0808586698025465,  Spearman is [0.1837577247016888],
Epoch42,train total loss: 0.003490050971054305,  Spearman:0.8908614530514773
Epoch42,val total loss: 0.02622312866151333,  Spearman:[0.9047619047619048]
Epoch42,test total loss: 0.08674476183950901,  Spearman is [0.1819629183279781],
Epoch43,train total loss: 0.0035380361980806366,  Spearman:0.8871952646261749
Epoch43,val total loss: 0.04863160848617554,  Spearman:[0.9047619047619048]
Epoch43,test total loss: 0.13507280126214027,  Spearman is [0.19114057890349187],
Epoch44,train total loss: 0.0032887275682207053,  Spearman:0.8955530958726009
Epoch44,val total loss: 0.027959268540143967,  Spearman:[0.9047619047619048]
Epoch44,test total loss: 0.08434848170727491,  Spearman is [0.1878840518217008],
Epoch45,train total loss: 0.003560378945668419,  Spearman:0.88570916600311
Epoch45,val total loss: 0.031902313232421875,  Spearman:[0.9047619047619048]
Epoch45,test total loss: 0.10417009368538857,  Spearman is [0.18765630858322357],
Epoch46,train total loss: 0.0033594415883551566,  Spearman:0.892312215753441
Epoch46,val total loss: 0.028269169852137566,  Spearman:[0.9047619047619048]
Epoch46,test total loss: 0.09788127113133668,  Spearman is [0.18783836770649806],
Epoch47,train total loss: 0.0031380039812901462,  Spearman:0.8993206299212644
Epoch47,val total loss: 0.03935198858380318,  Spearman:[0.9047619047619048]
Epoch47,test total loss: 0.13966402551159263,  Spearman is [0.18659167864992396],
Epoch48,train total loss: 0.003007827172181211,  Spearman:0.9022777920403581
Epoch48,val total loss: 0.029319755733013153,  Spearman:[0.9047619047619048]
Epoch48,test total loss: 0.10600585779175162,  Spearman is [0.18844723496695454],
Epoch49,train total loss: 0.0031935336099615176,  Spearman:0.8934989271317485
Epoch49,val total loss: 0.028451643884181976,  Spearman:[0.9047619047619048]
Epoch49,test total loss: 0.0764878949150443,  Spearman is [0.1872314798499103],
Early stop at epoch 49
ensemble idx 0, best epoch 29, best validation spearman is 0.9047619047619048,best test spearman is [0.19442389041039032],

ensemble 1 models, fold 1, spearman is 0.19442389041039032, ndcg is 0.7883738003921624
training on fold 2 
Epoch0,train total loss: 0.09233108258400208,  Spearman:0.11687214437087592
Epoch0,val total loss: 0.11310307681560516,  Spearman:[0.6107893935757621]
Epoch0,test total loss: 0.04253399213775992,  Spearman is [-0.03511026139372898],
Epoch1,train total loss: 0.039003375034110666,  Spearman:0.5644130803014065
Epoch1,val total loss: 0.05983545631170273,  Spearman:[0.5389318178609664]
Epoch1,test total loss: 0.04846728686243296,  Spearman is [-0.03301527612169389],
Epoch2,train total loss: 0.029529150778379958,  Spearman:0.6493955330005277
Epoch2,val total loss: 0.044157784432172775,  Spearman:[0.5389318178609664]
Epoch2,test total loss: 0.31196352615952494,  Spearman is [-0.027964587123265643],
Epoch3,train total loss: 0.025000624391489115,  Spearman:0.6825175724572402
Epoch3,val total loss: 0.041703008115291595,  Spearman:[0.5389318178609664]
Epoch3,test total loss: 0.3029973194003105,  Spearman is [-0.0175555597869058],
Epoch4,train total loss: 0.021500008747889064,  Spearman:0.6993525432177051
Epoch4,val total loss: 0.04534789174795151,  Spearman:[0.5389318178609664]
Epoch4,test total loss: 0.3034492827951908,  Spearman is [0.014833123216763028],
Epoch5,train total loss: 0.016641081588414427,  Spearman:0.7359438191982299
Epoch5,val total loss: 0.02670935168862343,  Spearman:[0.6586944440522925]
Epoch5,test total loss: 0.1808894520625472,  Spearman is [0.10147937061177958],
Epoch6,train total loss: 0.014471824215247463,  Spearman:0.7676665964073036
Epoch6,val total loss: 0.02003210037946701,  Spearman:[0.6586944440522925]
Epoch6,test total loss: 0.14560556504875422,  Spearman is [0.10159572799401613],
Epoch7,train total loss: 0.013568999136810023,  Spearman:0.7848077333327955
Epoch7,val total loss: 0.020362012088298798,  Spearman:[0.542168674698795]
Epoch7,test total loss: 0.09378005601465703,  Spearman is [0.12930547508929932],
Epoch8,train total loss: 0.013016298019255582,  Spearman:0.7976003271224327
Epoch8,val total loss: 0.017539571970701218,  Spearman:[0.5389318178609664]
Epoch8,test total loss: 0.17443290501832961,  Spearman is [0.12658207183354622],
Epoch9,train total loss: 0.012623680227149565,  Spearman:0.8025415717625607
Epoch9,val total loss: 0.01981283351778984,  Spearman:[0.7065994945288228]
Epoch9,test total loss: 0.10701665757223963,  Spearman is [0.1418254873309587],
Epoch10,train total loss: 0.01204804784934729,  Spearman:0.8079024041200176
Epoch10,val total loss: 0.015796426683664322,  Spearman:[0.6347419188140272]
Epoch10,test total loss: 0.13743471866473556,  Spearman is [0.14204815382595867],
Epoch11,train total loss: 0.01152866187457664,  Spearman:0.8143488174479072
Epoch11,val total loss: 0.01698857545852661,  Spearman:[0.6347419188140272]
Epoch11,test total loss: 0.14016452096402646,  Spearman is [0.13562304174854412],
Epoch12,train total loss: 0.010936050123582857,  Spearman:0.8210605832061475
Epoch12,val total loss: 0.01573828235268593,  Spearman:[0.6826469692905576]
Epoch12,test total loss: 0.13201614040881396,  Spearman is [0.15198601728063635],
Epoch13,train total loss: 0.010609536818288362,  Spearman:0.8273627394995082
Epoch13,val total loss: 0.016146941110491753,  Spearman:[0.7065994945288228]
Epoch13,test total loss: 0.12190085407346488,  Spearman is [0.1496939070572097],
Epoch14,train total loss: 0.010188189887393935,  Spearman:0.8306454898438865
Epoch14,val total loss: 0.016540342941880226,  Spearman:[0.7065994945288228]
Epoch14,test total loss: 0.16464039124548435,  Spearman is [0.14478580747434802],
Epoch15,train total loss: 0.010007597671714254,  Spearman:0.8304011958258652
Epoch15,val total loss: 0.012066355906426907,  Spearman:[0.7065994945288228]
Epoch15,test total loss: 0.1062547923065722,  Spearman is [0.1464938817629272],
Epoch16,train total loss: 0.009342041484510096,  Spearman:0.8361950616320045
Epoch16,val total loss: 0.010667610913515091,  Spearman:[0.6347419188140272]
Epoch16,test total loss: 0.10422703232616186,  Spearman is [0.14612618612201084],
Epoch17,train total loss: 0.009202324744994538,  Spearman:0.8367056776330545
Epoch17,val total loss: 0.013344526290893555,  Spearman:[0.7545045450053531]
Epoch17,test total loss: 0.1699924051761627,  Spearman is [0.15749650667275622],
Epoch18,train total loss: 0.008547003788407892,  Spearman:0.8417568823656313
Epoch18,val total loss: 0.012178169563412666,  Spearman:[0.7545045450053531]
Epoch18,test total loss: 0.17347419280558823,  Spearman is [0.15204386716712529],
Epoch19,train total loss: 0.008519065721581379,  Spearman:0.8411189008991828
Epoch19,val total loss: 0.022746652364730835,  Spearman:[0.7545045450053531]
Epoch19,test total loss: 0.2684718851000071,  Spearman is [0.14088584918946254],
Epoch20,train total loss: 0.008101880630979745,  Spearman:0.8429051859396092
Epoch20,val total loss: 0.009640974923968315,  Spearman:[0.7831325301204818]
Epoch20,test total loss: 0.12090725991874933,  Spearman is [0.15593786751212685],
Epoch21,train total loss: 0.007663726788730576,  Spearman:0.8463501294016621
Epoch21,val total loss: 0.013834208250045776,  Spearman:[0.7784570702436182]
Epoch21,test total loss: 0.19488685093820096,  Spearman is [0.15348610291287001],
Epoch22,train total loss: 0.00762100959307132,  Spearman:0.8466152468457745
Epoch22,val total loss: 0.007240743841975927,  Spearman:[0.7545045450053531]
Epoch22,test total loss: 0.1794475793838501,  Spearman is [0.13691736144372668],
Epoch23,train total loss: 0.007380634722395394,  Spearman:0.8519027057030526
Epoch23,val total loss: 0.0077114407904446125,  Spearman:[0.7545045450053531]
Epoch23,test total loss: 0.13545217122882605,  Spearman is [0.14076651283728406],
Epoch24,train total loss: 0.007109537072187194,  Spearman:0.8519042280435332
Epoch24,val total loss: 0.007313251029700041,  Spearman:[0.7545045450053531]
Epoch24,test total loss: 0.16829224452376365,  Spearman is [0.1488833904936617],
Epoch25,train total loss: 0.00704348671850032,  Spearman:0.8522033681386476
Epoch25,val total loss: 0.01436605118215084,  Spearman:[0.7545045450053531]
Epoch25,test total loss: 0.21591535732150077,  Spearman is [0.14215820473540416],
Epoch26,train total loss: 0.006528938748091698,  Spearman:0.8596567785685295
Epoch26,val total loss: 0.00779889989644289,  Spearman:[0.7784570702436182]
Epoch26,test total loss: 0.18129667975008487,  Spearman is [0.1517483441423526],
Epoch27,train total loss: 0.006174069419592762,  Spearman:0.8609274796417233
Epoch27,val total loss: 0.013232940807938576,  Spearman:[0.7545045450053531]
Epoch27,test total loss: 0.18984044343233109,  Spearman is [0.15741675182185957],
Epoch28,train total loss: 0.004979554840247147,  Spearman:0.8685833892669798
Epoch28,val total loss: 0.006016131024807692,  Spearman:[0.7545045450053531]
Epoch28,test total loss: 0.12743080761283637,  Spearman is [0.1574102743706613],
Epoch29,train total loss: 0.004138378811125548,  Spearman:0.8751672191115538
Epoch29,val total loss: 0.005574842914938927,  Spearman:[0.7545045450053531]
Epoch29,test total loss: 0.12253351751714944,  Spearman is [0.1597397894087235],
Epoch30,train total loss: 0.0037143028976294235,  Spearman:0.8794961048139374
Epoch30,val total loss: 0.0064264023676514626,  Spearman:[0.7545045450053531]
Epoch30,test total loss: 0.1173745165579021,  Spearman is [0.16093481010584054],
Epoch31,train total loss: 0.003638597479528891,  Spearman:0.8789531792251406
Epoch31,val total loss: 0.005233327858150005,  Spearman:[0.7545045450053531]
Epoch31,test total loss: 0.10916473716497421,  Spearman is [0.1674054155917728],
Epoch32,train total loss: 0.003391235163480115,  Spearman:0.8872412710753934
Epoch32,val total loss: 0.006079152692109346,  Spearman:[0.7545045450053531]
Epoch32,test total loss: 0.15409917533397674,  Spearman is [0.1671395704728458],
Epoch33,train total loss: 0.0033158986976232906,  Spearman:0.8867722406478439
Epoch33,val total loss: 0.004017801955342293,  Spearman:[0.7545045450053531]
Epoch33,test total loss: 0.10344488369300961,  Spearman is [0.16722589484023698],
Epoch34,train total loss: 0.0031701946625103936,  Spearman:0.8900585945983479
Epoch34,val total loss: 0.010230245999991894,  Spearman:[0.7545045450053531]
Epoch34,test total loss: 0.17315787617117168,  Spearman is [0.16926160321369174],
Epoch35,train total loss: 0.002981277099491145,  Spearman:0.8971023808064915
Epoch35,val total loss: 0.007447510026395321,  Spearman:[0.8313253012048192]
Epoch35,test total loss: 0.1274386014789343,  Spearman is [0.17822216724462683],
Epoch36,train total loss: 0.0031144139748693514,  Spearman:0.8948018118675476
Epoch36,val total loss: 0.013066159561276436,  Spearman:[0.7545045450053531]
Epoch36,test total loss: 0.07480405769310891,  Spearman is [0.18097217737098742],
Epoch37,train total loss: 0.002885708090243264,  Spearman:0.9006334619153972
Epoch37,val total loss: 0.0027015279047191143,  Spearman:[0.7545045450053531]
Epoch37,test total loss: 0.09603842077776789,  Spearman is [0.16926410870496741],
Epoch38,train total loss: 0.00286020352527535,  Spearman:0.9022060270595693
Epoch38,val total loss: 0.0037122229114174843,  Spearman:[0.8263621207201486]
Epoch38,test total loss: 0.08723562308587134,  Spearman is [0.17455174089540226],
Epoch39,train total loss: 0.002856237923902555,  Spearman:0.9045376825226862
Epoch39,val total loss: 0.004178155213594437,  Spearman:[0.8263621207201486]
Epoch39,test total loss: 0.0959787830710411,  Spearman is [0.1746840321499774],
Epoch40,train total loss: 0.002817511703678741,  Spearman:0.9022913167334471
Epoch40,val total loss: 0.011484144255518913,  Spearman:[0.8263621207201486]
Epoch40,test total loss: 0.11586124077439308,  Spearman is [0.18097903623555578],
Epoch41,train total loss: 0.002788306647860923,  Spearman:0.9064007764518142
Epoch41,val total loss: 0.00562121020630002,  Spearman:[0.8263621207201486]
Epoch41,test total loss: 0.11877667102962733,  Spearman is [0.18105238597227255],
Epoch42,train total loss: 0.0027400408248351407,  Spearman:0.9054759658695165
Epoch42,val total loss: 0.008692577481269836,  Spearman:[0.8263621207201486]
Epoch42,test total loss: 0.10561159579083323,  Spearman is [0.18442078554115576],
Epoch43,train total loss: 0.0025516275970566757,  Spearman:0.9118851795122235
Epoch43,val total loss: 0.006347439251840115,  Spearman:[0.8263621207201486]
Epoch43,test total loss: 0.11247378019616008,  Spearman is [0.1853769691316011],
Epoch44,train total loss: 0.0026863184865737236,  Spearman:0.9114970087221773
Epoch44,val total loss: 0.0086573027074337,  Spearman:[0.8263621207201486]
Epoch44,test total loss: 0.11968916645273567,  Spearman is [0.18129540547382966],
Epoch45,train total loss: 0.0026331621420701058,  Spearman:0.9116804295419301
Epoch45,val total loss: 0.0037792883813381195,  Spearman:[0.8263621207201486]
Epoch45,test total loss: 0.08220152130816132,  Spearman is [0.17410884763575216],
Epoch46,train total loss: 0.0025789340564724393,  Spearman:0.914378478647463
Epoch46,val total loss: 0.01387800183147192,  Spearman:[0.8263621207201486]
Epoch46,test total loss: 0.1236320648342371,  Spearman is [0.18295524412328226],
Epoch47,train total loss: 0.002567547490262092,  Spearman:0.9143848923813866
Epoch47,val total loss: 0.0038540768437087536,  Spearman:[0.8263621207201486]
Epoch47,test total loss: 0.10015488187782466,  Spearman is [0.17352773148601333],
Epoch48,train total loss: 0.002712463122943285,  Spearman:0.9069261511758184
Epoch48,val total loss: 0.0027896666433662176,  Spearman:[0.8263621207201486]
Epoch48,test total loss: 0.09260619641281664,  Spearman is [0.16810023238234298],
Epoch49,train total loss: 0.0023499291152499304,  Spearman:0.918918054316074
Epoch49,val total loss: 0.004654805175960064,  Spearman:[0.8263621207201486]
Epoch49,test total loss: 0.09794141505844892,  Spearman is [0.17695087702568435],
Early stop at epoch 49
ensemble idx 0, best epoch 35, best validation spearman is 0.8313253012048192,best test spearman is [0.1782214307222571],

ensemble 1 models, fold 2, spearman is 0.1782214307222571, ndcg is 0.7996264858618556
training on fold 3 
Epoch0,train total loss: 0.14422960328654602,  Spearman:0.12511581223425855
Epoch0,val total loss: 0.07605451345443726,  Spearman:[0.30952380952380953]
Epoch0,test total loss: 0.036813804693520066,  Spearman is [-0.0136888041934927],
Epoch1,train total loss: 0.047499476514088035,  Spearman:0.5241093729070944
Epoch1,val total loss: 0.04867441952228546,  Spearman:[0.6904761904761906]
Epoch1,test total loss: 0.07106849923729897,  Spearman is [-0.038842864698364774],
Epoch2,train total loss: 0.03226068057716848,  Spearman:0.5933065928137334
Epoch2,val total loss: 0.03574131056666374,  Spearman:[0.7142857142857144]
Epoch2,test total loss: 0.3143603138625622,  Spearman is [-0.02394855422812487],
Epoch3,train total loss: 0.02791691883108937,  Spearman:0.6287593359506434
Epoch3,val total loss: 0.034015752375125885,  Spearman:[0.7619047619047621]
Epoch3,test total loss: 0.4633530110120773,  Spearman is [-0.025379643496934428],
Epoch4,train total loss: 0.024557138458849527,  Spearman:0.6513346002996735
Epoch4,val total loss: 0.025857966393232346,  Spearman:[0.7857142857142858]
Epoch4,test total loss: 0.31919122859835625,  Spearman is [0.010885146303806383],
Epoch5,train total loss: 0.017838848056271672,  Spearman:0.6989082253751449
Epoch5,val total loss: 0.02333541214466095,  Spearman:[0.7380952380952381]
Epoch5,test total loss: 0.24834048934280872,  Spearman is [0.09702896049688901],
Epoch6,train total loss: 0.01514847130359461,  Spearman:0.7339494075215237
Epoch6,val total loss: 0.023996101692318916,  Spearman:[0.7857142857142858]
Epoch6,test total loss: 0.18525419291108847,  Spearman is [0.13982736132663937],
Epoch7,train total loss: 0.013736470903938588,  Spearman:0.7531949450282486
Epoch7,val total loss: 0.019282519817352295,  Spearman:[0.7857142857142858]
Epoch7,test total loss: 0.1158285048790276,  Spearman is [0.12657281927127614],
Epoch8,train total loss: 0.013148319849278778,  Spearman:0.7607405967824709
Epoch8,val total loss: 0.02020454779267311,  Spearman:[0.8571428571428572]
Epoch8,test total loss: 0.10034676957875491,  Spearman is [0.1507169695092661],
Epoch9,train total loss: 0.012110042391726986,  Spearman:0.7705399005021452
Epoch9,val total loss: 0.026622096076607704,  Spearman:[0.7142857142857144]
Epoch9,test total loss: 0.10454783411696553,  Spearman is [0.13306743407124402],
Epoch10,train total loss: 0.011948820358763138,  Spearman:0.7766306307865817
Epoch10,val total loss: 0.024522360414266586,  Spearman:[0.7857142857142858]
Epoch10,test total loss: 0.1656121551990509,  Spearman is [0.13752556451883183],
Epoch11,train total loss: 0.011646940520642182,  Spearman:0.7786628628448796
Epoch11,val total loss: 0.023060986772179604,  Spearman:[0.7142857142857144]
Epoch11,test total loss: 0.1576417038217187,  Spearman is [0.1398767214775983],
Epoch12,train total loss: 0.010936095937489508,  Spearman:0.7874352289852281
Epoch12,val total loss: 0.025092855095863342,  Spearman:[0.7142857142857144]
Epoch12,test total loss: 0.2616582248359919,  Spearman is [0.1298556178429528],
Epoch13,train total loss: 0.01080075008287214,  Spearman:0.7839910183289605
Epoch13,val total loss: 0.019081182777881622,  Spearman:[0.7857142857142858]
Epoch13,test total loss: 0.20319999642670156,  Spearman is [0.13234344573395737],
Epoch14,train total loss: 0.009808632983969381,  Spearman:0.7987414294504936
Epoch14,val total loss: 0.02645784802734852,  Spearman:[0.7142857142857144]
Epoch14,test total loss: 0.1693693704903126,  Spearman is [0.12838673577004503],
Epoch15,train total loss: 0.00931610334933234,  Spearman:0.8019985715661488
Epoch15,val total loss: 0.027399253100156784,  Spearman:[0.8095238095238096]
Epoch15,test total loss: 0.1727567885071039,  Spearman is [0.1345407418544629],
Epoch16,train total loss: 0.0089034671904161,  Spearman:0.8084311316160565
Epoch16,val total loss: 0.02714262716472149,  Spearman:[0.8095238095238096]
Epoch16,test total loss: 0.1793250162154436,  Spearman is [0.135824079475025],
Epoch17,train total loss: 0.008492785952209184,  Spearman:0.8114492413290247
Epoch17,val total loss: 0.03960146754980087,  Spearman:[0.8095238095238096]
Epoch17,test total loss: 0.13914113938808442,  Spearman is [0.1332992807914956],
Epoch18,train total loss: 0.008288825936734868,  Spearman:0.8165404834237343
Epoch18,val total loss: 0.026901502162218094,  Spearman:[0.7857142857142858]
Epoch18,test total loss: 0.1942645199596882,  Spearman is [0.13846395977882903],
Epoch19,train total loss: 0.00805772581206372,  Spearman:0.8199598754699072
Epoch19,val total loss: 0.03821830824017525,  Spearman:[0.8095238095238096]
Epoch19,test total loss: 0.1263050867244601,  Spearman is [0.14090309170422602],
Epoch20,train total loss: 0.007900524062838836,  Spearman:0.8220628862023858
Epoch20,val total loss: 0.03455568104982376,  Spearman:[0.8095238095238096]
Epoch20,test total loss: 0.14922077041119336,  Spearman is [0.13700628336768972],
Epoch21,train total loss: 0.007582342461085854,  Spearman:0.8262577506430907
Epoch21,val total loss: 0.058227673172950745,  Spearman:[0.8095238095238096]
Epoch21,test total loss: 0.08617073632776737,  Spearman is [0.14040566290875087],
Epoch22,train total loss: 0.007179955589937237,  Spearman:0.829372052114438
Epoch22,val total loss: 0.04185369610786438,  Spearman:[0.8095238095238096]
Epoch22,test total loss: 0.12153587993234397,  Spearman is [0.1530528173244897],
Epoch23,train total loss: 0.006845057413626749,  Spearman:0.834890076216367
Epoch23,val total loss: 0.03488478437066078,  Spearman:[0.8095238095238096]
Epoch23,test total loss: 0.12388767469674349,  Spearman is [0.15959934379934032],
Epoch24,train total loss: 0.006482806443296469,  Spearman:0.8428884574469875
Epoch24,val total loss: 0.031089548021554947,  Spearman:[0.7857142857142858]
Epoch24,test total loss: 0.15106187704950572,  Spearman is [0.147214108575254],
Epoch25,train total loss: 0.005852523629959577,  Spearman:0.8444611015589201
Epoch25,val total loss: 0.03615681827068329,  Spearman:[0.8095238095238096]
Epoch25,test total loss: 0.09489505030214787,  Spearman is [0.15773955905477627],
Epoch26,train total loss: 0.00533207996825998,  Spearman:0.8463295985675062
Epoch26,val total loss: 0.0431247241795063,  Spearman:[0.8095238095238096]
Epoch26,test total loss: 0.1234038570895791,  Spearman is [0.15082540927602775],
Epoch27,train total loss: 0.004674652577915157,  Spearman:0.8555672396144401
Epoch27,val total loss: 0.041731979697942734,  Spearman:[0.8333333333333335]
Epoch27,test total loss: 0.1436379063874483,  Spearman is [0.14727363536535262],
Epoch28,train total loss: 0.0044948419918700196,  Spearman:0.8554876077363092
Epoch28,val total loss: 0.0281226709485054,  Spearman:[0.7857142857142858]
Epoch28,test total loss: 0.14971326421946288,  Spearman is [0.15785775116684464],
Epoch29,train total loss: 0.004140620441877474,  Spearman:0.8600423549165224
Epoch29,val total loss: 0.06709221005439758,  Spearman:[0.7857142857142858]
Epoch29,test total loss: 0.09328541466966271,  Spearman is [0.15630322864017476],
Epoch30,train total loss: 0.004160415049857245,  Spearman:0.8567010736568281
Epoch30,val total loss: 0.02966095693409443,  Spearman:[0.8571428571428572]
Epoch30,test total loss: 0.10241804495453835,  Spearman is [0.1587923191409561],
Epoch31,train total loss: 0.004030491064604109,  Spearman:0.8614792378437652
Epoch31,val total loss: 0.03270098567008972,  Spearman:[0.8095238095238096]
Epoch31,test total loss: 0.11855082027614117,  Spearman is [0.1584709981049641],
Epoch32,train total loss: 0.00391565252338739,  Spearman:0.8624022403689818
Epoch32,val total loss: 0.030407438054680824,  Spearman:[0.8571428571428572]
Epoch32,test total loss: 0.11101079769432545,  Spearman is [0.15940622368833432],
Epoch33,train total loss: 0.0037308747213011463,  Spearman:0.8698789806716672
Epoch33,val total loss: 0.03450239822268486,  Spearman:[0.8095238095238096]
Epoch33,test total loss: 0.09083087788894773,  Spearman is [0.1600251984030972],
Epoch34,train total loss: 0.0038271462481367425,  Spearman:0.8602508647351641
Epoch34,val total loss: 0.02830648422241211,  Spearman:[0.8571428571428572]
Epoch34,test total loss: 0.12828766480088233,  Spearman is [0.15620620497014437],
Epoch35,train total loss: 0.003730086600393033,  Spearman:0.8690023028668198
Epoch35,val total loss: 0.02468622662127018,  Spearman:[0.8571428571428572]
Epoch35,test total loss: 0.13029003702104092,  Spearman is [0.16006378691439843],
Epoch36,train total loss: 0.0035343184367192383,  Spearman:0.8785676011846861
Epoch36,val total loss: 0.02630983665585518,  Spearman:[0.8571428571428572]
Epoch36,test total loss: 0.09714643340557813,  Spearman is [0.16178781480359394],
Epoch37,train total loss: 0.0034670440576379546,  Spearman:0.8799884954488736
Epoch37,val total loss: 0.0253433957695961,  Spearman:[0.8571428571428572]
Epoch37,test total loss: 0.1273389147594571,  Spearman is [0.1607240857949788],
Epoch38,train total loss: 0.0034650464464599886,  Spearman:0.8807419230355891
Epoch38,val total loss: 0.026624441146850586,  Spearman:[0.8095238095238096]
Epoch38,test total loss: 0.10152923678979278,  Spearman is [0.16365513575026286],
Epoch39,train total loss: 0.0033444428431371655,  Spearman:0.8835541345421228
Epoch39,val total loss: 0.026038333773612976,  Spearman:[0.8095238095238096]
Epoch39,test total loss: 0.1394200475886464,  Spearman is [0.16701546645354165],
Epoch40,train total loss: 0.003396711374546449,  Spearman:0.8851422719201827
Epoch40,val total loss: 0.026836920529603958,  Spearman:[0.8571428571428572]
Epoch40,test total loss: 0.11422897605225443,  Spearman is [0.16401253323018777],
Epoch41,train total loss: 0.003286200252403386,  Spearman:0.8898321543552079
Epoch41,val total loss: 0.0282242801040411,  Spearman:[0.8571428571428572]
Epoch41,test total loss: 0.1177071563899517,  Spearman is [0.16554243486621142],
Epoch42,train total loss: 0.00325415075610344,  Spearman:0.8883674300253157
Epoch42,val total loss: 0.029050473123788834,  Spearman:[0.8571428571428572]
Epoch42,test total loss: 0.12939842119812967,  Spearman is [0.17073560148663225],
Epoch43,train total loss: 0.003255591834880388,  Spearman:0.8922537457958915
Epoch43,val total loss: 0.030045311897993088,  Spearman:[0.8571428571428572]
Epoch43,test total loss: 0.09566608862951398,  Spearman is [0.16704499310925783],
Epoch44,train total loss: 0.0032724582534940103,  Spearman:0.8906030430227099
Epoch44,val total loss: 0.029702909290790558,  Spearman:[0.8571428571428572]
Epoch44,test total loss: 0.0814015214331448,  Spearman is [0.16584520474501513],
Epoch45,train total loss: 0.003090727395969085,  Spearman:0.8991750544637461
Epoch45,val total loss: 0.02629670314490795,  Spearman:[0.8571428571428572]
Epoch45,test total loss: 0.1135696429759264,  Spearman is [0.1736399525060126],
Epoch46,train total loss: 0.003223919850521876,  Spearman:0.8877406609937137
Epoch46,val total loss: 0.03597870469093323,  Spearman:[0.8571428571428572]
Epoch46,test total loss: 0.08455175058916212,  Spearman is [0.1701029221949178],
Epoch47,train total loss: 0.0031989082109738286,  Spearman:0.8923239235325175
Epoch47,val total loss: 0.02636921964585781,  Spearman:[0.8571428571428572]
Epoch47,test total loss: 0.10470572151243687,  Spearman is [0.1660143813029114],
Epoch48,train total loss: 0.0030885071319062263,  Spearman:0.8945643244445225
Epoch48,val total loss: 0.018492406234145164,  Spearman:[0.8571428571428572]
Epoch48,test total loss: 0.08968653408810497,  Spearman is [0.16261198333535282],
Epoch49,train total loss: 0.0030968946565945563,  Spearman:0.8985932238952556
Epoch49,val total loss: 0.032917533069849014,  Spearman:[0.8571428571428572]
Epoch49,test total loss: 0.08548893881961703,  Spearman is [0.17025753928382625],
Early stop at epoch 49
ensemble idx 0, best epoch 8, best validation spearman is 0.8571428571428572,best test spearman is [0.1507073289575334],

ensemble 1 models, fold 3, spearman is 0.1507073289575334, ndcg is 0.7939900109019647
training on fold 4 
Epoch0,train total loss: 0.19253318974127373,  Spearman:0.0451389887128781
Epoch0,val total loss: 0.0779063031077385,  Spearman:[0.4523809523809524]
Epoch0,test total loss: 0.012200165819376708,  Spearman is [-0.01917323253068978],
Epoch1,train total loss: 0.061234785351329125,  Spearman:0.48952151881092426
Epoch1,val total loss: 0.040071554481983185,  Spearman:[0.5952380952380953]
Epoch1,test total loss: 0.04328344035893679,  Spearman is [-0.04921453982882976],
Epoch2,train total loss: 0.040136652819525734,  Spearman:0.5909023717701226
Epoch2,val total loss: 0.030308682471513748,  Spearman:[0.7619047619047621]
Epoch2,test total loss: 0.11237031854689121,  Spearman is [-0.043667322959610844],
Epoch3,train total loss: 0.03205068906148275,  Spearman:0.6334872815806728
Epoch3,val total loss: 0.0372050479054451,  Spearman:[0.8095238095238096]
Epoch3,test total loss: 0.28142382130026816,  Spearman is [-0.030520392083343322],
Epoch4,train total loss: 0.02737126962090723,  Spearman:0.6619322982912953
Epoch4,val total loss: 0.03040202148258686,  Spearman:[0.7380952380952381]
Epoch4,test total loss: 0.20506059639155866,  Spearman is [-0.0028645097624412533],
Epoch5,train total loss: 0.021653267993735008,  Spearman:0.6993687205485896
Epoch5,val total loss: 0.006183349993079901,  Spearman:[0.6428571428571429]
Epoch5,test total loss: 0.272557707503438,  Spearman is [0.07892316917907982],
Epoch6,train total loss: 0.018614974595272005,  Spearman:0.7333452318929703
Epoch6,val total loss: 0.009487944655120373,  Spearman:[0.7380952380952381]
Epoch6,test total loss: 0.3277836419641972,  Spearman is [0.1071292863189316],
Epoch7,train total loss: 0.016636403093938358,  Spearman:0.7541340032070157
Epoch7,val total loss: 0.006157148629426956,  Spearman:[0.7619047619047621]
Epoch7,test total loss: 0.19560541473329068,  Spearman is [0.13360269512737286],
Epoch8,train total loss: 0.015390215360989364,  Spearman:0.7705128323534728
Epoch8,val total loss: 0.00783295277506113,  Spearman:[0.7619047619047621]
Epoch8,test total loss: 0.14816272631287575,  Spearman is [0.13837105931885074],
Epoch9,train total loss: 0.014382630500058906,  Spearman:0.7820612624832654
Epoch9,val total loss: 0.004495859611779451,  Spearman:[0.7142857142857144]
Epoch9,test total loss: 0.13093315809965134,  Spearman is [0.15640551976036743],
Epoch10,train total loss: 0.013496187369291408,  Spearman:0.7937646496313392
Epoch10,val total loss: 0.007218470796942711,  Spearman:[0.7619047619047621]
Epoch10,test total loss: 0.10780605543404817,  Spearman is [0.16362103871019862],
Epoch11,train total loss: 0.012719475138836946,  Spearman:0.800000536872429
Epoch11,val total loss: 0.006437904201447964,  Spearman:[0.7619047619047621]
Epoch11,test total loss: 0.11505223289132119,  Spearman is [0.15773924340233209],
Epoch12,train total loss: 0.012088751897980005,  Spearman:0.8069098282460857
Epoch12,val total loss: 0.009655938483774662,  Spearman:[0.8333333333333335]
Epoch12,test total loss: 0.09497033664956689,  Spearman is [0.16320768525844986],
Epoch13,train total loss: 0.011389360770595092,  Spearman:0.8172444107870814
Epoch13,val total loss: 0.006586674600839615,  Spearman:[0.7857142857142858]
Epoch13,test total loss: 0.10325239971280098,  Spearman is [0.1600859154659541],
Epoch14,train total loss: 0.010916466681429973,  Spearman:0.821971355067776
Epoch14,val total loss: 0.01012499537318945,  Spearman:[0.7857142857142858]
Epoch14,test total loss: 0.10281425071880221,  Spearman is [0.1615696200515532],
Epoch15,train total loss: 0.010227721753136184,  Spearman:0.8270142109337021
Epoch15,val total loss: 0.00696773175150156,  Spearman:[0.8333333333333335]
Epoch15,test total loss: 0.13161255046725273,  Spearman is [0.16254269104776228],
Epoch16,train total loss: 0.00972031453737798,  Spearman:0.83053411784667
Epoch16,val total loss: 0.009764380753040314,  Spearman:[0.7857142857142858]
Epoch16,test total loss: 0.0955730720423162,  Spearman is [0.16519165951152173],
Epoch17,train total loss: 0.009439774479967756,  Spearman:0.8350930000938129
Epoch17,val total loss: 0.007418227382004261,  Spearman:[0.880952380952381]
Epoch17,test total loss: 0.12102840421721339,  Spearman is [0.16296849961887105],
Epoch18,train total loss: 0.00883050452476033,  Spearman:0.845078272565991
Epoch18,val total loss: 0.00871369056403637,  Spearman:[0.7857142857142858]
Epoch18,test total loss: 0.1085319242440164,  Spearman is [0.16961915851983875],
Epoch19,train total loss: 0.008720043300388333,  Spearman:0.8423417663653541
Epoch19,val total loss: 0.012491600587964058,  Spearman:[0.9285714285714287]
Epoch19,test total loss: 0.09848430547863245,  Spearman is [0.16262238671382565],
Epoch20,train total loss: 0.008500006064050233,  Spearman:0.8469377785238562
Epoch20,val total loss: 0.01714308187365532,  Spearman:[0.8333333333333335]
Epoch20,test total loss: 0.09490382624790072,  Spearman is [0.16265853549477705],
Epoch21,train total loss: 0.008210406531221591,  Spearman:0.8498604779120941
Epoch21,val total loss: 0.010844044387340546,  Spearman:[0.8333333333333335]
Epoch21,test total loss: 0.10670286668464542,  Spearman is [0.15430895622611146],
Epoch22,train total loss: 0.007434528602364783,  Spearman:0.8569478887703124
Epoch22,val total loss: 0.015582808293402195,  Spearman:[0.880952380952381]
Epoch22,test total loss: 0.09689813908189535,  Spearman is [0.15712411570173265],
Epoch23,train total loss: 0.006535282169725412,  Spearman:0.8632304832685722
Epoch23,val total loss: 0.019334008917212486,  Spearman:[0.9285714285714287]
Epoch23,test total loss: 0.08842235072515905,  Spearman is [0.15312012363211888],
Epoch24,train total loss: 0.005723135344361743,  Spearman:0.8645600107373351
Epoch24,val total loss: 0.019040193408727646,  Spearman:[1.0]
Epoch24,test total loss: 0.07300416845828295,  Spearman is [0.166586231738195],
Epoch25,train total loss: 0.005179387584436112,  Spearman:0.8734109141396217
Epoch25,val total loss: 0.026224063709378242,  Spearman:[0.9047619047619048]
Epoch25,test total loss: 0.1058758232742548,  Spearman is [0.16345310503380125],
Epoch26,train total loss: 0.004813834318879227,  Spearman:0.8766000867060417
Epoch26,val total loss: 0.01700643263757229,  Spearman:[0.9761904761904763]
Epoch26,test total loss: 0.08986488985829055,  Spearman is [0.1636631257027562],
Epoch27,train total loss: 0.004301142750475078,  Spearman:0.8864948591166018
Epoch27,val total loss: 0.03593428432941437,  Spearman:[0.9285714285714287]
Epoch27,test total loss: 0.13944229688495396,  Spearman is [0.16457824159499496],
Epoch28,train total loss: 0.0043749232330204295,  Spearman:0.883918905352462
Epoch28,val total loss: 0.027445942163467407,  Spearman:[0.9761904761904763]
Epoch28,test total loss: 0.12093829186633229,  Spearman is [0.15954678766738403],
Epoch29,train total loss: 0.004349310298820432,  Spearman:0.8874623654515643
Epoch29,val total loss: 0.016098467633128166,  Spearman:[0.8095238095238096]
Epoch29,test total loss: 0.09502113917842507,  Spearman is [0.1635674698599839],
Epoch30,train total loss: 0.00428076449129432,  Spearman:0.8869908933236232
Epoch30,val total loss: 0.015173859894275665,  Spearman:[0.9047619047619048]
Epoch30,test total loss: 0.06797746513038874,  Spearman is [0.16110182339413082],
Epoch31,train total loss: 0.003978032665401816,  Spearman:0.8941660894588757
Epoch31,val total loss: 0.02533692866563797,  Spearman:[0.8095238095238096]
Epoch31,test total loss: 0.10294413836672903,  Spearman is [0.1603760789752683],
Epoch32,train total loss: 0.0039052151860699104,  Spearman:0.8942821548850711
Epoch32,val total loss: 0.021601345390081406,  Spearman:[0.8571428571428572]
Epoch32,test total loss: 0.0881436038762331,  Spearman is [0.16096427100063085],
Epoch33,train total loss: 0.00383119245517987,  Spearman:0.8946874204396019
Epoch33,val total loss: 0.02923702634871006,  Spearman:[0.880952380952381]
Epoch33,test total loss: 0.10118303801864385,  Spearman is [0.1580707047730934],
Epoch34,train total loss: 0.003749008462480747,  Spearman:0.8980628973401058
Epoch34,val total loss: 0.026357421651482582,  Spearman:[0.9523809523809524]
Epoch34,test total loss: 0.08926070732995868,  Spearman is [0.15437166584502227],
Epoch35,train total loss: 0.0036063373632854424,  Spearman:0.9022622683997765
Epoch35,val total loss: 0.024546949192881584,  Spearman:[0.6428571428571429]
Epoch35,test total loss: 0.0794016889296472,  Spearman is [0.15818016383420602],
Epoch36,train total loss: 0.0036746405482214564,  Spearman:0.9002648434788776
Epoch36,val total loss: 0.021370280534029007,  Spearman:[0.8095238095238096]
Epoch36,test total loss: 0.07518151244148612,  Spearman is [0.16234513207425996],
Epoch37,train total loss: 0.0036638796401138487,  Spearman:0.898844653543894
Epoch37,val total loss: 0.019221102818846703,  Spearman:[0.880952380952381]
Epoch37,test total loss: 0.06399303660728037,  Spearman is [0.15340049533957087],
Epoch38,train total loss: 0.003592398514648756,  Spearman:0.9044208219296734
Epoch38,val total loss: 0.021612776443362236,  Spearman:[0.7619047619047621]
Epoch38,test total loss: 0.042126107565127316,  Spearman is [0.15502674988418105],
Epoch39,train total loss: 0.0034216795126364254,  Spearman:0.9058242792374895
Epoch39,val total loss: 0.018296651542186737,  Spearman:[0.6428571428571429]
Epoch39,test total loss: 0.05899269315414131,  Spearman is [0.1592941341901868],
Epoch40,train total loss: 0.0034819808680391037,  Spearman:0.906399913659274
Epoch40,val total loss: 0.01814945787191391,  Spearman:[0.4761904761904762]
Epoch40,test total loss: 0.06404145173728466,  Spearman is [0.15135313413005172],
Epoch41,train total loss: 0.003236268094788568,  Spearman:0.9143135028986539
Epoch41,val total loss: 0.017869265750050545,  Spearman:[0.5476190476190477]
Epoch41,test total loss: 0.04485756340436638,  Spearman is [0.159956458507284],
Epoch42,train total loss: 0.003319873723040263,  Spearman:0.9105858441261592
Epoch42,val total loss: 0.01792476512491703,  Spearman:[0.5000000000000001]
Epoch42,test total loss: 0.06737775080837309,  Spearman is [0.1514920935425102],
Epoch43,train total loss: 0.0032073207321212604,  Spearman:0.9129154314350605
Epoch43,val total loss: 0.01709752157330513,  Spearman:[0.523809523809524]
Epoch43,test total loss: 0.05585719193331897,  Spearman is [0.15947850809805192],
Epoch44,train total loss: 0.003345424014230211,  Spearman:0.9136281969229998
Epoch44,val total loss: 0.020255183801054955,  Spearman:[0.7619047619047621]
Epoch44,test total loss: 0.04098830420989543,  Spearman is [0.1553345899303694],
Epoch45,train total loss: 0.0032902207115115835,  Spearman:0.9103178069974551
Epoch45,val total loss: 0.018767237663269043,  Spearman:[0.5476190476190477]
Epoch45,test total loss: 0.04735067440196872,  Spearman is [0.15092906822347854],
Epoch46,train total loss: 0.003378548618713513,  Spearman:0.9101462545587071
Epoch46,val total loss: 0.020042208954691887,  Spearman:[0.6666666666666669]
Epoch46,test total loss: 0.08344924366101622,  Spearman is [0.1539653093557862],
Epoch47,train total loss: 0.0032546062082894,  Spearman:0.9116243382780658
Epoch47,val total loss: 0.018825164064764977,  Spearman:[0.4285714285714286]
Epoch47,test total loss: 0.0393963361158967,  Spearman is [0.15801858923934042],
Epoch48,train total loss: 0.0034799497482778793,  Spearman:0.9047373226140452
Epoch48,val total loss: 0.016584109514951706,  Spearman:[0.4285714285714286]
Epoch48,test total loss: 0.05324024299625307,  Spearman is [0.15256006413084405],
Epoch49,train total loss: 0.0032943189901580364,  Spearman:0.9151708877285953
Epoch49,val total loss: 0.021129153668880463,  Spearman:[0.7619047619047621]
Epoch49,test total loss: 0.08135600052773953,  Spearman is [0.14895509620723169],
Early stop at epoch 49
ensemble idx 0, best epoch 24, best validation spearman is 1.0,best test spearman is [0.16658477184564063],

ensemble 1 models, fold 4, spearman is 0.16658477184564063, ndcg is 0.7976188059174408
ensemble 5 fold, for test dataset SaCas9-mean-2,spearman is 0.17455911269519245, ndcg is 0.8169624780986907
training on fold 0 
Epoch0,train total loss: 0.14813359123535264,  Spearman:0.11564865302222699
Epoch0,val total loss: 0.08514782786369324,  Spearman:[0.9047619047619048]
Epoch0,test total loss: 0.06537747625261545,  Spearman is [-0.1080449940595032],
Epoch1,train total loss: 0.050893182549864434,  Spearman:0.48217374950023234
Epoch1,val total loss: 0.16217023134231567,  Spearman:[0.8571428571428572]
Epoch1,test total loss: 0.04778760727494955,  Spearman is [-0.07022689173312859],
Epoch2,train total loss: 0.03352826331646588,  Spearman:0.5827466870554896
Epoch2,val total loss: 0.03261465206742287,  Spearman:[0.9761904761904763]
Epoch2,test total loss: 0.4473185271024704,  Spearman is [-0.03692503936062677],
Epoch3,train total loss: 0.02729105717765215,  Spearman:0.6266098113832066
Epoch3,val total loss: 0.024744700640439987,  Spearman:[0.9761904761904763]
Epoch3,test total loss: 0.24042079597711563,  Spearman is [0.021415916842231625],
Epoch4,train total loss: 0.019686891846597578,  Spearman:0.6885351283957375
Epoch4,val total loss: 0.01489337533712387,  Spearman:[0.9761904761904763]
Epoch4,test total loss: 0.18426184672862292,  Spearman is [0.08194573217352695],
Epoch5,train total loss: 0.0172164701582052,  Spearman:0.7173828854187588
Epoch5,val total loss: 0.012875801883637905,  Spearman:[0.9761904761904763]
Epoch5,test total loss: 0.14396633999422193,  Spearman is [0.10654801234297068],
Epoch6,train total loss: 0.015490532610923625,  Spearman:0.7321249215054769
Epoch6,val total loss: 0.01232699491083622,  Spearman:[0.9761904761904763]
Epoch6,test total loss: 0.13701873309910298,  Spearman is [0.12728617406684942],
Epoch7,train total loss: 0.0147524503334306,  Spearman:0.7495417134334885
Epoch7,val total loss: 0.014502046629786491,  Spearman:[0.9285714285714287]
Epoch7,test total loss: 0.11637898059561849,  Spearman is [0.12994077824195602],
Epoch8,train total loss: 0.014110503939147562,  Spearman:0.7569121676905924
Epoch8,val total loss: 0.015760742127895355,  Spearman:[0.9285714285714287]
Epoch8,test total loss: 0.1381471742875874,  Spearman is [0.1479177373298909],
Epoch9,train total loss: 0.013367011353600388,  Spearman:0.767126739060737
Epoch9,val total loss: 0.03073956072330475,  Spearman:[0.9285714285714287]
Epoch9,test total loss: 0.08867161138914526,  Spearman is [0.15135815168869568],
Epoch10,train total loss: 0.013293269696311118,  Spearman:0.7718030775134485
Epoch10,val total loss: 0.01808551698923111,  Spearman:[0.9285714285714287]
Epoch10,test total loss: 0.11802388150244951,  Spearman is [0.15002598000458164],
Epoch11,train total loss: 0.012405723046797972,  Spearman:0.7823049223428296
Epoch11,val total loss: 0.018222162500023842,  Spearman:[0.9285714285714287]
Epoch11,test total loss: 0.11449791709892451,  Spearman is [0.15326630359423804],
Epoch12,train total loss: 0.012356220407244295,  Spearman:0.7820163414626881
Epoch12,val total loss: 0.015940554440021515,  Spearman:[0.9285714285714287]
Epoch12,test total loss: 0.12381233209744096,  Spearman is [0.16010691292958476],
Epoch13,train total loss: 0.012129936347870776,  Spearman:0.7884345243996904
Epoch13,val total loss: 0.03311671316623688,  Spearman:[0.9285714285714287]
Epoch13,test total loss: 0.06542754091788083,  Spearman is [0.15126940731923247],
Epoch14,train total loss: 0.011904407795578336,  Spearman:0.7885589002456576
Epoch14,val total loss: 0.026315614581108093,  Spearman:[0.9285714285714287]
Epoch14,test total loss: 0.07706532753072678,  Spearman is [0.1517220003154486],
Epoch15,train total loss: 0.011636481774099266,  Spearman:0.7924906289893678
Epoch15,val total loss: 0.02105460688471794,  Spearman:[0.9285714285714287]
Epoch15,test total loss: 0.1418161048553884,  Spearman is [0.15398180219599475],
Epoch16,train total loss: 0.011259590480058717,  Spearman:0.7941085607164898
Epoch16,val total loss: 0.0285843126475811,  Spearman:[0.9047619047619048]
Epoch16,test total loss: 0.15731828333809972,  Spearman is [0.1371184846594112],
Epoch17,train total loss: 0.01084294241035166,  Spearman:0.7934589889191717
Epoch17,val total loss: 0.020272672176361084,  Spearman:[0.8333333333333335]
Epoch17,test total loss: 0.1301344959065318,  Spearman is [0.141312012869571],
Epoch18,train total loss: 0.010272985019792732,  Spearman:0.7997319517897247
Epoch18,val total loss: 0.036814816296100616,  Spearman:[0.8333333333333335]
Epoch18,test total loss: 0.09832521872594953,  Spearman is [0.13549106614641312],
Epoch19,train total loss: 0.009913758613551274,  Spearman:0.7971700173751561
Epoch19,val total loss: 0.028803769499063492,  Spearman:[0.7380952380952381]
Epoch19,test total loss: 0.11671464201062917,  Spearman is [0.12462932086807803],
Epoch20,train total loss: 0.009729059784708975,  Spearman:0.7976456013126881
Epoch20,val total loss: 0.024232327938079834,  Spearman:[0.9047619047619048]
Epoch20,test total loss: 0.15128937559202313,  Spearman is [0.1297360184470708],
Epoch21,train total loss: 0.009625037332089284,  Spearman:0.7981785338819547
Epoch21,val total loss: 0.02954198606312275,  Spearman:[0.8333333333333335]
Epoch21,test total loss: 0.12823134213685988,  Spearman is [0.1203473113321585],
Epoch22,train total loss: 0.009185299390735917,  Spearman:0.8049079348287531
Epoch22,val total loss: 0.028674550354480743,  Spearman:[0.8333333333333335]
Epoch22,test total loss: 0.18692285250872373,  Spearman is [0.1339560943430048],
Epoch23,train total loss: 0.008808165320004217,  Spearman:0.8059760148297402
Epoch23,val total loss: 0.02382187731564045,  Spearman:[0.9523809523809524]
Epoch23,test total loss: 0.17877129036933184,  Spearman is [0.13036276610327166],
Epoch24,train total loss: 0.00844868187320968,  Spearman:0.8145157622530053
Epoch24,val total loss: 0.027477525174617767,  Spearman:[0.9047619047619048]
Epoch24,test total loss: 0.15023635011166334,  Spearman is [0.130425817678997],
Epoch25,train total loss: 0.008181323412244614,  Spearman:0.8188555273348889
Epoch25,val total loss: 0.023106809705495834,  Spearman:[0.9047619047619048]
Epoch25,test total loss: 0.1547522979788482,  Spearman is [0.12389600105541025],
Epoch26,train total loss: 0.007934479762274677,  Spearman:0.8259759634034154
Epoch26,val total loss: 0.02428867481648922,  Spearman:[0.9047619047619048]
Epoch26,test total loss: 0.18356050159782172,  Spearman is [0.12329300624563407],
Epoch27,train total loss: 0.007677145182895355,  Spearman:0.8279486911993292
Epoch27,val total loss: 0.0287503469735384,  Spearman:[0.9047619047619048]
Epoch27,test total loss: 0.19200451783835887,  Spearman is [0.1287747055044075],
Epoch28,train total loss: 0.007431420863259775,  Spearman:0.8285274526621333
Epoch28,val total loss: 0.024575062096118927,  Spearman:[0.9047619047619048]
Epoch28,test total loss: 0.20276702977716923,  Spearman is [0.12135697828361491],
Epoch29,train total loss: 0.007070742884071735,  Spearman:0.8380956988182815
Epoch29,val total loss: 0.02838907390832901,  Spearman:[0.8571428571428572]
Epoch29,test total loss: 0.11975318277254701,  Spearman is [0.1263012200713354],
Epoch30,train total loss: 0.005986832998669109,  Spearman:0.8435538919083063
Epoch30,val total loss: 0.023260483518242836,  Spearman:[0.9523809523809524]
Epoch30,test total loss: 0.12982301209121944,  Spearman is [0.1320792249098994],
Epoch31,train total loss: 0.005164072370508877,  Spearman:0.8465274405179569
Epoch31,val total loss: 0.03292497992515564,  Spearman:[0.9047619047619048]
Epoch31,test total loss: 0.10954427351243794,  Spearman is [0.13187943006491745],
Epoch32,train total loss: 0.00450672278738915,  Spearman:0.8551217022477693
Epoch32,val total loss: 0.011132505722343922,  Spearman:[0.9047619047619048]
Epoch32,test total loss: 0.1696528822183609,  Spearman is [0.13494010795727884],
Epoch33,train total loss: 0.004416203447945941,  Spearman:0.8508427077104377
Epoch33,val total loss: 0.026417795568704605,  Spearman:[0.9523809523809524]
Epoch33,test total loss: 0.11502905227243901,  Spearman is [0.1367846230148556],
Epoch34,train total loss: 0.003958388711161649,  Spearman:0.8586975579696148
Epoch34,val total loss: 0.019109860062599182,  Spearman:[0.9047619047619048]
Epoch34,test total loss: 0.1079586192034185,  Spearman is [0.14510042747199373],
Epoch35,train total loss: 0.004031173708380009,  Spearman:0.8546660117953699
Epoch35,val total loss: 0.013650939799845219,  Spearman:[0.9523809523809524]
Epoch35,test total loss: 0.13034714311361312,  Spearman is [0.13925423512939386],
Epoch36,train total loss: 0.003889317245174868,  Spearman:0.8591797653843505
Epoch36,val total loss: 0.018839089199900627,  Spearman:[0.9523809523809524]
Epoch36,test total loss: 0.13773357486352325,  Spearman is [0.13537933175726533],
Epoch37,train total loss: 0.003796901585211834,  Spearman:0.8588761446365638
Epoch37,val total loss: 0.018681053072214127,  Spearman:[0.9523809523809524]
Epoch37,test total loss: 0.11143907704390585,  Spearman is [0.14585032561407366],
Epoch38,train total loss: 0.0037246168716452443,  Spearman:0.8630300443551543
Epoch38,val total loss: 0.020750919356942177,  Spearman:[0.9523809523809524]
Epoch38,test total loss: 0.10044931476004422,  Spearman is [0.14234647826617347],
Epoch39,train total loss: 0.0035611043090167907,  Spearman:0.8687893417828627
Epoch39,val total loss: 0.012305273674428463,  Spearman:[0.9523809523809524]
Epoch39,test total loss: 0.13349441392347217,  Spearman is [0.13915181906344204],
Epoch40,train total loss: 0.00349633551041524,  Spearman:0.8678284580654569
Epoch40,val total loss: 0.014079760760068893,  Spearman:[0.9523809523809524]
Epoch40,test total loss: 0.15077125476673245,  Spearman is [0.14018171407569646],
Epoch41,train total loss: 0.0034972656923435773,  Spearman:0.8703103916408806
Epoch41,val total loss: 0.017540637403726578,  Spearman:[0.9523809523809524]
Epoch41,test total loss: 0.1145551973953843,  Spearman is [0.14359765879398456],
Epoch42,train total loss: 0.003388414016883008,  Spearman:0.8751445472827061
Epoch42,val total loss: 0.020799994468688965,  Spearman:[0.9523809523809524]
Epoch42,test total loss: 0.10441292407922446,  Spearman is [0.14799468418925285],
Epoch43,train total loss: 0.0033246483388864314,  Spearman:0.8778917745556485
Epoch43,val total loss: 0.034268200397491455,  Spearman:[0.9523809523809524]
Epoch43,test total loss: 0.07699087306391447,  Spearman is [0.1377077485878655],
Epoch44,train total loss: 0.003269894998550463,  Spearman:0.8797996884920163
Epoch44,val total loss: 0.013596388511359692,  Spearman:[0.9523809523809524]
Epoch44,test total loss: 0.13588427510112525,  Spearman is [0.13960082151310557],
Epoch45,train total loss: 0.003252137052372862,  Spearman:0.8766691812388508
Epoch45,val total loss: 0.013842498883605003,  Spearman:[0.9523809523809524]
Epoch45,test total loss: 0.13159331670030952,  Spearman is [0.14175734585957095],
Epoch46,train total loss: 0.0031189903611681447,  Spearman:0.8838229408320054
Epoch46,val total loss: 0.025975827127695084,  Spearman:[0.9523809523809524]
Epoch46,test total loss: 0.09565760120749474,  Spearman is [0.1369797028014526],
Epoch47,train total loss: 0.0032638322139600627,  Spearman:0.8825030663117779
Epoch47,val total loss: 0.016288135200738907,  Spearman:[0.9523809523809524]
Epoch47,test total loss: 0.18848435375839473,  Spearman is [0.1421093640957596],
Epoch48,train total loss: 0.003270916719488107,  Spearman:0.8799950693864796
Epoch48,val total loss: 0.018713001161813736,  Spearman:[0.9523809523809524]
Epoch48,test total loss: 0.10058206608518958,  Spearman is [0.14588985450661485],
Epoch49,train total loss: 0.0031494232437883816,  Spearman:0.8846792616309104
Epoch49,val total loss: 0.04108615219593048,  Spearman:[0.9523809523809524]
Epoch49,test total loss: 0.0639673733850941,  Spearman is [0.1367788623577493],
Early stop at epoch 49
ensemble idx 0, best epoch 2, best validation spearman is 0.9761904761904763,best test spearman is [-0.036921271259574354],

ensemble 1 models, fold 0, spearman is -0.036921271259574354, ndcg is 0.7399574181419415
training on fold 1 
Epoch0,train total loss: 0.1539119952238905,  Spearman:0.21012567282310327
Epoch0,val total loss: 0.0757618248462677,  Spearman:[0.8571428571428572]
Epoch0,test total loss: 0.0222513934597373,  Spearman is [-0.028989931479449754],
Epoch1,train total loss: 0.048540237156722024,  Spearman:0.5246470042245869
Epoch1,val total loss: 0.16272090375423431,  Spearman:[0.8095238095238096]
Epoch1,test total loss: 0.06230583535507321,  Spearman is [-0.033305538272396885],
Epoch2,train total loss: 0.030814258507094704,  Spearman:0.6137771461363064
Epoch2,val total loss: 0.03365739434957504,  Spearman:[0.7857142857142858]
Epoch2,test total loss: 0.2685571864247322,  Spearman is [-0.016719955430137927],
Epoch3,train total loss: 0.026503963981014796,  Spearman:0.6466236390869599
Epoch3,val total loss: 0.027919810265302658,  Spearman:[0.7619047619047621]
Epoch3,test total loss: 0.22735648974776268,  Spearman is [-0.0056871857118895265],
Epoch4,train total loss: 0.020253586281353656,  Spearman:0.6886442199045444
Epoch4,val total loss: 0.01589258760213852,  Spearman:[0.8095238095238096]
Epoch4,test total loss: 0.15768759939819574,  Spearman is [0.12031496353272245],
Epoch5,train total loss: 0.01568991130588051,  Spearman:0.7372657702292553
Epoch5,val total loss: 0.01595255546271801,  Spearman:[0.7857142857142858]
Epoch5,test total loss: 0.11382052935659885,  Spearman is [0.14639476031936152],
Epoch6,train total loss: 0.014167018112344429,  Spearman:0.7595917256695488
Epoch6,val total loss: 0.013733318075537682,  Spearman:[0.7857142857142858]
Epoch6,test total loss: 0.07145331325009466,  Spearman is [0.16300983036078112],
Epoch7,train total loss: 0.013485917321537646,  Spearman:0.7745863536506653
Epoch7,val total loss: 0.015604143962264061,  Spearman:[0.7857142857142858]
Epoch7,test total loss: 0.07798552336171269,  Spearman is [0.17376040679393093],
Epoch8,train total loss: 0.01230826087964651,  Spearman:0.7865126061922261
Epoch8,val total loss: 0.018788203597068787,  Spearman:[0.7857142857142858]
Epoch8,test total loss: 0.09156732186675072,  Spearman is [0.1721404455699266],
Epoch9,train total loss: 0.01191694881223763,  Spearman:0.7934040490006244
Epoch9,val total loss: 0.027787363156676292,  Spearman:[0.7857142857142858]
Epoch9,test total loss: 0.14176652431488038,  Spearman is [0.18594193439794593],
Epoch10,train total loss: 0.011908298761297304,  Spearman:0.7949774375027489
Epoch10,val total loss: 0.01722702383995056,  Spearman:[0.7857142857142858]
Epoch10,test total loss: 0.05817689001560211,  Spearman is [0.185662055897438],
Epoch11,train total loss: 0.011630672751030384,  Spearman:0.8022951486103415
Epoch11,val total loss: 0.018350647762417793,  Spearman:[0.7857142857142858]
Epoch11,test total loss: 0.05665783835574985,  Spearman is [0.2047678801910635],
Epoch12,train total loss: 0.01100170349654479,  Spearman:0.811027640975362
Epoch12,val total loss: 0.02205229550600052,  Spearman:[0.7857142857142858]
Epoch12,test total loss: 0.10033859414979815,  Spearman is [0.19165528309419333],
Epoch13,train total loss: 0.010898565673508132,  Spearman:0.8091284663002177
Epoch13,val total loss: 0.01775209978222847,  Spearman:[0.7857142857142858]
Epoch13,test total loss: 0.06312975743785501,  Spearman is [0.1994209053411225],
Epoch14,train total loss: 0.01054305840844814,  Spearman:0.8118586591843063
Epoch14,val total loss: 0.020525917410850525,  Spearman:[0.7857142857142858]
Epoch14,test total loss: 0.06904456298798323,  Spearman is [0.20831385398807678],
Epoch15,train total loss: 0.01034012129709411,  Spearman:0.8169786966462873
Epoch15,val total loss: 0.017576340585947037,  Spearman:[0.7857142857142858]
Epoch15,test total loss: 0.05247994177043438,  Spearman is [0.20555799771540625],
Epoch16,train total loss: 0.010399532484977195,  Spearman:0.8172363418201031
Epoch16,val total loss: 0.018903514370322227,  Spearman:[0.7857142857142858]
Epoch16,test total loss: 0.06884638061746955,  Spearman is [0.20265945338578037],
Epoch17,train total loss: 0.009840260929941462,  Spearman:0.8245795437709628
Epoch17,val total loss: 0.01831342652440071,  Spearman:[0.7857142857142858]
Epoch17,test total loss: 0.07113316720351577,  Spearman is [0.20775393916083887],
Epoch18,train total loss: 0.009906785304431254,  Spearman:0.8225156628486142
Epoch18,val total loss: 0.019824450835585594,  Spearman:[0.7857142857142858]
Epoch18,test total loss: 0.08930756589397788,  Spearman is [0.1897455989590782],
Epoch19,train total loss: 0.00982458333675869,  Spearman:0.8245783057034037
Epoch19,val total loss: 0.01705387979745865,  Spearman:[0.7857142857142858]
Epoch19,test total loss: 0.06755884913727642,  Spearman is [0.19247561776397396],
Epoch20,train total loss: 0.009483918335694725,  Spearman:0.8274018715310222
Epoch20,val total loss: 0.016838040202856064,  Spearman:[0.7857142857142858]
Epoch20,test total loss: 0.06195775084197521,  Spearman is [0.19761989771210212],
Epoch21,train total loss: 0.009317762003495144,  Spearman:0.82881443275628
Epoch21,val total loss: 0.01792924292385578,  Spearman:[0.7857142857142858]
Epoch21,test total loss: 0.05377405174076557,  Spearman is [0.1946376594521199],
Epoch22,train total loss: 0.009395519737154245,  Spearman:0.8266154648287065
Epoch22,val total loss: 0.01366422325372696,  Spearman:[0.7857142857142858]
Epoch22,test total loss: 0.0752053196541965,  Spearman is [0.18749640431587508],
Epoch23,train total loss: 0.009300724812186299,  Spearman:0.8266020976783867
Epoch23,val total loss: 0.020412342622876167,  Spearman:[0.7857142857142858]
Epoch23,test total loss: 0.08617317248135806,  Spearman is [0.19632107339349733],
Epoch24,train total loss: 0.009072926282011068,  Spearman:0.83198181791076
Epoch24,val total loss: 0.014790058135986328,  Spearman:[0.7857142857142858]
Epoch24,test total loss: 0.08147358661517501,  Spearman is [0.1941379553286096],
Epoch25,train total loss: 0.00864034083012181,  Spearman:0.8367981939145688
Epoch25,val total loss: 0.018527591601014137,  Spearman:[0.7857142857142858]
Epoch25,test total loss: 0.07081491285935045,  Spearman is [0.1979392985290586],
Epoch26,train total loss: 0.00829426012858629,  Spearman:0.8396905046924904
Epoch26,val total loss: 0.023390036076307297,  Spearman:[0.7857142857142858]
Epoch26,test total loss: 0.09349004700779914,  Spearman is [0.19510778431117326],
Epoch27,train total loss: 0.007555896049150481,  Spearman:0.8497876952435061
Epoch27,val total loss: 0.01604381576180458,  Spearman:[0.7857142857142858]
Epoch27,test total loss: 0.08088888991624117,  Spearman is [0.19403702545958249],
Epoch28,train total loss: 0.007273810055966561,  Spearman:0.8521326786779133
Epoch28,val total loss: 0.011866744607686996,  Spearman:[0.8095238095238096]
Epoch28,test total loss: 0.09624423459172249,  Spearman is [0.19640248541972588],
Epoch29,train total loss: 0.006479676784529613,  Spearman:0.858272522133103
Epoch29,val total loss: 0.010856276378035545,  Spearman:[0.8571428571428572]
Epoch29,test total loss: 0.10452457815408707,  Spearman is [0.19010334497191023],
Epoch30,train total loss: 0.005613815383418487,  Spearman:0.8597373707424156
Epoch30,val total loss: 0.013153990730643272,  Spearman:[0.7857142857142858]
Epoch30,test total loss: 0.08251162227243185,  Spearman is [0.1946672255643916],
Epoch31,train total loss: 0.0048005193806229494,  Spearman:0.8640944017587047
Epoch31,val total loss: 0.014560416340827942,  Spearman:[0.8571428571428572]
Epoch31,test total loss: 0.1373060293495655,  Spearman is [0.19130093692122882],
Epoch32,train total loss: 0.0045804425377028585,  Spearman:0.8657310097975464
Epoch32,val total loss: 0.011385476216673851,  Spearman:[0.8571428571428572]
Epoch32,test total loss: 0.1132706256583333,  Spearman is [0.18795430421880904],
Epoch33,train total loss: 0.0045187311666384814,  Spearman:0.8625902286245071
Epoch33,val total loss: 0.009664719924330711,  Spearman:[0.8571428571428572]
Epoch33,test total loss: 0.10241825431585312,  Spearman is [0.18735665577230617],
Epoch34,train total loss: 0.004183978437840079,  Spearman:0.872788827054129
Epoch34,val total loss: 0.011198600754141808,  Spearman:[0.8571428571428572]
Epoch34,test total loss: 0.11205826215445995,  Spearman is [0.19254043830860518],
Epoch35,train total loss: 0.004248544617812746,  Spearman:0.8688231527371791
Epoch35,val total loss: 0.012999620288610458,  Spearman:[0.8571428571428572]
Epoch35,test total loss: 0.13584229880943893,  Spearman is [0.18211806808038603],
Epoch36,train total loss: 0.004233499648622596,  Spearman:0.8670462411403268
Epoch36,val total loss: 0.01966666802763939,  Spearman:[0.8571428571428572]
Epoch36,test total loss: 0.12668728241696953,  Spearman is [0.19084920539314168],
Epoch37,train total loss: 0.003944553579994812,  Spearman:0.8736025648981124
Epoch37,val total loss: 0.015985403209924698,  Spearman:[0.8571428571428572]
Epoch37,test total loss: 0.13571461299434304,  Spearman is [0.18243347063304963],
Epoch38,train total loss: 0.003879048604852496,  Spearman:0.8750490701877288
Epoch38,val total loss: 0.01156292762607336,  Spearman:[0.8571428571428572]
Epoch38,test total loss: 0.08768545165657997,  Spearman is [0.18862892582904414],
Epoch39,train total loss: 0.0037789110236842996,  Spearman:0.8767111516236467
Epoch39,val total loss: 0.01656855270266533,  Spearman:[0.8571428571428572]
Epoch39,test total loss: 0.08401671322062612,  Spearman is [0.19395198343024578],
Epoch40,train total loss: 0.0036367695780100827,  Spearman:0.8839891485644865
Epoch40,val total loss: 0.017364880070090294,  Spearman:[0.9047619047619048]
Epoch40,test total loss: 0.15110635235905648,  Spearman is [0.18184183931126396],
Epoch41,train total loss: 0.003508644220672954,  Spearman:0.88454838163066
Epoch41,val total loss: 0.018971778452396393,  Spearman:[0.8571428571428572]
Epoch41,test total loss: 0.15783002115786077,  Spearman is [0.18866339770638582],
Epoch42,train total loss: 0.0036352413463203283,  Spearman:0.881222328925209
Epoch42,val total loss: 0.014692377299070358,  Spearman:[0.8571428571428572]
Epoch42,test total loss: 0.12409892100840807,  Spearman is [0.18869005060964142],
Epoch43,train total loss: 0.0035012763318940042,  Spearman:0.8854623607959893
Epoch43,val total loss: 0.01500813476741314,  Spearman:[0.9047619047619048]
Epoch43,test total loss: 0.11936325076967477,  Spearman is [0.1944233182903352],
Epoch44,train total loss: 0.0032800497302116873,  Spearman:0.8914364921283263
Epoch44,val total loss: 0.014197849668562412,  Spearman:[0.8571428571428572]
Epoch44,test total loss: 0.10994960302487015,  Spearman is [0.19015603262571826],
Epoch45,train total loss: 0.0034582950514353192,  Spearman:0.8872406644615587
Epoch45,val total loss: 0.014768132008612156,  Spearman:[0.9047619047619048]
Epoch45,test total loss: 0.13659910568967462,  Spearman is [0.19202465924245873],
Epoch46,train total loss: 0.0034582137192886034,  Spearman:0.8881420068694584
Epoch46,val total loss: 0.014374447986483574,  Spearman:[0.9047619047619048]
Epoch46,test total loss: 0.09982682541012763,  Spearman is [0.19928629930195665],
Epoch47,train total loss: 0.0032112995887963246,  Spearman:0.8949038331607385
Epoch47,val total loss: 0.01552725862711668,  Spearman:[0.9047619047619048]
Epoch47,test total loss: 0.11066320911049843,  Spearman is [0.1897775587690516],
Epoch48,train total loss: 0.0032725202789804777,  Spearman:0.8951799786709882
Epoch48,val total loss: 0.014905569143593311,  Spearman:[0.8571428571428572]
Epoch48,test total loss: 0.10369325708597898,  Spearman is [0.19386371911554148],
Epoch49,train total loss: 0.0032461157978291456,  Spearman:0.8986245882280979
Epoch49,val total loss: 0.020953534170985222,  Spearman:[0.8571428571428572]
Epoch49,test total loss: 0.13249217094853522,  Spearman is [0.19434533240834456],
Early stop at epoch 49
ensemble idx 0, best epoch 40, best validation spearman is 0.9047619047619048,best test spearman is [0.18183957713541402],

ensemble 1 models, fold 1, spearman is 0.18183957713541402, ndcg is 0.7789929161219121
training on fold 2 
Epoch0,train total loss: 0.12794867240322325,  Spearman:0.05202928555585321
Epoch0,val total loss: 0.1306631863117218,  Spearman:[0.7784570702436182]
Epoch0,test total loss: 0.0102601665770635,  Spearman is [0.05945079348464816],
Epoch1,train total loss: 0.043148945145404495,  Spearman:0.5385460290976382
Epoch1,val total loss: 0.05559288710355759,  Spearman:[0.6586944440522925]
Epoch1,test total loss: 0.06799289900809527,  Spearman is [-0.04163205518435942],
Epoch2,train total loss: 0.028612308980276186,  Spearman:0.6565216880476022
Epoch2,val total loss: 0.052998125553131104,  Spearman:[0.6347419188140272]
Epoch2,test total loss: 0.18586415685713292,  Spearman is [-0.04777514495508267],
Epoch3,train total loss: 0.025588249510082487,  Spearman:0.6766904223422407
Epoch3,val total loss: 0.03707835078239441,  Spearman:[0.5389318178609664]
Epoch3,test total loss: 0.2764657258987427,  Spearman is [-0.021262042851785547],
Epoch4,train total loss: 0.019221063646583412,  Spearman:0.7135947498137054
Epoch4,val total loss: 0.02894819900393486,  Spearman:[0.5389318178609664]
Epoch4,test total loss: 0.18933665473014116,  Spearman is [0.08874720047107446],
Epoch5,train total loss: 0.016184518089852273,  Spearman:0.7477360540561835
Epoch5,val total loss: 0.02457512728869915,  Spearman:[0.6586944440522925]
Epoch5,test total loss: 0.11266774758696556,  Spearman is [0.11602614116488266],
Epoch6,train total loss: 0.014565498723338047,  Spearman:0.7726754831490149
Epoch6,val total loss: 0.02093520760536194,  Spearman:[0.6347419188140272]
Epoch6,test total loss: 0.13201125944033265,  Spearman is [0.14151702913206712],
Epoch7,train total loss: 0.013872090279339598,  Spearman:0.7846354862596128
Epoch7,val total loss: 0.02168697491288185,  Spearman:[0.6826469692905576]
Epoch7,test total loss: 0.07555288998410106,  Spearman is [0.1521967415914981],
Epoch8,train total loss: 0.013659763379762761,  Spearman:0.7918271506649
Epoch8,val total loss: 0.016255974769592285,  Spearman:[0.5389318178609664]
Epoch8,test total loss: 0.09079627045430243,  Spearman is [0.16197322115799526],
Epoch9,train total loss: 0.012866102160515789,  Spearman:0.8017411925614563
Epoch9,val total loss: 0.015961993485689163,  Spearman:[0.6826469692905576]
Epoch9,test total loss: 0.09383108504116536,  Spearman is [0.14536105117340656],
Epoch10,train total loss: 0.012651112402240053,  Spearman:0.8034760182397627
Epoch10,val total loss: 0.02000834420323372,  Spearman:[0.6826469692905576]
Epoch10,test total loss: 0.11540471818298101,  Spearman is [0.1575577958556682],
Epoch11,train total loss: 0.01220538418363923,  Spearman:0.8111944517721617
Epoch11,val total loss: 0.019676122814416885,  Spearman:[0.7545045450053531]
Epoch11,test total loss: 0.07035754544194787,  Spearman is [0.1540848692951127],
Epoch12,train total loss: 0.011627255521046046,  Spearman:0.8198648727382921
Epoch12,val total loss: 0.01488647609949112,  Spearman:[0.4910267673844361]
Epoch12,test total loss: 0.06293533518910407,  Spearman is [0.1437325278768538],
Epoch13,train total loss: 0.011297109918907667,  Spearman:0.8238724458581257
Epoch13,val total loss: 0.013437760062515736,  Spearman:[0.7065994945288228]
Epoch13,test total loss: 0.08529991491232067,  Spearman is [0.1342438575785247],
Epoch14,train total loss: 0.011104563092932297,  Spearman:0.825960846751759
Epoch14,val total loss: 0.016455188393592834,  Spearman:[0.7065994945288228]
Epoch14,test total loss: 0.0708506298949942,  Spearman is [0.14395416545002787],
Epoch15,train total loss: 0.010808087886872295,  Spearman:0.8260798803700489
Epoch15,val total loss: 0.01384814828634262,  Spearman:[0.7065994945288228]
Epoch15,test total loss: 0.10813286914490164,  Spearman is [0.15032554075020282],
Epoch16,train total loss: 0.010538650336317144,  Spearman:0.8263440891043444
Epoch16,val total loss: 0.014174514450132847,  Spearman:[0.5868368683374969]
Epoch16,test total loss: 0.0839586563874036,  Spearman is [0.14072886470722276],
Epoch17,train total loss: 0.010433486883695692,  Spearman:0.8295885370938942
Epoch17,val total loss: 0.015117344446480274,  Spearman:[0.5149792926227014]
Epoch17,test total loss: 0.0685274466406554,  Spearman is [0.15697653503189246],
Epoch18,train total loss: 0.010284656994582083,  Spearman:0.8264767038258709
Epoch18,val total loss: 0.01789899542927742,  Spearman:[0.5868368683374969]
Epoch18,test total loss: 0.07410305563826114,  Spearman is [0.14764736128317135],
Epoch19,train total loss: 0.010042765991201099,  Spearman:0.8293589599053527
Epoch19,val total loss: 0.014972979202866554,  Spearman:[0.5149792926227014]
Epoch19,test total loss: 0.07997493986040353,  Spearman is [0.1478835284962527],
Epoch20,train total loss: 0.00950246375466052,  Spearman:0.8341486574806728
Epoch20,val total loss: 0.018467361107468605,  Spearman:[0.7108433734939759]
Epoch20,test total loss: 0.07875012382864952,  Spearman is [0.15817642203752397],
Epoch21,train total loss: 0.009686518721700383,  Spearman:0.8329584630229917
Epoch21,val total loss: 0.018607258796691895,  Spearman:[0.5149792926227014]
Epoch21,test total loss: 0.09684487245976925,  Spearman is [0.1528106132584134],
Epoch22,train total loss: 0.00966873982300361,  Spearman:0.8330537943797464
Epoch22,val total loss: 0.01647518202662468,  Spearman:[0.6347419188140272]
Epoch22,test total loss: 0.06820470411330462,  Spearman is [0.15499560550968844],
Epoch23,train total loss: 0.009255820428594373,  Spearman:0.8382056937722154
Epoch23,val total loss: 0.018732961267232895,  Spearman:[0.7545045450053531]
Epoch23,test total loss: 0.04830401032231748,  Spearman is [0.17379187339696028],
Epoch24,train total loss: 0.009382380042762425,  Spearman:0.8379686810614044
Epoch24,val total loss: 0.02451181784272194,  Spearman:[0.7065994945288228]
Epoch24,test total loss: 0.05470966305583715,  Spearman is [0.16208934180089865],
Epoch25,train total loss: 0.009102484976980262,  Spearman:0.8405256137677809
Epoch25,val total loss: 0.015426505357027054,  Spearman:[0.7065994945288228]
Epoch25,test total loss: 0.08000314035452902,  Spearman is [0.16420634383091542],
Epoch26,train total loss: 0.00900011533835473,  Spearman:0.8452847809435233
Epoch26,val total loss: 0.021487560123205185,  Spearman:[0.7065994945288228]
Epoch26,test total loss: 0.12131558516994119,  Spearman is [0.16225542759527903],
Epoch27,train total loss: 0.00930359290065005,  Spearman:0.8356260678838429
Epoch27,val total loss: 0.017986828461289406,  Spearman:[0.7784570702436182]
Epoch27,test total loss: 0.04294151314534247,  Spearman is [0.17815266452207354],
Epoch28,train total loss: 0.008850349947654953,  Spearman:0.8460535711263613
Epoch28,val total loss: 0.014756114222109318,  Spearman:[0.7065994945288228]
Epoch28,test total loss: 0.10712118376977742,  Spearman is [0.16537104874120584],
Epoch29,train total loss: 0.00875060291041453,  Spearman:0.8439205278070833
Epoch29,val total loss: 0.011969169601798058,  Spearman:[0.7545045450053531]
Epoch29,test total loss: 0.06355312583036721,  Spearman is [0.15637020311220454],
Epoch30,train total loss: 0.008657193480011744,  Spearman:0.8488730823173983
Epoch30,val total loss: 0.01605982892215252,  Spearman:[0.7784570702436182]
Epoch30,test total loss: 0.05350876585580409,  Spearman is [0.16443788805090803],
Epoch31,train total loss: 0.00825895506885643,  Spearman:0.8532207503469728
Epoch31,val total loss: 0.014358188956975937,  Spearman:[0.7784570702436182]
Epoch31,test total loss: 0.07795981904491782,  Spearman is [0.16838475360421745],
Epoch32,train total loss: 0.008061912322703462,  Spearman:0.8536939663519454
Epoch32,val total loss: 0.011442424729466438,  Spearman:[0.7784570702436182]
Epoch32,test total loss: 0.06707567344419658,  Spearman is [0.16178110718915506],
Epoch33,train total loss: 0.007524037159059961,  Spearman:0.8584036339537052
Epoch33,val total loss: 0.016790973022580147,  Spearman:[0.8024095954818835]
Epoch33,test total loss: 0.07322148177772761,  Spearman is [0.1529300548280733],
Epoch34,train total loss: 0.007295009933071784,  Spearman:0.8629269291007066
Epoch34,val total loss: 0.010498142801225185,  Spearman:[0.8503146459584139]
Epoch34,test total loss: 0.05648470153100789,  Spearman is [0.15081942503177345],
Epoch35,train total loss: 0.007031062216414377,  Spearman:0.864277882424834
Epoch35,val total loss: 0.00828351266682148,  Spearman:[0.8024095954818835]
Epoch35,test total loss: 0.06146364193409681,  Spearman is [0.1576644732296165],
Epoch36,train total loss: 0.006791811131943877,  Spearman:0.866157267001953
Epoch36,val total loss: 0.02128826640546322,  Spearman:[0.8263621207201486]
Epoch36,test total loss: 0.10563164171762765,  Spearman is [0.1581310141182099],
Epoch37,train total loss: 0.006727391653933013,  Spearman:0.8678764160937377
Epoch37,val total loss: 0.010725809261202812,  Spearman:[0.8024095954818835]
Epoch37,test total loss: 0.07674328270368277,  Spearman is [0.14449687369434766],
Epoch38,train total loss: 0.006724019204296219,  Spearman:0.8639037652907345
Epoch38,val total loss: 0.009711059741675854,  Spearman:[0.7065994945288228]
Epoch38,test total loss: 0.07053980540949852,  Spearman is [0.14456586348167913],
Epoch39,train total loss: 0.006256341118550597,  Spearman:0.8702830315823865
Epoch39,val total loss: 0.015342410653829575,  Spearman:[0.8503146459584139]
Epoch39,test total loss: 0.12231573788449168,  Spearman is [0.14779701342217652],
Epoch40,train total loss: 0.005807483271779254,  Spearman:0.869417318562759
Epoch40,val total loss: 0.017487943172454834,  Spearman:[0.7065994945288228]
Epoch40,test total loss: 0.13165919240564108,  Spearman is [0.14648568795156364],
Epoch41,train total loss: 0.005467628324344658,  Spearman:0.8697830214639968
Epoch41,val total loss: 0.008625159040093422,  Spearman:[0.730552019767088]
Epoch41,test total loss: 0.10125546306371688,  Spearman is [0.1459912381260305],
Epoch42,train total loss: 0.005229214090668859,  Spearman:0.8704373581942764
Epoch42,val total loss: 0.008764289319515228,  Spearman:[0.730552019767088]
Epoch42,test total loss: 0.09750338369049132,  Spearman is [0.1438626490208752],
Epoch43,train total loss: 0.004923251183637871,  Spearman:0.8739778250265923
Epoch43,val total loss: 0.004550505429506302,  Spearman:[0.8024095954818835]
Epoch43,test total loss: 0.06205055513419211,  Spearman is [0.15003638338305447],
Epoch44,train total loss: 0.004667878614362473,  Spearman:0.8739734782331249
Epoch44,val total loss: 0.004357910715043545,  Spearman:[0.730552019767088]
Epoch44,test total loss: 0.06054440145380795,  Spearman is [0.14541043105264326],
Epoch45,train total loss: 0.0043113381334711825,  Spearman:0.8804829895801339
Epoch45,val total loss: 0.0043483758345246315,  Spearman:[0.730552019767088]
Epoch45,test total loss: 0.05912824906408787,  Spearman is [0.14731494637898493],
Epoch46,train total loss: 0.004105845242753649,  Spearman:0.881868104479899
Epoch46,val total loss: 0.00534404069185257,  Spearman:[0.730552019767088]
Epoch46,test total loss: 0.05067805321887135,  Spearman is [0.14742099244804485],
Epoch47,train total loss: 0.003840920100442301,  Spearman:0.88511727575684
Epoch47,val total loss: 0.004803903866559267,  Spearman:[0.730552019767088]
Epoch47,test total loss: 0.048246401455253364,  Spearman is [0.14771504242807804],
Epoch48,train total loss: 0.003480598367810345,  Spearman:0.8888593248947079
Epoch48,val total loss: 0.006246192846447229,  Spearman:[0.730552019767088]
Epoch48,test total loss: 0.05472185858525336,  Spearman is [0.1582361461104002],
Epoch49,train total loss: 0.0035771420124757034,  Spearman:0.8909292414440267
Epoch49,val total loss: 0.010644967667758465,  Spearman:[0.8072289156626505]
Epoch49,test total loss: 0.03811536142602563,  Spearman is [0.14906619271539853],
Early stop at epoch 49
ensemble idx 0, best epoch 34, best validation spearman is 0.8503146459584139,best test spearman is [0.15082371922023285],

ensemble 1 models, fold 2, spearman is 0.15082371922023285, ndcg is 0.77758426934242
training on fold 3 
Epoch0,train total loss: 0.08681504295852321,  Spearman:0.17014682387100066
Epoch0,val total loss: 0.06462599337100983,  Spearman:[0.5476190476190477]
Epoch0,test total loss: 0.03000777494162321,  Spearman is [-0.014617729880164423],
Epoch1,train total loss: 0.03667171674971588,  Spearman:0.5777192999018052
Epoch1,val total loss: 0.05222705006599426,  Spearman:[0.6904761904761906]
Epoch1,test total loss: 0.10767890233546495,  Spearman is [-0.03232288590928837],
Epoch2,train total loss: 0.029114219431693737,  Spearman:0.6317086134751572
Epoch2,val total loss: 0.029942765831947327,  Spearman:[0.7619047619047621]
Epoch2,test total loss: 0.4373201854526997,  Spearman is [-0.013375742729790157],
Epoch3,train total loss: 0.025787168277952917,  Spearman:0.6525310283836725
Epoch3,val total loss: 0.02829643338918686,  Spearman:[0.8333333333333335]
Epoch3,test total loss: 0.38359273970127106,  Spearman is [-0.011161973497353884],
Epoch4,train total loss: 0.021254781833611045,  Spearman:0.6740989501054994
Epoch4,val total loss: 0.020008543506264687,  Spearman:[0.7857142857142858]
Epoch4,test total loss: 0.360029973089695,  Spearman is [0.017234560979450596],
Epoch5,train total loss: 0.016039558802731335,  Spearman:0.7153280076142549
Epoch5,val total loss: 0.02296234294772148,  Spearman:[0.7142857142857144]
Epoch5,test total loss: 0.16070075072348117,  Spearman is [0.08228327629521068],
Epoch6,train total loss: 0.014015271871661147,  Spearman:0.7448964519792614
Epoch6,val total loss: 0.021428732201457024,  Spearman:[0.7142857142857144]
Epoch6,test total loss: 0.13371787648648023,  Spearman is [0.12025501587269823],
Epoch7,train total loss: 0.012951622566339584,  Spearman:0.7585106072069573
Epoch7,val total loss: 0.019358765333890915,  Spearman:[0.7142857142857144]
Epoch7,test total loss: 0.09043470146134495,  Spearman is [0.16687549432282475],
Epoch8,train total loss: 0.01222690720952904,  Spearman:0.7734635349036165
Epoch8,val total loss: 0.02872319146990776,  Spearman:[0.7142857142857144]
Epoch8,test total loss: 0.09757230337709188,  Spearman is [0.15340939279284124],
Epoch9,train total loss: 0.011338637456691895,  Spearman:0.7795841480616849
Epoch9,val total loss: 0.024014249444007874,  Spearman:[0.7142857142857144]
Epoch9,test total loss: 0.14209434445947408,  Spearman is [0.1562567948504171],
Epoch10,train total loss: 0.010950398861239545,  Spearman:0.7840254157920633
Epoch10,val total loss: 0.02419663779437542,  Spearman:[0.7142857142857144]
Epoch10,test total loss: 0.10479201544076204,  Spearman is [0.14550204259847446],
Epoch11,train total loss: 0.010498708897592643,  Spearman:0.7922034884288436
Epoch11,val total loss: 0.023135289549827576,  Spearman:[0.7142857142857144]
Epoch11,test total loss: 0.10996875148266554,  Spearman is [0.15182807926497147],
Epoch12,train total loss: 0.010063420933408614,  Spearman:0.7985357991899255
Epoch12,val total loss: 0.02292989380657673,  Spearman:[0.7380952380952381]
Epoch12,test total loss: 0.1218567593023181,  Spearman is [0.1699502910859707],
Epoch13,train total loss: 0.009694319157204472,  Spearman:0.7985326572865248
Epoch13,val total loss: 0.02402537688612938,  Spearman:[0.6666666666666669]
Epoch13,test total loss: 0.11750724148005247,  Spearman is [0.16463553251361399],
Epoch14,train total loss: 0.009157143024285922,  Spearman:0.8069765483122789
Epoch14,val total loss: 0.02250540629029274,  Spearman:[0.880952380952381]
Epoch14,test total loss: 0.1643210355192423,  Spearman is [0.17862547242690247],
Epoch15,train total loss: 0.008918335826960035,  Spearman:0.8101650684610241
Epoch15,val total loss: 0.0270083025097847,  Spearman:[0.8095238095238096]
Epoch15,test total loss: 0.14390645250678064,  Spearman is [0.1703992080464306],
Epoch16,train total loss: 0.00873153011362331,  Spearman:0.8118722343976665
Epoch16,val total loss: 0.024026229977607727,  Spearman:[0.8095238095238096]
Epoch16,test total loss: 0.1681522311642766,  Spearman is [0.17605057049395179],
Epoch17,train total loss: 0.008128239926195536,  Spearman:0.8207634203808771
Epoch17,val total loss: 0.028517011553049088,  Spearman:[0.7380952380952381]
Epoch17,test total loss: 0.12049288209527731,  Spearman is [0.165829836416639],
Epoch18,train total loss: 0.008403660971313141,  Spearman:0.8183748140852987
Epoch18,val total loss: 0.022257443517446518,  Spearman:[0.880952380952381]
Epoch18,test total loss: 0.16467539370059966,  Spearman is [0.1769359492955116],
Epoch19,train total loss: 0.007980137691797258,  Spearman:0.8236404573744838
Epoch19,val total loss: 0.024586107581853867,  Spearman:[0.8333333333333335]
Epoch19,test total loss: 0.16400138549506665,  Spearman is [0.18938946408893],
Epoch20,train total loss: 0.007687450962690398,  Spearman:0.8298024615178335
Epoch20,val total loss: 0.025418758392333984,  Spearman:[0.8571428571428572]
Epoch20,test total loss: 0.14252086021006108,  Spearman is [0.1745505440465514],
Epoch21,train total loss: 0.0076500198054605,  Spearman:0.8299535664884805
Epoch21,val total loss: 0.02494802325963974,  Spearman:[0.8333333333333335]
Epoch21,test total loss: 0.14840608052909374,  Spearman is [0.1785287775615014],
Epoch22,train total loss: 0.007430751849031554,  Spearman:0.8332940344300569
Epoch22,val total loss: 0.026631927117705345,  Spearman:[0.8333333333333335]
Epoch22,test total loss: 0.15224725250154733,  Spearman is [0.17169691442929558],
Epoch23,train total loss: 0.00755694970407953,  Spearman:0.8337657570586918
Epoch23,val total loss: 0.033266499638557434,  Spearman:[0.8333333333333335]
Epoch23,test total loss: 0.1517086263746023,  Spearman is [0.18356168181930746],
Epoch24,train total loss: 0.007033045729771495,  Spearman:0.8435984917816592
Epoch24,val total loss: 0.020716257393360138,  Spearman:[0.880952380952381]
Epoch24,test total loss: 0.19212011564522982,  Spearman is [0.1684666785656678],
Epoch25,train total loss: 0.007141776739631613,  Spearman:0.8400888484501593
Epoch25,val total loss: 0.03027680702507496,  Spearman:[0.9047619047619048]
Epoch25,test total loss: 0.12576477695256472,  Spearman is [0.17223709440267956],
Epoch26,train total loss: 0.0067831007390617365,  Spearman:0.8531800092355474
Epoch26,val total loss: 0.023190084844827652,  Spearman:[0.880952380952381]
Epoch26,test total loss: 0.15859342124313117,  Spearman is [0.1866582747395538],
Epoch27,train total loss: 0.007016209572798406,  Spearman:0.8487310621824746
Epoch27,val total loss: 0.024042297154664993,  Spearman:[0.880952380952381]
Epoch27,test total loss: 0.1398698754608631,  Spearman is [0.17384072718879004],
Epoch28,train total loss: 0.006778514107468371,  Spearman:0.8529664665960868
Epoch28,val total loss: 0.025674158707261086,  Spearman:[0.9047619047619048]
Epoch28,test total loss: 0.1662358844652772,  Spearman is [0.16915983160481343],
Epoch29,train total loss: 0.006445431107213386,  Spearman:0.858288844226193
Epoch29,val total loss: 0.0268293134868145,  Spearman:[0.880952380952381]
Epoch29,test total loss: 0.17966928528621792,  Spearman is [0.15660747813981057],
Epoch30,train total loss: 0.006347645971870337,  Spearman:0.8624495701049253
Epoch30,val total loss: 0.02819356694817543,  Spearman:[0.9047619047619048]
Epoch30,test total loss: 0.1781540303491056,  Spearman is [0.16116722894614718],
Epoch31,train total loss: 0.006174730174303151,  Spearman:0.8642876845350804
Epoch31,val total loss: 0.025479160249233246,  Spearman:[0.880952380952381]
Epoch31,test total loss: 0.16826035669073464,  Spearman is [0.1530276966508069],
Epoch32,train total loss: 0.006044120055053216,  Spearman:0.8652905580214527
Epoch32,val total loss: 0.025242414325475693,  Spearman:[0.8095238095238096]
Epoch32,test total loss: 0.1739328198134899,  Spearman is [0.14931246738278628],
Epoch33,train total loss: 0.005902374383787481,  Spearman:0.864810381092808
Epoch33,val total loss: 0.0227244570851326,  Spearman:[0.880952380952381]
Epoch33,test total loss: 0.16219181418418885,  Spearman is [0.15130688447088647],
Epoch34,train total loss: 0.004999762295763223,  Spearman:0.866982398263329
Epoch34,val total loss: 0.026158500462770462,  Spearman:[0.880952380952381]
Epoch34,test total loss: 0.13250908618792892,  Spearman is [0.1483717178816429],
Epoch35,train total loss: 0.0038933157585023972,  Spearman:0.8731240367861905
Epoch35,val total loss: 0.022166475653648376,  Spearman:[0.9047619047619048]
Epoch35,test total loss: 0.14302972024306654,  Spearman is [0.145890696246466],
Epoch36,train total loss: 0.003223396279887917,  Spearman:0.887275652740063
Epoch36,val total loss: 0.027946578338742256,  Spearman:[0.9047619047619048]
Epoch36,test total loss: 0.13077232497744262,  Spearman is [0.14289986303347244],
Epoch37,train total loss: 0.003089047259075018,  Spearman:0.8884515782175113
Epoch37,val total loss: 0.025848589837551117,  Spearman:[0.9047619047619048]
Epoch37,test total loss: 0.11680288626812399,  Spearman is [0.1427063812373741],
Epoch38,train total loss: 0.0030215908870256194,  Spearman:0.8915807939844166
Epoch38,val total loss: 0.020867617800831795,  Spearman:[0.8333333333333335]
Epoch38,test total loss: 0.11281290985643863,  Spearman is [0.1400469239059382],
Epoch39,train total loss: 0.0029387527478646892,  Spearman:0.8935487497992427
Epoch39,val total loss: 0.021621594205498695,  Spearman:[0.8333333333333335]
Epoch39,test total loss: 0.11259252689778805,  Spearman is [0.13707381983855949],
Epoch40,train total loss: 0.002912800571581241,  Spearman:0.896739433119646
Epoch40,val total loss: 0.015725871548056602,  Spearman:[0.9047619047619048]
Epoch40,test total loss: 0.10707625620998443,  Spearman is [0.14176626304111908],
Epoch41,train total loss: 0.002619959857279005,  Spearman:0.9086550776707282
Epoch41,val total loss: 0.017507478594779968,  Spearman:[0.8333333333333335]
Epoch41,test total loss: 0.12354607516899704,  Spearman is [0.13749928645285373],
Epoch42,train total loss: 0.0027601029147402956,  Spearman:0.9007451640731268
Epoch42,val total loss: 0.01750831864774227,  Spearman:[0.8333333333333335]
Epoch42,test total loss: 0.10110406293533743,  Spearman is [0.13580272032630203],
Epoch43,train total loss: 0.002808733818640646,  Spearman:0.9010699379118691
Epoch43,val total loss: 0.021548349410295486,  Spearman:[0.9047619047619048]
Epoch43,test total loss: 0.1089222913607955,  Spearman is [0.1349143954352632],
Epoch44,train total loss: 0.0026736622961694733,  Spearman:0.9052582191510573
Epoch44,val total loss: 0.015599283389747143,  Spearman:[0.9047619047619048]
Epoch44,test total loss: 0.10400739782489836,  Spearman is [0.1455538262788456],
Epoch45,train total loss: 0.0026043347696451326,  Spearman:0.908985116730107
Epoch45,val total loss: 0.021767843514680862,  Spearman:[0.9047619047619048]
Epoch45,test total loss: 0.09146922822110355,  Spearman is [0.13943469626216967],
Epoch46,train total loss: 0.002600276083775008,  Spearman:0.9102153001988357
Epoch46,val total loss: 0.024823736399412155,  Spearman:[0.9047619047619048]
Epoch46,test total loss: 0.09370619712863118,  Spearman is [0.140472285302751],
Epoch47,train total loss: 0.002522060947600179,  Spearman:0.9131196144851039
Epoch47,val total loss: 0.014915761537849903,  Spearman:[0.9047619047619048]
Epoch47,test total loss: 0.1025701587786898,  Spearman is [0.14395475377365044],
Epoch48,train total loss: 0.002543842238269579,  Spearman:0.9122215998640557
Epoch48,val total loss: 0.01581466943025589,  Spearman:[0.9047619047619048]
Epoch48,test total loss: 0.09336201606784016,  Spearman is [0.14436224792690408],
Epoch49,train total loss: 0.0025021099419786762,  Spearman:0.9154033433928508
Epoch49,val total loss: 0.025085559114813805,  Spearman:[0.9047619047619048]
Epoch49,test total loss: 0.08095250492915511,  Spearman is [0.14666172337402833],
Early stop at epoch 49
ensemble idx 0, best epoch 25, best validation spearman is 0.9047619047619048,best test spearman is [0.17223305668183106],

ensemble 1 models, fold 3, spearman is 0.17223305668183106, ndcg is 0.7198419034596347
training on fold 4 
Epoch0,train total loss: 0.09961576041025229,  Spearman:0.07676174656111398
Epoch0,val total loss: 0.12158641219139099,  Spearman:[0.261904761904762]
Epoch0,test total loss: 0.08685660399496556,  Spearman is [-0.03557017358099455],
Epoch1,train total loss: 0.04945875350863506,  Spearman:0.5359809226751522
Epoch1,val total loss: 0.07986213266849518,  Spearman:[0.523809523809524]
Epoch1,test total loss: 0.04990733033046126,  Spearman is [0.01170119993731274],
Epoch2,train total loss: 0.034799916992107265,  Spearman:0.6357738161664099
Epoch2,val total loss: 0.022399485111236572,  Spearman:[0.9047619047619048]
Epoch2,test total loss: 0.38082745000720025,  Spearman is [-0.017240959517537863],
Epoch3,train total loss: 0.028133244208919887,  Spearman:0.6605222427053766
Epoch3,val total loss: 0.03145117312669754,  Spearman:[0.8095238095238096]
Epoch3,test total loss: 0.3727718092501163,  Spearman is [-0.004864200876796344],
Epoch4,train total loss: 0.02363722135897917,  Spearman:0.6832798863225853
Epoch4,val total loss: 0.018107108771800995,  Spearman:[0.8571428571428572]
Epoch4,test total loss: 0.2859725162386894,  Spearman is [0.003339652180138602],
Epoch5,train total loss: 0.018869314094981514,  Spearman:0.724138312666837
Epoch5,val total loss: 0.008787228725850582,  Spearman:[0.8095238095238096]
Epoch5,test total loss: 0.20931034572422505,  Spearman is [0.08538396971096472],
Epoch6,train total loss: 0.016109843526441507,  Spearman:0.7620560030236833
Epoch6,val total loss: 0.015998832881450653,  Spearman:[0.8095238095238096]
Epoch6,test total loss: 0.09838363816961646,  Spearman is [0.1089240861165497],
Epoch7,train total loss: 0.014631699084137112,  Spearman:0.7758641533220196
Epoch7,val total loss: 0.0075596775859594345,  Spearman:[0.7619047619047621]
Epoch7,test total loss: 0.16872567255049944,  Spearman is [0.11567896950893071],
Epoch8,train total loss: 0.013500750288725473,  Spearman:0.7943483848971713
Epoch8,val total loss: 0.006302329711616039,  Spearman:[0.7857142857142858]
Epoch8,test total loss: 0.13578853057697415,  Spearman is [0.13570805747351042],
Epoch9,train total loss: 0.013000507292767556,  Spearman:0.8023893557589136
Epoch9,val total loss: 0.008034746162593365,  Spearman:[0.9285714285714287]
Epoch9,test total loss: 0.12587314732372762,  Spearman is [0.15091621196247074],
Epoch10,train total loss: 0.01245148348598144,  Spearman:0.8097227802635341
Epoch10,val total loss: 0.006407703272998333,  Spearman:[0.880952380952381]
Epoch10,test total loss: 0.11295489743351936,  Spearman is [0.14131863499480626],
Epoch11,train total loss: 0.012132488719474237,  Spearman:0.8141461653984399
Epoch11,val total loss: 0.009980570524930954,  Spearman:[0.8095238095238096]
Epoch11,test total loss: 0.11277812477201224,  Spearman is [0.14057273511701932],
Epoch12,train total loss: 0.011739185651561294,  Spearman:0.8210708281278152
Epoch12,val total loss: 0.010980341583490372,  Spearman:[0.880952380952381]
Epoch12,test total loss: 0.10553205409087241,  Spearman is [0.15522772842582866],
Epoch13,train total loss: 0.011201578637179082,  Spearman:0.8256044265249124
Epoch13,val total loss: 0.008893697522580624,  Spearman:[0.880952380952381]
Epoch13,test total loss: 0.16237211730331183,  Spearman is [0.1280868527958871],
Epoch14,train total loss: 0.010757978705581851,  Spearman:0.8303876485163485
Epoch14,val total loss: 0.01124134287238121,  Spearman:[0.8571428571428572]
Epoch14,test total loss: 0.1493885305710137,  Spearman is [0.12508067755888774],
Epoch15,train total loss: 0.010474040193889195,  Spearman:0.830923566615941
Epoch15,val total loss: 0.011921440251171589,  Spearman:[0.880952380952381]
Epoch15,test total loss: 0.12508765286765994,  Spearman is [0.13197191623106272],
Epoch16,train total loss: 0.009887472595064303,  Spearman:0.8362028747225716
Epoch16,val total loss: 0.013385213911533356,  Spearman:[0.9285714285714287]
Epoch16,test total loss: 0.13871348248794674,  Spearman is [0.13224913141407288],
Epoch17,train total loss: 0.00928587685428703,  Spearman:0.8447966429926345
Epoch17,val total loss: 0.010357677936553955,  Spearman:[0.9285714285714287]
Epoch17,test total loss: 0.18700091512873768,  Spearman is [0.11854690870365614],
Epoch18,train total loss: 0.008373938426255988,  Spearman:0.85439855018958
Epoch18,val total loss: 0.017371607944369316,  Spearman:[0.9047619047619048]
Epoch18,test total loss: 0.1302182267419994,  Spearman is [0.11938413735529305],
Epoch19,train total loss: 0.008065666497434275,  Spearman:0.8599222285106201
Epoch19,val total loss: 0.017954818904399872,  Spearman:[0.9047619047619048]
Epoch19,test total loss: 0.1693538805935532,  Spearman is [0.11733183750024097],
Epoch20,train total loss: 0.007885530179826161,  Spearman:0.8634888515105148
Epoch20,val total loss: 0.022357527166604996,  Spearman:[0.9047619047619048]
Epoch20,test total loss: 0.16827760324813426,  Spearman is [0.11347491316524562],
Epoch21,train total loss: 0.007583270377019802,  Spearman:0.8696907643174059
Epoch21,val total loss: 0.0179055817425251,  Spearman:[0.9047619047619048]
Epoch21,test total loss: 0.17451505749486387,  Spearman is [0.11512898458149932],
Epoch22,train total loss: 0.007365272065493254,  Spearman:0.8694348961135617
Epoch22,val total loss: 0.022902892902493477,  Spearman:[0.8333333333333335]
Epoch22,test total loss: 0.17278645881451665,  Spearman is [0.107538838789165],
Epoch23,train total loss: 0.007209885862464897,  Spearman:0.871171259766406
Epoch23,val total loss: 0.01912466064095497,  Spearman:[0.8333333333333335]
Epoch23,test total loss: 0.23487563990056515,  Spearman is [0.11162721527885669],
Epoch24,train total loss: 0.007141033877791741,  Spearman:0.8727966836419919
Epoch24,val total loss: 0.01837293431162834,  Spearman:[0.7619047619047621]
Epoch24,test total loss: 0.22479324927553535,  Spearman is [0.1125242337642957],
Epoch25,train total loss: 0.006882401499658441,  Spearman:0.8762409645139043
Epoch25,val total loss: 0.018155617639422417,  Spearman:[0.7619047619047621]
Epoch25,test total loss: 0.19097707611508669,  Spearman is [0.1129505223901633],
Epoch26,train total loss: 0.006648158173984251,  Spearman:0.8820775249549275
Epoch26,val total loss: 0.014463287778198719,  Spearman:[0.8333333333333335]
Epoch26,test total loss: 0.20153753887861967,  Spearman is [0.1121570181781382],
Epoch27,train total loss: 0.0064241197911682184,  Spearman:0.8838116901130019
Epoch27,val total loss: 0.018129166215658188,  Spearman:[0.7619047619047621]
Epoch27,test total loss: 0.19924774933606387,  Spearman is [0.11090269446039709],
Epoch28,train total loss: 0.006277219606160473,  Spearman:0.8851962262095572
Epoch28,val total loss: 0.02075795829296112,  Spearman:[0.7619047619047621]
Epoch28,test total loss: 0.17036366346292198,  Spearman is [0.10773040036622786],
Epoch29,train total loss: 0.006441388658295648,  Spearman:0.8849488698193315
Epoch29,val total loss: 0.01835028827190399,  Spearman:[0.8333333333333335]
Epoch29,test total loss: 0.18831947185099124,  Spearman is [0.1111996311627494],
Epoch30,train total loss: 0.006127371184844285,  Spearman:0.8882472372833691
Epoch30,val total loss: 0.022272739559412003,  Spearman:[0.8333333333333335]
Epoch30,test total loss: 0.18465512301772832,  Spearman is [0.10919023373573573],
Epoch31,train total loss: 0.006049922900274396,  Spearman:0.8925329160376139
Epoch31,val total loss: 0.021453235298395157,  Spearman:[0.7619047619047621]
Epoch31,test total loss: 0.19512666771188378,  Spearman is [0.12067158503372209],
Epoch32,train total loss: 0.005893664858423364,  Spearman:0.8948868748038034
Epoch32,val total loss: 0.021288631483912468,  Spearman:[0.8333333333333335]
Epoch32,test total loss: 0.1863161801826209,  Spearman is [0.11719456814357737],
Epoch33,train total loss: 0.005697198280055697,  Spearman:0.8974349686426581
Epoch33,val total loss: 0.019605863839387894,  Spearman:[0.8333333333333335]
Epoch33,test total loss: 0.22043736670166253,  Spearman is [0.10929893654620088],
Epoch34,train total loss: 0.005991774869378274,  Spearman:0.8921105831445336
Epoch34,val total loss: 0.018820080906152725,  Spearman:[0.7619047619047621]
Epoch34,test total loss: 0.21613029977306725,  Spearman is [0.11043037300409303],
Epoch35,train total loss: 0.005931267755864284,  Spearman:0.8935631816213485
Epoch35,val total loss: 0.02040974050760269,  Spearman:[0.7619047619047621]
Epoch35,test total loss: 0.2296630922704935,  Spearman is [0.11101989997625077],
Epoch36,train total loss: 0.0058599344920367,  Spearman:0.8955150548604913
Epoch36,val total loss: 0.019972454756498337,  Spearman:[0.8333333333333335]
Epoch36,test total loss: 0.17370138494297863,  Spearman is [0.11523951554570368],
Epoch37,train total loss: 0.005610634518327573,  Spearman:0.8973581181071644
Epoch37,val total loss: 0.015930762514472008,  Spearman:[0.7619047619047621]
Epoch37,test total loss: 0.23751046564429998,  Spearman is [0.11136917598183062],
Epoch38,train total loss: 0.005442607743390955,  Spearman:0.9001077708933366
Epoch38,val total loss: 0.01663259230554104,  Spearman:[0.9047619047619048]
Epoch38,test total loss: 0.17695098291151226,  Spearman is [0.11871713086027381],
Epoch39,train total loss: 0.005427513476043271,  Spearman:0.8993674681350139
Epoch39,val total loss: 0.01646346226334572,  Spearman:[0.8333333333333335]
Epoch39,test total loss: 0.17168004028499126,  Spearman is [0.11958194622031369],
Epoch40,train total loss: 0.004764702260264386,  Spearman:0.9044895298382224
Epoch40,val total loss: 0.014169530011713505,  Spearman:[0.7857142857142858]
Epoch40,test total loss: 0.15766237005591394,  Spearman is [0.1362953156937256],
Epoch41,train total loss: 0.004406644918699152,  Spearman:0.9037557893887499
Epoch41,val total loss: 0.012663866393268108,  Spearman:[0.7619047619047621]
Epoch41,test total loss: 0.13781401133164764,  Spearman is [0.1375482717665352],
Epoch42,train total loss: 0.004248002853366928,  Spearman:0.8990708574916558
Epoch42,val total loss: 0.01248724851757288,  Spearman:[0.7857142857142858]
Epoch42,test total loss: 0.08390009473077953,  Spearman is [0.14580983003592213],
Epoch43,train total loss: 0.0036869791876644087,  Spearman:0.9097229007090132
Epoch43,val total loss: 0.01080512534826994,  Spearman:[0.7857142857142858]
Epoch43,test total loss: 0.08092646785080433,  Spearman is [0.1501865090007259],
Epoch44,train total loss: 0.0035491521270253146,  Spearman:0.9132604134427704
Epoch44,val total loss: 0.009761043824255466,  Spearman:[0.7857142857142858]
Epoch44,test total loss: 0.07979086767882108,  Spearman is [0.15654369661780806],
Epoch45,train total loss: 0.003408845187200663,  Spearman:0.9139635173638193
Epoch45,val total loss: 0.01178523525595665,  Spearman:[0.7619047619047621]
Epoch45,test total loss: 0.0748621636070311,  Spearman is [0.1542009373292754],
Epoch46,train total loss: 0.003375361335481732,  Spearman:0.9145180094675854
Epoch46,val total loss: 0.011317171156406403,  Spearman:[0.7857142857142858]
Epoch46,test total loss: 0.06691075721755624,  Spearman is [0.15507275622792052],
Epoch47,train total loss: 0.0033378895948258922,  Spearman:0.9136881866776237
Epoch47,val total loss: 0.010574592277407646,  Spearman:[0.7857142857142858]
Epoch47,test total loss: 0.07280295947566628,  Spearman is [0.15248009226889203],
Epoch48,train total loss: 0.0030578088346653832,  Spearman:0.9209255017020679
Epoch48,val total loss: 0.01358130294829607,  Spearman:[0.7857142857142858]
Epoch48,test total loss: 0.05723445480689406,  Spearman is [0.14857552414310302],
Epoch49,train total loss: 0.0031030969082330093,  Spearman:0.9190971808708581
Epoch49,val total loss: 0.013568604364991188,  Spearman:[0.7857142857142858]
Epoch49,test total loss: 0.05747079830616712,  Spearman is [0.15609908699799274],
Early stop at epoch 49
ensemble idx 0, best epoch 9, best validation spearman is 0.9285714285714287,best test spearman is [0.15091298967710307],

ensemble 1 models, fold 4, spearman is 0.15091298967710307, ndcg is 0.791191863184773
ensemble 5 fold, for test dataset SaCas9-mean-2,spearman is 0.15093921513434047, ndcg is 0.8068835715137891
training on fold 0 
Epoch0,train total loss: 0.1631977172831121,  Spearman:0.09811998393763252
Epoch0,val total loss: 0.07960682362318039,  Spearman:[0.7857142857142858]
Epoch0,test total loss: 0.03592286147177219,  Spearman is [-0.06751446397590341],
Epoch1,train total loss: 0.04860479099890934,  Spearman:0.5088810490434748
Epoch1,val total loss: 0.03280121460556984,  Spearman:[0.9523809523809524]
Epoch1,test total loss: 0.21418012119829655,  Spearman is [-0.05357792193442234],
Epoch2,train total loss: 0.02932563954546379,  Spearman:0.6138333002120123
Epoch2,val total loss: 0.04954386502504349,  Spearman:[0.9523809523809524]
Epoch2,test total loss: 0.33972353041172026,  Spearman is [-0.03344337317302297],
Epoch3,train total loss: 0.026263311117266614,  Spearman:0.6352585019095204
Epoch3,val total loss: 0.043175797909498215,  Spearman:[0.8095238095238096]
Epoch3,test total loss: 0.3889289751648903,  Spearman is [-0.021136695950982408],
Epoch4,train total loss: 0.02108756124149435,  Spearman:0.6701318040241978
Epoch4,val total loss: 0.019095242023468018,  Spearman:[0.9285714285714287]
Epoch4,test total loss: 0.2652840748429298,  Spearman is [0.07762466708901183],
Epoch5,train total loss: 0.016619123231906157,  Spearman:0.714120990923411
Epoch5,val total loss: 0.018503565341234207,  Spearman:[0.9047619047619048]
Epoch5,test total loss: 0.19310982394963502,  Spearman is [0.12609975489883632],
Epoch6,train total loss: 0.014871745504653798,  Spearman:0.7419798716240366
Epoch6,val total loss: 0.014175217598676682,  Spearman:[0.9761904761904763]
Epoch6,test total loss: 0.14374122032895684,  Spearman is [0.1378465435980093],
Epoch7,train total loss: 0.0142779578633893,  Spearman:0.7515032887322108
Epoch7,val total loss: 0.015542259439826012,  Spearman:[0.9285714285714287]
Epoch7,test total loss: 0.09712172644212842,  Spearman is [0.14206016177102274],
Epoch8,train total loss: 0.013199093223262865,  Spearman:0.7594449504840795
Epoch8,val total loss: 0.0158061645925045,  Spearman:[0.9285714285714287]
Epoch8,test total loss: 0.10016110893338918,  Spearman is [0.1584856233348779],
Epoch9,train total loss: 0.012978621474944819,  Spearman:0.769091688884292
Epoch9,val total loss: 0.012779425829648972,  Spearman:[0.9285714285714287]
Epoch9,test total loss: 0.1403163431212306,  Spearman is [0.15980113777646876],
Epoch10,train total loss: 0.012593045162084775,  Spearman:0.7729625359412616
Epoch10,val total loss: 0.013240331783890724,  Spearman:[0.9285714285714287]
Epoch10,test total loss: 0.12189712366089225,  Spearman is [0.1626304687316152],
Epoch11,train total loss: 0.011900019031973222,  Spearman:0.777936762518889
Epoch11,val total loss: 0.019169233739376068,  Spearman:[0.9285714285714287]
Epoch11,test total loss: 0.09274852108210326,  Spearman is [0.1605375483526525],
Epoch12,train total loss: 0.010665441549812945,  Spearman:0.7916621024202383
Epoch12,val total loss: 0.01721012592315674,  Spearman:[0.9047619047619048]
Epoch12,test total loss: 0.15211112909018992,  Spearman is [0.14596040940398206],
Epoch13,train total loss: 0.010162187886472123,  Spearman:0.7952791343806352
Epoch13,val total loss: 0.01924097165465355,  Spearman:[0.9047619047619048]
Epoch13,test total loss: 0.1632717728614807,  Spearman is [0.13434349853340477],
Epoch14,train total loss: 0.009293031314602839,  Spearman:0.798658621639733
Epoch14,val total loss: 0.019188735634088516,  Spearman:[0.9285714285714287]
Epoch14,test total loss: 0.16602487564086915,  Spearman is [0.14221932951600144],
Epoch15,train total loss: 0.00868343298162262,  Spearman:0.8029018033823657
Epoch15,val total loss: 0.016519291326403618,  Spearman:[0.9285714285714287]
Epoch15,test total loss: 0.17047847174108027,  Spearman is [0.137864976385531],
Epoch16,train total loss: 0.008265483319962349,  Spearman:0.8068152417954271
Epoch16,val total loss: 0.014389397576451302,  Spearman:[0.9285714285714287]
Epoch16,test total loss: 0.14175819586962463,  Spearman is [0.13882227133562358],
Epoch17,train total loss: 0.007902009849950003,  Spearman:0.8099592650275776
Epoch17,val total loss: 0.012373905628919601,  Spearman:[0.9285714285714287]
Epoch17,test total loss: 0.17535982243716716,  Spearman is [0.139246508220604],
Epoch18,train total loss: 0.007210287267718321,  Spearman:0.8182653630907791
Epoch18,val total loss: 0.02085256204009056,  Spearman:[0.9285714285714287]
Epoch18,test total loss: 0.17219873443245887,  Spearman is [0.13754303719683586],
Epoch19,train total loss: 0.006710752850780502,  Spearman:0.8203158419710922
Epoch19,val total loss: 0.011251898482441902,  Spearman:[0.9285714285714287]
Epoch19,test total loss: 0.19788481406867503,  Spearman is [0.14351128839394528],
Epoch20,train total loss: 0.006152132143959021,  Spearman:0.8240716479986561
Epoch20,val total loss: 0.01311709824949503,  Spearman:[0.9285714285714287]
Epoch20,test total loss: 0.15922703873366117,  Spearman is [0.1479813084169306],
Epoch21,train total loss: 0.005487266935420056,  Spearman:0.8327428212218213
Epoch21,val total loss: 0.008963441476225853,  Spearman:[0.9285714285714287]
Epoch21,test total loss: 0.17075507435947657,  Spearman is [0.14552534169451062],
Epoch22,train total loss: 0.005227862614750241,  Spearman:0.8262468191363213
Epoch22,val total loss: 0.0150460135191679,  Spearman:[0.9285714285714287]
Epoch22,test total loss: 0.15613314937800168,  Spearman is [0.1478893877947478],
Epoch23,train total loss: 0.004869301525058034,  Spearman:0.8306113718102835
Epoch23,val total loss: 0.017544414848089218,  Spearman:[0.9285714285714287]
Epoch23,test total loss: 0.13942565415054559,  Spearman is [0.1528079039082675],
Epoch24,train total loss: 0.004551071481098636,  Spearman:0.8383686416866766
Epoch24,val total loss: 0.011765883304178715,  Spearman:[0.9285714285714287]
Epoch24,test total loss: 0.15251890271902085,  Spearman is [0.14707368927024117],
Epoch25,train total loss: 0.0043154452167726,  Spearman:0.8411293989392926
Epoch25,val total loss: 0.018231820315122604,  Spearman:[0.9285714285714287]
Epoch25,test total loss: 0.14823173321783542,  Spearman is [0.15340891273808238],
Epoch26,train total loss: 0.004410827762256257,  Spearman:0.8464675323993591
Epoch26,val total loss: 0.01955873891711235,  Spearman:[0.9285714285714287]
Epoch26,test total loss: 0.1421201966702938,  Spearman is [0.15621380693317508],
Epoch27,train total loss: 0.0042712154607169135,  Spearman:0.8432519660695337
Epoch27,val total loss: 0.02016218937933445,  Spearman:[0.9285714285714287]
Epoch27,test total loss: 0.10392643306404352,  Spearman is [0.15797662061644946],
Epoch28,train total loss: 0.0038998854463734925,  Spearman:0.8526692647056223
Epoch28,val total loss: 0.024407465010881424,  Spearman:[0.9047619047619048]
Epoch28,test total loss: 0.09899794049561024,  Spearman is [0.1584839398551756],
Epoch29,train total loss: 0.004106657991099219,  Spearman:0.8494030947032909
Epoch29,val total loss: 0.020945381373167038,  Spearman:[0.9285714285714287]
Epoch29,test total loss: 0.12251055911183358,  Spearman is [0.1528411986650361],
Epoch30,train total loss: 0.003939923834061632,  Spearman:0.8516283484869401
Epoch30,val total loss: 0.02217698283493519,  Spearman:[0.9761904761904763]
Epoch30,test total loss: 0.11016696449369193,  Spearman is [0.15599746663924394],
Epoch31,train total loss: 0.003905878483261077,  Spearman:0.8565188234096199
Epoch31,val total loss: 0.02677866630256176,  Spearman:[0.9047619047619048]
Epoch31,test total loss: 0.09496796661987901,  Spearman is [0.15848088854821515],
Epoch32,train total loss: 0.003932324328791135,  Spearman:0.8539453974706194
Epoch32,val total loss: 0.024787072092294693,  Spearman:[0.9285714285714287]
Epoch32,test total loss: 0.11169759966433049,  Spearman is [0.1563464138401944],
Epoch33,train total loss: 0.0037850118678761646,  Spearman:0.8561589878438683
Epoch33,val total loss: 0.015355352312326431,  Spearman:[0.9285714285714287]
Epoch33,test total loss: 0.1111460404470563,  Spearman is [0.1516249700693256],
Epoch34,train total loss: 0.003569115581250606,  Spearman:0.8656313142785313
Epoch34,val total loss: 0.015596745535731316,  Spearman:[0.9285714285714287]
Epoch34,test total loss: 0.11778565840795636,  Spearman is [0.16005262728527808],
Epoch35,train total loss: 0.003759850617662335,  Spearman:0.8585892261435168
Epoch35,val total loss: 0.011933866888284683,  Spearman:[0.9285714285714287]
Epoch35,test total loss: 0.12487907810136675,  Spearman is [0.15530368229520994],
Epoch36,train total loss: 0.003636452060070438,  Spearman:0.862789709484045
Epoch36,val total loss: 0.020068634301424026,  Spearman:[0.9285714285714287]
Epoch36,test total loss: 0.11547676920890808,  Spearman is [0.1574111752953457],
Epoch37,train total loss: 0.00358660876913629,  Spearman:0.8675887562269323
Epoch37,val total loss: 0.016283344477415085,  Spearman:[0.9285714285714287]
Epoch37,test total loss: 0.10941072180867195,  Spearman is [0.1596683401627644],
Epoch38,train total loss: 0.0036938515456709773,  Spearman:0.8677799540217572
Epoch38,val total loss: 0.020472249016165733,  Spearman:[0.9285714285714287]
Epoch38,test total loss: 0.10826253634877503,  Spearman is [0.15414657277185767],
Epoch39,train total loss: 0.0036928844194148835,  Spearman:0.8646465913342233
Epoch39,val total loss: 0.018554722890257835,  Spearman:[0.9285714285714287]
Epoch39,test total loss: 0.11238239607773721,  Spearman is [0.15669225712544374],
Epoch40,train total loss: 0.0035377911859914325,  Spearman:0.8714980121833286
Epoch40,val total loss: 0.01891365274786949,  Spearman:[0.9285714285714287]
Epoch40,test total loss: 0.10960796037688851,  Spearman is [0.15636879885936095],
Epoch41,train total loss: 0.0034944315094691822,  Spearman:0.8717977826081086
Epoch41,val total loss: 0.022917071357369423,  Spearman:[0.9285714285714287]
Epoch41,test total loss: 0.1118873200379312,  Spearman is [0.15437411872755727],
Epoch42,train total loss: 0.0035434583282599654,  Spearman:0.8742984924329117
Epoch42,val total loss: 0.012725752778351307,  Spearman:[0.9285714285714287]
Epoch42,test total loss: 0.11479811868630349,  Spearman is [0.15318801521198835],
Epoch43,train total loss: 0.0033688431233316898,  Spearman:0.8783555443118405
Epoch43,val total loss: 0.02105705440044403,  Spearman:[0.9285714285714287]
Epoch43,test total loss: 0.10759809901937842,  Spearman is [0.15463909580226276],
Epoch44,train total loss: 0.0033577038665475226,  Spearman:0.8800983610697845
Epoch44,val total loss: 0.010988157242536545,  Spearman:[0.9285714285714287]
Epoch44,test total loss: 0.12274843966588378,  Spearman is [0.15195840426786306],
Epoch45,train total loss: 0.0032603629705800605,  Spearman:0.8834789216206936
Epoch45,val total loss: 0.021986283361911774,  Spearman:[0.9285714285714287]
Epoch45,test total loss: 0.10436359196901321,  Spearman is [0.15656999441206396],
Epoch46,train total loss: 0.003414967637628508,  Spearman:0.878990958480928
Epoch46,val total loss: 0.020419465377926826,  Spearman:[0.9285714285714287]
Epoch46,test total loss: 0.10211021951399743,  Spearman is [0.14750883589282365],
Epoch47,train total loss: 0.003456801056670837,  Spearman:0.8767941911956071
Epoch47,val total loss: 0.014854156412184238,  Spearman:[0.9285714285714287]
Epoch47,test total loss: 0.11649016011506319,  Spearman is [0.15154355804309702],
Epoch48,train total loss: 0.003251127460269998,  Spearman:0.8838250867681202
Epoch48,val total loss: 0.014615656808018684,  Spearman:[0.9285714285714287]
Epoch48,test total loss: 0.12733885874040424,  Spearman is [0.15457647824864817],
Epoch49,train total loss: 0.003290806019019025,  Spearman:0.8831140665909248
Epoch49,val total loss: 0.012235783971846104,  Spearman:[0.9285714285714287]
Epoch49,test total loss: 0.12404722981154918,  Spearman is [0.1468686861599302],
Early stop at epoch 49
ensemble idx 0, best epoch 6, best validation spearman is 0.9761904761904763,best test spearman is [0.13785091669957975],

ensemble 1 models, fold 0, spearman is 0.13785091669957975, ndcg is 0.7951039581666621
training on fold 1 
Epoch0,train total loss: 0.08881213170332977,  Spearman:0.17580052041391062
Epoch0,val total loss: 0.07012759149074554,  Spearman:[0.7619047619047621]
Epoch0,test total loss: 0.0251966523937881,  Spearman is [-0.017993106683282568],
Epoch1,train total loss: 0.04136936823861339,  Spearman:0.5483180549285005
Epoch1,val total loss: 0.05463532358407974,  Spearman:[0.8095238095238096]
Epoch1,test total loss: 0.12570278607308866,  Spearman is [-0.020459943686749065],
Epoch2,train total loss: 0.03050478365726005,  Spearman:0.6239398802926279
Epoch2,val total loss: 0.030493708327412605,  Spearman:[0.7619047619047621]
Epoch2,test total loss: 0.31545795425772666,  Spearman is [-0.028652321462119483],
Epoch3,train total loss: 0.02558843937750237,  Spearman:0.6498791504780451
Epoch3,val total loss: 0.025591280311346054,  Spearman:[0.8095238095238096]
Epoch3,test total loss: 0.2629733819514513,  Spearman is [-0.01653748858912304],
Epoch4,train total loss: 0.01876330522235292,  Spearman:0.7015120935589875
Epoch4,val total loss: 0.02316828817129135,  Spearman:[0.7857142857142858]
Epoch4,test total loss: 0.1727638928219676,  Spearman is [0.09952916459414259],
Epoch5,train total loss: 0.015299343817437498,  Spearman:0.737120067472625
Epoch5,val total loss: 0.016453830525279045,  Spearman:[0.7857142857142858]
Epoch5,test total loss: 0.10689880317077041,  Spearman is [0.13950885485827466],
Epoch6,train total loss: 0.013814606914260926,  Spearman:0.7583711975241224
Epoch6,val total loss: 0.01526523008942604,  Spearman:[0.7857142857142858]
Epoch6,test total loss: 0.10585884125903249,  Spearman is [0.14766927939976426],
Epoch7,train total loss: 0.012947666954296904,  Spearman:0.7687399011766949
Epoch7,val total loss: 0.017613258212804794,  Spearman:[0.7857142857142858]
Epoch7,test total loss: 0.10749247260391712,  Spearman is [0.1581175331284063],
Epoch8,train total loss: 0.01203449194928488,  Spearman:0.7813769419212028
Epoch8,val total loss: 0.021841276437044144,  Spearman:[0.7857142857142858]
Epoch8,test total loss: 0.12764755189418792,  Spearman is [0.15383682565881898],
Epoch9,train total loss: 0.011470789433074877,  Spearman:0.7924187311457584
Epoch9,val total loss: 0.023013800382614136,  Spearman:[0.8095238095238096]
Epoch9,test total loss: 0.1217365887016058,  Spearman is [0.1554347832770268],
Epoch10,train total loss: 0.010829026439191343,  Spearman:0.7990831579832874
Epoch10,val total loss: 0.013809421099722385,  Spearman:[0.8095238095238096]
Epoch10,test total loss: 0.07256718222051858,  Spearman is [0.1744247762758227],
Epoch11,train total loss: 0.010483527003835218,  Spearman:0.8075026986622135
Epoch11,val total loss: 0.014995364472270012,  Spearman:[0.7857142857142858]
Epoch11,test total loss: 0.09787979405373334,  Spearman is [0.16550526021481643],
Epoch12,train total loss: 0.009871855122932734,  Spearman:0.8155435202578952
Epoch12,val total loss: 0.01927402801811695,  Spearman:[0.7857142857142858]
Epoch12,test total loss: 0.11960027916356922,  Spearman is [0.17199789561091555],
Epoch13,train total loss: 0.009235632555105556,  Spearman:0.8237816069880255
Epoch13,val total loss: 0.014106977730989456,  Spearman:[0.7857142857142858]
Epoch13,test total loss: 0.09412980871275067,  Spearman is [0.16206676607504708],
Epoch14,train total loss: 0.008821838924912019,  Spearman:0.8272841368256229
Epoch14,val total loss: 0.016673531383275986,  Spearman:[0.8095238095238096]
Epoch14,test total loss: 0.11648349817842245,  Spearman is [0.17251947839446316],
Epoch15,train total loss: 0.008366859077702826,  Spearman:0.8387623737149046
Epoch15,val total loss: 0.015683090314269066,  Spearman:[0.8095238095238096]
Epoch15,test total loss: 0.11211676606908441,  Spearman is [0.1579519339648774],
Epoch16,train total loss: 0.007949952446580984,  Spearman:0.8479155947480312
Epoch16,val total loss: 0.01813817210495472,  Spearman:[0.8095238095238096]
Epoch16,test total loss: 0.14209089418873191,  Spearman is [0.1726960596326126],
Epoch17,train total loss: 0.00786631704809574,  Spearman:0.849577240877698
Epoch17,val total loss: 0.016164828091859818,  Spearman:[0.8095238095238096]
Epoch17,test total loss: 0.12776785679161548,  Spearman is [0.16933159256709646],
Epoch18,train total loss: 0.007529013629746026,  Spearman:0.8535954737539942
Epoch18,val total loss: 0.01493277121335268,  Spearman:[0.7857142857142858]
Epoch18,test total loss: 0.1245273744687438,  Spearman is [0.16162775928611595],
Epoch19,train total loss: 0.007341896550198539,  Spearman:0.85743452375803
Epoch19,val total loss: 0.015462454408407211,  Spearman:[0.7857142857142858]
Epoch19,test total loss: 0.14781327014788986,  Spearman is [0.16682330645205334],
Epoch20,train total loss: 0.007133397347598265,  Spearman:0.8592288186762719
Epoch20,val total loss: 0.016202909871935844,  Spearman:[0.7857142857142858]
Epoch20,test total loss: 0.14117721300572156,  Spearman is [0.1639458845318173],
Epoch21,train total loss: 0.0071315302771743005,  Spearman:0.8615481204337737
Epoch21,val total loss: 0.018675602972507477,  Spearman:[0.7857142857142858]
Epoch21,test total loss: 0.11176940696313978,  Spearman is [0.16544234673703542],
Epoch22,train total loss: 0.0068337300804276494,  Spearman:0.8650583899031157
Epoch22,val total loss: 0.015330730937421322,  Spearman:[0.8095238095238096]
Epoch22,test total loss: 0.1183797380886972,  Spearman is [0.15920511362483494],
Epoch23,train total loss: 0.006893088849327073,  Spearman:0.8636711426822725
Epoch23,val total loss: 0.023253288120031357,  Spearman:[0.7857142857142858]
Epoch23,test total loss: 0.09529830357059836,  Spearman is [0.16818850984923253],
Epoch24,train total loss: 0.006904689959274271,  Spearman:0.8655112238431868
Epoch24,val total loss: 0.016730530187487602,  Spearman:[0.7857142857142858]
Epoch24,test total loss: 0.15054753297008575,  Spearman is [0.15866491392317317],
Epoch25,train total loss: 0.006573945164489441,  Spearman:0.8659320410373211
Epoch25,val total loss: 0.015320958569645882,  Spearman:[0.8095238095238096]
Epoch25,test total loss: 0.15250613102689387,  Spearman is [0.1532938048134374],
Epoch26,train total loss: 0.006483778055273713,  Spearman:0.8689624749761874
Epoch26,val total loss: 0.018033377826213837,  Spearman:[0.7857142857142858]
Epoch26,test total loss: 0.16241944171488285,  Spearman is [0.15441743544942862],
Epoch27,train total loss: 0.006457398009773057,  Spearman:0.8699841675760077
Epoch27,val total loss: 0.01603529416024685,  Spearman:[0.7857142857142858]
Epoch27,test total loss: 0.11729115778580308,  Spearman is [0.15925228393696234],
Epoch28,train total loss: 0.00625416971086405,  Spearman:0.8719794581942544
Epoch28,val total loss: 0.017318299040198326,  Spearman:[0.7857142857142858]
Epoch28,test total loss: 0.18834564806893467,  Spearman is [0.15778496039799778],
Epoch29,train total loss: 0.006057478633757012,  Spearman:0.8735440787852848
Epoch29,val total loss: 0.017359625548124313,  Spearman:[0.7857142857142858]
Epoch29,test total loss: 0.16069077542051674,  Spearman is [0.1591630463605551],
Epoch30,train total loss: 0.006265874919242775,  Spearman:0.8694641776173743
Epoch30,val total loss: 0.015177685767412186,  Spearman:[0.7857142857142858]
Epoch30,test total loss: 0.15678670573979617,  Spearman is [0.1570029051631668],
Epoch31,train total loss: 0.005713478848636628,  Spearman:0.8775862251969788
Epoch31,val total loss: 0.01950770430266857,  Spearman:[0.7857142857142858]
Epoch31,test total loss: 0.1192309725098312,  Spearman is [0.15145424812967134],
Epoch32,train total loss: 0.005265911414962596,  Spearman:0.8812793680410609
Epoch32,val total loss: 0.013406941667199135,  Spearman:[0.7857142857142858]
Epoch32,test total loss: 0.14789043180644512,  Spearman is [0.1566964921290699],
Epoch33,train total loss: 0.004395188411879831,  Spearman:0.8868237856871669
Epoch33,val total loss: 0.012258595786988735,  Spearman:[0.7857142857142858]
Epoch33,test total loss: 0.1324591351673007,  Spearman is [0.16428435601727648],
Epoch34,train total loss: 0.0037666974266101485,  Spearman:0.8906407921790842
Epoch34,val total loss: 0.014927747659385204,  Spearman:[0.8095238095238096]
Epoch34,test total loss: 0.1086004177108407,  Spearman is [0.1653787690739031],
Epoch35,train total loss: 0.003506880958388464,  Spearman:0.8914511380524844
Epoch35,val total loss: 0.012354306876659393,  Spearman:[0.8095238095238096]
Epoch35,test total loss: 0.10197816560976207,  Spearman is [0.16660228398020016],
Epoch36,train total loss: 0.0032261713390769916,  Spearman:0.8963284963275515
Epoch36,val total loss: 0.017019251361489296,  Spearman:[0.7857142857142858]
Epoch36,test total loss: 0.1440226218663156,  Spearman is [0.16373274021888345],
Epoch37,train total loss: 0.003052068526859586,  Spearman:0.9000001953052511
Epoch37,val total loss: 0.012237627059221268,  Spearman:[0.7857142857142858]
Epoch37,test total loss: 0.12298504882492126,  Spearman is [0.1643089703318301],
Epoch38,train total loss: 0.0031102466906677596,  Spearman:0.8959071285967857
Epoch38,val total loss: 0.011619331315159798,  Spearman:[0.7857142857142858]
Epoch38,test total loss: 0.1080059114843607,  Spearman is [0.16482800816754645],
Epoch39,train total loss: 0.003217187890326246,  Spearman:0.8899291786002047
Epoch39,val total loss: 0.010732505470514297,  Spearman:[0.7857142857142858]
Epoch39,test total loss: 0.11845073574222624,  Spearman is [0.1626017772396576],
Epoch40,train total loss: 0.002880636127650714,  Spearman:0.9036206472398817
Epoch40,val total loss: 0.011387104168534279,  Spearman:[0.7857142857142858]
Epoch40,test total loss: 0.08798829573206604,  Spearman is [0.16910142275045462],
Epoch41,train total loss: 0.00294842304309639,  Spearman:0.899016867019389
Epoch41,val total loss: 0.015614239498972893,  Spearman:[0.7857142857142858]
Epoch41,test total loss: 0.14617770169861616,  Spearman is [0.1642193184615898],
Epoch42,train total loss: 0.0028003532624540804,  Spearman:0.9037990992882812
Epoch42,val total loss: 0.011531908996403217,  Spearman:[0.7142857142857144]
Epoch42,test total loss: 0.11212691622786224,  Spearman is [0.1606781780926281],
Epoch43,train total loss: 0.0026102883603949197,  Spearman:0.9123232031028635
Epoch43,val total loss: 0.01328941062092781,  Spearman:[0.7142857142857144]
Epoch43,test total loss: 0.13072628560476005,  Spearman is [0.1589419778560538],
Epoch44,train total loss: 0.002948790079337927,  Spearman:0.9020237979511677
Epoch44,val total loss: 0.011567248962819576,  Spearman:[0.7857142857142858]
Epoch44,test total loss: 0.10066177113913,  Spearman is [0.16468069711750233],
Epoch45,train total loss: 0.0027353872928637057,  Spearman:0.9080144241220384
Epoch45,val total loss: 0.012747840955853462,  Spearman:[0.7857142857142858]
Epoch45,test total loss: 0.14481909461319448,  Spearman is [0.1537840393636222],
Epoch46,train total loss: 0.0027110467945488216,  Spearman:0.908214422564154
Epoch46,val total loss: 0.011491511948406696,  Spearman:[0.7857142857142858]
Epoch46,test total loss: 0.10769992438144982,  Spearman is [0.1629588722193235],
Epoch47,train total loss: 0.0026800716986121512,  Spearman:0.9086725072990872
Epoch47,val total loss: 0.009432226419448853,  Spearman:[0.7857142857142858]
Epoch47,test total loss: 0.11705759828910231,  Spearman is [0.158978560659116],
Epoch48,train total loss: 0.002562500575806599,  Spearman:0.9129586672371002
Epoch48,val total loss: 0.012040877714753151,  Spearman:[0.7142857142857144]
Epoch48,test total loss: 0.09760962659493089,  Spearman is [0.15832181944462523],
Epoch49,train total loss: 0.002636207112235029,  Spearman:0.9106070006610103
Epoch49,val total loss: 0.010183965787291527,  Spearman:[0.7857142857142858]
Epoch49,test total loss: 0.08983230176381767,  Spearman is [0.15339045364619033],
Early stop at epoch 49
ensemble idx 0, best epoch 1, best validation spearman is 0.8095238095238096,best test spearman is [-0.02046757195415013],

ensemble 1 models, fold 1, spearman is -0.02046757195415013, ndcg is 0.7661706858469595
training on fold 2 
Epoch0,train total loss: 0.11152860657789578,  Spearman:0.07534481829603681
Epoch0,val total loss: 0.11517615616321564,  Spearman:[0.5628843430992317]
Epoch0,test total loss: 0.07796153239905834,  Spearman is [-0.07060514857873985],
Epoch1,train total loss: 0.04275034022374222,  Spearman:0.5132976164916786
Epoch1,val total loss: 0.06364742666482925,  Spearman:[0.5389318178609664]
Epoch1,test total loss: 0.08558231517672539,  Spearman is [-0.04076842352098524],
Epoch2,train total loss: 0.029626956609531473,  Spearman:0.6404287896058263
Epoch2,val total loss: 0.06040211021900177,  Spearman:[0.5149792926227014]
Epoch2,test total loss: 0.31838443502783775,  Spearman is [-0.027566299499633993],
Epoch3,train total loss: 0.025850665701839786,  Spearman:0.670058258585445
Epoch3,val total loss: 0.04932676628232002,  Spearman:[0.5389318178609664]
Epoch3,test total loss: 0.33251960948109627,  Spearman is [-0.02547524015487343],
Epoch4,train total loss: 0.023159413129831545,  Spearman:0.6916547502486599
Epoch4,val total loss: 0.042442526668310165,  Spearman:[0.5389318178609664]
Epoch4,test total loss: 0.2735652055591345,  Spearman is [-0.011321463470869361],
Epoch5,train total loss: 0.018939881367632784,  Spearman:0.7144633530874287
Epoch5,val total loss: 0.03792845457792282,  Spearman:[0.5389318178609664]
Epoch5,test total loss: 0.2686201065778732,  Spearman is [0.0787480807139477],
Epoch6,train total loss: 0.015247277936372811,  Spearman:0.7594133807791973
Epoch6,val total loss: 0.02726828306913376,  Spearman:[0.5389318178609664]
Epoch6,test total loss: 0.17014856729656458,  Spearman is [0.13817701197878995],
Epoch7,train total loss: 0.013904623866367798,  Spearman:0.7815387157257465
Epoch7,val total loss: 0.020905647426843643,  Spearman:[0.4910267673844361]
Epoch7,test total loss: 0.12463275045156479,  Spearman is [0.15816208615568403],
Epoch8,train total loss: 0.012954715809498269,  Spearman:0.7951276358105385
Epoch8,val total loss: 0.01955735683441162,  Spearman:[0.6347419188140272]
Epoch8,test total loss: 0.08692416865378619,  Spearman is [0.17006645118542962],
Epoch9,train total loss: 0.012625667860564321,  Spearman:0.8050317120601068
Epoch9,val total loss: 0.015333333984017372,  Spearman:[0.5389318178609664]
Epoch9,test total loss: 0.07566906744614244,  Spearman is [0.17439509836997705],
Epoch10,train total loss: 0.011837173836866919,  Spearman:0.8126534510623404
Epoch10,val total loss: 0.014139959588646889,  Spearman:[0.6347419188140272]
Epoch10,test total loss: 0.058548879157751796,  Spearman is [0.179406593856586],
Epoch11,train total loss: 0.01160191737401944,  Spearman:0.8160197837225595
Epoch11,val total loss: 0.016754206269979477,  Spearman:[0.6826469692905576]
Epoch11,test total loss: 0.05619414839893579,  Spearman is [0.19954863278744212],
Epoch12,train total loss: 0.010953998928949332,  Spearman:0.8265058352999285
Epoch12,val total loss: 0.022393230348825455,  Spearman:[0.6826469692905576]
Epoch12,test total loss: 0.08388840360566974,  Spearman is [0.18887860033629938],
Epoch13,train total loss: 0.010620556216543684,  Spearman:0.8276764157166511
Epoch13,val total loss: 0.01972763054072857,  Spearman:[0.6826469692905576]
Epoch13,test total loss: 0.07304950505495071,  Spearman is [0.1884735524894882],
Epoch14,train total loss: 0.010543607026099777,  Spearman:0.8308157978082262
Epoch14,val total loss: 0.01478840783238411,  Spearman:[0.5389318178609664]
Epoch14,test total loss: 0.07152985520660878,  Spearman is [0.19046443821586914],
Epoch15,train total loss: 0.010092343751472445,  Spearman:0.8361223395650942
Epoch15,val total loss: 0.019158802926540375,  Spearman:[0.6347419188140272]
Epoch15,test total loss: 0.08441938301548362,  Spearman is [0.18020913361982585],
Epoch16,train total loss: 0.009833989497751761,  Spearman:0.8366548698100538
Epoch16,val total loss: 0.01638880744576454,  Spearman:[0.6347419188140272]
Epoch16,test total loss: 0.062010864913463595,  Spearman is [0.17827421701745394],
Epoch17,train total loss: 0.009488779115669716,  Spearman:0.8369886160329533
Epoch17,val total loss: 0.013466909527778625,  Spearman:[0.5389318178609664]
Epoch17,test total loss: 0.06617912035435439,  Spearman is [0.17540303580908304],
Epoch18,train total loss: 0.009276174234214406,  Spearman:0.8410612625701642
Epoch18,val total loss: 0.015904197469353676,  Spearman:[0.6347419188140272]
Epoch18,test total loss: 0.09089056132361292,  Spearman is [0.18555349118491724],
Epoch19,train total loss: 0.008867377921258314,  Spearman:0.8458459841049667
Epoch19,val total loss: 0.01587195135653019,  Spearman:[0.5868368683374969]
Epoch19,test total loss: 0.08851575441658496,  Spearman is [0.17573458924514057],
Epoch20,train total loss: 0.008889355281075368,  Spearman:0.8455870598451036
Epoch20,val total loss: 0.013397760689258575,  Spearman:[0.5149792926227014]
Epoch20,test total loss: 0.1074693885166198,  Spearman is [0.17269970278790586],
Epoch21,train total loss: 0.00867074743981879,  Spearman:0.8486942895822642
Epoch21,val total loss: 0.013063771650195122,  Spearman:[0.6347419188140272]
Epoch21,test total loss: 0.10248625967651606,  Spearman is [0.17586505892206908],
Epoch22,train total loss: 0.00857637485023588,  Spearman:0.8481519934562862
Epoch22,val total loss: 0.017944710329174995,  Spearman:[0.6347419188140272]
Epoch22,test total loss: 0.12375459484755993,  Spearman is [0.17620279388515847],
Epoch23,train total loss: 0.008362667676127061,  Spearman:0.851119981183604
Epoch23,val total loss: 0.013735753484070301,  Spearman:[0.5149792926227014]
Epoch23,test total loss: 0.09341044072061777,  Spearman is [0.16531154167938497],
Epoch24,train total loss: 0.008504863509024756,  Spearman:0.8493334865716092
Epoch24,val total loss: 0.013033417984843254,  Spearman:[0.7065994945288228]
Epoch24,test total loss: 0.11163445855490864,  Spearman is [0.17100554351124103],
Epoch25,train total loss: 0.00810383096149263,  Spearman:0.8562255955161074
Epoch25,val total loss: 0.013696303591132164,  Spearman:[0.7784570702436182]
Epoch25,test total loss: 0.09184091165661812,  Spearman is [0.16786263815717026],
Epoch26,train total loss: 0.007890896389607148,  Spearman:0.8602449197189668
Epoch26,val total loss: 0.009033476002514362,  Spearman:[0.7065994945288228]
Epoch26,test total loss: 0.08841353612951934,  Spearman is [0.1647423545615992],
Epoch27,train total loss: 0.007510846971014801,  Spearman:0.8655054868940397
Epoch27,val total loss: 0.011034417897462845,  Spearman:[0.8263621207201486]
Epoch27,test total loss: 0.10388150638900698,  Spearman is [0.1660596050916331],
Epoch28,train total loss: 0.007132489338684349,  Spearman:0.8698322204687998
Epoch28,val total loss: 0.007576814852654934,  Spearman:[0.7545045450053531]
Epoch28,test total loss: 0.10663639390841126,  Spearman is [0.15853358935420833],
Epoch29,train total loss: 0.007082305144136533,  Spearman:0.8676465668748774
Epoch29,val total loss: 0.008241054601967335,  Spearman:[0.7545045450053531]
Epoch29,test total loss: 0.07941096187569201,  Spearman is [0.15221690389137027],
Epoch30,train total loss: 0.006719688669247075,  Spearman:0.8741252447787948
Epoch30,val total loss: 0.008093157783150673,  Spearman:[0.7545045450053531]
Epoch30,test total loss: 0.09317535851150752,  Spearman is [0.15333731881808638],
Epoch31,train total loss: 0.006527335837465496,  Spearman:0.8733193859661786
Epoch31,val total loss: 0.008486408740282059,  Spearman:[0.8503146459584139]
Epoch31,test total loss: 0.11565800858661532,  Spearman is [0.140402124970939],
Epoch32,train total loss: 0.006270325559083945,  Spearman:0.8769615348901385
Epoch32,val total loss: 0.009774165228009224,  Spearman:[0.8263621207201486]
Epoch32,test total loss: 0.10047600911930203,  Spearman is [0.14540972083464385],
Epoch33,train total loss: 0.005988571807019747,  Spearman:0.8796119186406551
Epoch33,val total loss: 0.008672785013914108,  Spearman:[0.7545045450053531]
Epoch33,test total loss: 0.09632213823497296,  Spearman is [0.13564032371986304],
Epoch34,train total loss: 0.005551619954460945,  Spearman:0.8813921054845107
Epoch34,val total loss: 0.006269272416830063,  Spearman:[0.8263621207201486]
Epoch34,test total loss: 0.10708844112232327,  Spearman is [0.1422304299602885],
Epoch35,train total loss: 0.00528526723680373,  Spearman:0.882481906174549
Epoch35,val total loss: 0.005461104679852724,  Spearman:[0.8503146459584139]
Epoch35,test total loss: 0.08280320768244565,  Spearman is [0.14035964998891878],
Epoch36,train total loss: 0.004446702742149146,  Spearman:0.8913487300811347
Epoch36,val total loss: 0.008373294025659561,  Spearman:[0.7545045450053531]
Epoch36,test total loss: 0.08401295109651982,  Spearman is [0.14120037054571946],
Epoch37,train total loss: 0.0036560010022441978,  Spearman:0.9040104503198304
Epoch37,val total loss: 0.009096111170947552,  Spearman:[0.7545045450053531]
Epoch37,test total loss: 0.09382400773465634,  Spearman is [0.13612494228697844],
Epoch38,train total loss: 0.0032736659990265393,  Spearman:0.901708051036124
Epoch38,val total loss: 0.007159383036196232,  Spearman:[0.7545045450053531]
Epoch38,test total loss: 0.0885174750816077,  Spearman is [0.14507763473508678],
Epoch39,train total loss: 0.0030527307647459498,  Spearman:0.904776203143804
Epoch39,val total loss: 0.006670230533927679,  Spearman:[0.7545045450053531]
Epoch39,test total loss: 0.07275529871694744,  Spearman is [0.1461463089653274],
Epoch40,train total loss: 0.003080230589451579,  Spearman:0.9021149362047466
Epoch40,val total loss: 0.0072967298328876495,  Spearman:[0.7545045450053531]
Epoch40,test total loss: 0.07999934921972454,  Spearman is [0.14976582978183509],
Epoch41,train total loss: 0.003010876001028989,  Spearman:0.9033665289668381
Epoch41,val total loss: 0.008080948144197464,  Spearman:[0.7545045450053531]
Epoch41,test total loss: 0.08771379585377873,  Spearman is [0.1503445982665203],
Epoch42,train total loss: 0.0027829030120464712,  Spearman:0.9107486538396606
Epoch42,val total loss: 0.00578478816896677,  Spearman:[0.7545045450053531]
Epoch42,test total loss: 0.06911737583577633,  Spearman is [0.14773348836778494],
Epoch43,train total loss: 0.0026273367999611087,  Spearman:0.9155961896193711
Epoch43,val total loss: 0.008923042565584183,  Spearman:[0.7545045450053531]
Epoch43,test total loss: 0.07781439460813999,  Spearman is [0.15248015145372534],
Epoch44,train total loss: 0.0025559758318988127,  Spearman:0.9187472989956557
Epoch44,val total loss: 0.0068605681881308556,  Spearman:[0.7545045450053531]
Epoch44,test total loss: 0.08293757918290794,  Spearman is [0.15702285045198355],
Epoch45,train total loss: 0.002695050559943924,  Spearman:0.9142171871298732
Epoch45,val total loss: 0.006498190574347973,  Spearman:[0.8313253012048192]
Epoch45,test total loss: 0.08529117237776518,  Spearman is [0.15502441537131262],
Epoch46,train total loss: 0.002590465834565783,  Spearman:0.917511971466829
Epoch46,val total loss: 0.00776338716968894,  Spearman:[0.8263621207201486]
Epoch46,test total loss: 0.07331569329835474,  Spearman is [0.15292019068919263],
Epoch47,train total loss: 0.0025044772925097137,  Spearman:0.9220772490340674
Epoch47,val total loss: 0.006950029172003269,  Spearman:[0.8263621207201486]
Epoch47,test total loss: 0.07932927906513214,  Spearman is [0.15643820951661802],
Epoch48,train total loss: 0.0023515495905975024,  Spearman:0.9251874604528937
Epoch48,val total loss: 0.005725697614252567,  Spearman:[0.8263621207201486]
Epoch48,test total loss: 0.08656046926043928,  Spearman is [0.15617940739285183],
Epoch49,train total loss: 0.0026000072459096257,  Spearman:0.9148891122006655
Epoch49,val total loss: 0.006618726998567581,  Spearman:[0.8313253012048192]
Epoch49,test total loss: 0.06628842842765152,  Spearman is [0.15236608255170914],
Early stop at epoch 49
ensemble idx 0, best epoch 31, best validation spearman is 0.8503146459584139,best test spearman is [0.14040235513417956],

ensemble 1 models, fold 2, spearman is 0.14040235513417956, ndcg is 0.782962534612223
training on fold 3 
Epoch0,train total loss: 0.11810701654459803,  Spearman:0.06197233723147764
Epoch0,val total loss: 0.06933935731649399,  Spearman:[0.4523809523809524]
Epoch0,test total loss: 0.017192548559978604,  Spearman is [0.07490107312657372],
Epoch1,train total loss: 0.044393487310466856,  Spearman:0.5332898524934339
Epoch1,val total loss: 0.03189697861671448,  Spearman:[0.7857142857142858]
Epoch1,test total loss: 0.1863889966160059,  Spearman is [-0.025988688311890766],
Epoch2,train total loss: 0.029273120656561773,  Spearman:0.6254701346532683
Epoch2,val total loss: 0.026553619652986526,  Spearman:[0.7857142857142858]
Epoch2,test total loss: 0.352604853361845,  Spearman is [-0.02739894451938432],
Epoch3,train total loss: 0.026609087589746103,  Spearman:0.6442966956986996
Epoch3,val total loss: 0.025672199204564095,  Spearman:[0.7857142857142858]
Epoch3,test total loss: 0.44736150056123736,  Spearman is [-0.022349919272380607],
Epoch4,train total loss: 0.024453766784296393,  Spearman:0.6589337417468284
Epoch4,val total loss: 0.024545202031731606,  Spearman:[0.7857142857142858]
Epoch4,test total loss: 0.464242097735405,  Spearman is [0.012739841152708013],
Epoch5,train total loss: 0.018406839680093795,  Spearman:0.6961266064562408
Epoch5,val total loss: 0.018817977979779243,  Spearman:[0.7619047619047621]
Epoch5,test total loss: 0.09792559938505292,  Spearman is [0.11984171502969018],
Epoch6,train total loss: 0.015241610354934938,  Spearman:0.7409477614352157
Epoch6,val total loss: 0.016686972230672836,  Spearman:[0.7619047619047621]
Epoch6,test total loss: 0.09955758089199662,  Spearman is [0.16801022540310306],
Epoch7,train total loss: 0.013614792642422402,  Spearman:0.7598867848548586
Epoch7,val total loss: 0.021036013960838318,  Spearman:[0.7857142857142858]
Epoch7,test total loss: 0.13005083855241537,  Spearman is [0.15814404793371756],
Epoch8,train total loss: 0.012831597217322828,  Spearman:0.7684962936603043
Epoch8,val total loss: 0.024238554760813713,  Spearman:[0.7857142857142858]
Epoch8,test total loss: 0.0539884387049824,  Spearman is [0.17303413655251654],
Epoch9,train total loss: 0.012200462230397627,  Spearman:0.7755019426438006
Epoch9,val total loss: 0.02580387145280838,  Spearman:[0.7857142857142858]
Epoch9,test total loss: 0.08170980336144566,  Spearman is [0.15192715467588905],
Epoch10,train total loss: 0.011630170415931692,  Spearman:0.7812502982251724
Epoch10,val total loss: 0.02263643592596054,  Spearman:[0.7857142857142858]
Epoch10,test total loss: 0.09858049741014838,  Spearman is [0.16587806547967296],
Epoch11,train total loss: 0.011234295479833888,  Spearman:0.7851761381871004
Epoch11,val total loss: 0.02722901478409767,  Spearman:[0.7619047619047621]
Epoch11,test total loss: 0.1006196552887559,  Spearman is [0.16284909750576668],
Epoch12,train total loss: 0.010682090872134536,  Spearman:0.7917856744275472
Epoch12,val total loss: 0.020737119019031525,  Spearman:[0.7857142857142858]
Epoch12,test total loss: 0.10215994250029325,  Spearman is [0.1571589098076111],
Epoch13,train total loss: 0.01019352289268938,  Spearman:0.7938284044144994
Epoch13,val total loss: 0.023213446140289307,  Spearman:[0.8571428571428572]
Epoch13,test total loss: 0.07634639032185078,  Spearman is [0.16899774407472604],
Epoch14,train total loss: 0.009773429642873218,  Spearman:0.7998974278416995
Epoch14,val total loss: 0.019862305372953415,  Spearman:[0.7857142857142858]
Epoch14,test total loss: 0.12281233966350555,  Spearman is [0.16197182702636678],
Epoch15,train total loss: 0.009350532844949227,  Spearman:0.8049969557999694
Epoch15,val total loss: 0.018873486667871475,  Spearman:[0.9047619047619048]
Epoch15,test total loss: 0.13274874873459339,  Spearman is [0.16676665999050785],
Epoch16,train total loss: 0.008910181236644395,  Spearman:0.8065693341194557
Epoch16,val total loss: 0.030595310032367706,  Spearman:[0.8571428571428572]
Epoch16,test total loss: 0.10916491579264402,  Spearman is [0.1637546254550134],
Epoch17,train total loss: 0.008618872270931322,  Spearman:0.8101896742667183
Epoch17,val total loss: 0.02131284400820732,  Spearman:[0.9047619047619048]
Epoch17,test total loss: 0.13117345459759236,  Spearman is [0.1718156852375116],
Epoch18,train total loss: 0.008310131567458693,  Spearman:0.8143714054745597
Epoch18,val total loss: 0.02159084379673004,  Spearman:[0.880952380952381]
Epoch18,test total loss: 0.17032761722803116,  Spearman is [0.16462263021995804],
Epoch19,train total loss: 0.008150108228736103,  Spearman:0.8184805162051572
Epoch19,val total loss: 0.031748272478580475,  Spearman:[0.880952380952381]
Epoch19,test total loss: 0.1250772537663579,  Spearman is [0.16129471307704116],
Epoch20,train total loss: 0.007768162846332416,  Spearman:0.8223173578106919
Epoch20,val total loss: 0.023090334609150887,  Spearman:[0.8571428571428572]
Epoch20,test total loss: 0.14391091875731946,  Spearman is [0.16272042310211446],
Epoch21,train total loss: 0.007395534957490431,  Spearman:0.8312923333550797
Epoch21,val total loss: 0.04246757924556732,  Spearman:[0.8095238095238096]
Epoch21,test total loss: 0.11238159649074078,  Spearman is [0.16577536006564728],
Epoch22,train total loss: 0.00748942462199081,  Spearman:0.8264682564888612
Epoch22,val total loss: 0.03217219561338425,  Spearman:[0.7142857142857144]
Epoch22,test total loss: 0.1382540062069893,  Spearman is [0.15396172538532624],
Epoch23,train total loss: 0.007006198261082411,  Spearman:0.8265588588597447
Epoch23,val total loss: 0.034077540040016174,  Spearman:[0.8571428571428572]
Epoch23,test total loss: 0.1238130945712328,  Spearman is [0.16509159768671608],
Epoch24,train total loss: 0.006555345457178565,  Spearman:0.828509347566852
Epoch24,val total loss: 0.022929150611162186,  Spearman:[0.8333333333333335]
Epoch24,test total loss: 0.1559345591813326,  Spearman is [0.16827324280221762],
Epoch25,train total loss: 0.005542784644207224,  Spearman:0.8344637435144535
Epoch25,val total loss: 0.030164215713739395,  Spearman:[0.880952380952381]
Epoch25,test total loss: 0.12802228033542634,  Spearman is [0.16227121021748814],
Epoch26,train total loss: 0.005078076181981044,  Spearman:0.8323809331985207
Epoch26,val total loss: 0.028238192200660706,  Spearman:[0.9285714285714287]
Epoch26,test total loss: 0.14982071928679944,  Spearman is [0.16547072257654885],
Epoch27,train total loss: 0.004734432191187994,  Spearman:0.8393161306865577
Epoch27,val total loss: 0.03680269420146942,  Spearman:[0.9047619047619048]
Epoch27,test total loss: 0.12464842051267624,  Spearman is [0.16223928328797763],
Epoch28,train total loss: 0.004393808093692104,  Spearman:0.8432553035498778
Epoch28,val total loss: 0.044849470257759094,  Spearman:[0.8333333333333335]
Epoch28,test total loss: 0.12254694309085608,  Spearman is [0.1652015894113283],
Epoch29,train total loss: 0.004290649736783682,  Spearman:0.8464475592193389
Epoch29,val total loss: 0.03884914889931679,  Spearman:[0.8333333333333335]
Epoch29,test total loss: 0.12419957034289837,  Spearman is [0.16618927248526597],
Epoch30,train total loss: 0.004231851441615548,  Spearman:0.845131027777063
Epoch30,val total loss: 0.03422204777598381,  Spearman:[0.880952380952381]
Epoch30,test total loss: 0.12111912090331316,  Spearman is [0.1668962090144742],
Epoch31,train total loss: 0.003938512020305587,  Spearman:0.8557170772253229
Epoch31,val total loss: 0.025156622752547264,  Spearman:[0.880952380952381]
Epoch31,test total loss: 0.11613095086067915,  Spearman is [0.16230044752513045],
Epoch32,train total loss: 0.004015371049694621,  Spearman:0.8520028355697724
Epoch32,val total loss: 0.0546300895512104,  Spearman:[0.8333333333333335]
Epoch32,test total loss: 0.1030582308769226,  Spearman is [0.1694474304380186],
Epoch33,train total loss: 0.0038273744128393726,  Spearman:0.8576323120771834
Epoch33,val total loss: 0.03917640447616577,  Spearman:[0.880952380952381]
Epoch33,test total loss: 0.1109177976846695,  Spearman is [0.1703560557268739],
Epoch34,train total loss: 0.003574945240054662,  Spearman:0.8617463780843683
Epoch34,val total loss: 0.02493968978524208,  Spearman:[0.880952380952381]
Epoch34,test total loss: 0.11382067427039147,  Spearman is [0.17104016663871227],
Epoch35,train total loss: 0.003685590545781172,  Spearman:0.8602353488520247
Epoch35,val total loss: 0.04131848365068436,  Spearman:[0.880952380952381]
Epoch35,test total loss: 0.10194673277437687,  Spearman is [0.16833188839590954],
Epoch36,train total loss: 0.0035454372678381894,  Spearman:0.8667661457945568
Epoch36,val total loss: 0.038497429341077805,  Spearman:[0.880952380952381]
Epoch36,test total loss: 0.10626676455140113,  Spearman is [0.17100331421585402],
Epoch37,train total loss: 0.00331706458177322,  Spearman:0.8744119785585902
Epoch37,val total loss: 0.040608979761600494,  Spearman:[0.8333333333333335]
Epoch37,test total loss: 0.10157576110213995,  Spearman is [0.17171171063761662],
Epoch38,train total loss: 0.003214246275512358,  Spearman:0.8758578613704318
Epoch38,val total loss: 0.03781718388199806,  Spearman:[0.880952380952381]
Epoch38,test total loss: 0.08962429091334342,  Spearman is [0.1771513426321102],
Epoch39,train total loss: 0.0033159184311397183,  Spearman:0.8757464651822761
Epoch39,val total loss: 0.03385855257511139,  Spearman:[0.880952380952381]
Epoch39,test total loss: 0.0825500413775444,  Spearman is [0.17631760588563705],
Epoch40,train total loss: 0.0031707222216750663,  Spearman:0.8815222951394641
Epoch40,val total loss: 0.06294333934783936,  Spearman:[0.880952380952381]
Epoch40,test total loss: 0.07965244352817535,  Spearman is [0.17401560521895937],
Epoch41,train total loss: 0.0031470861576963216,  Spearman:0.8815661262841085
Epoch41,val total loss: 0.04655544087290764,  Spearman:[0.8333333333333335]
Epoch41,test total loss: 0.08216614034026862,  Spearman is [0.17314629181158991],
Epoch42,train total loss: 0.0030576741175117115,  Spearman:0.8841387046607385
Epoch42,val total loss: 0.04042081907391548,  Spearman:[0.8333333333333335]
Epoch42,test total loss: 0.07177531346678734,  Spearman is [0.17936757132317405],
Epoch43,train total loss: 0.0030167307950950298,  Spearman:0.8877497909753138
Epoch43,val total loss: 0.03728216513991356,  Spearman:[0.8333333333333335]
Epoch43,test total loss: 0.07088855225592852,  Spearman is [0.18502572687433774],
Epoch44,train total loss: 0.002878696123587314,  Spearman:0.8923470573522299
Epoch44,val total loss: 0.04021437093615532,  Spearman:[0.8333333333333335]
Epoch44,test total loss: 0.07249862030148506,  Spearman is [0.18232240730508797],
Epoch45,train total loss: 0.003028884926327289,  Spearman:0.8879359525047213
Epoch45,val total loss: 0.049959950149059296,  Spearman:[0.8333333333333335]
Epoch45,test total loss: 0.06704828664660453,  Spearman is [0.18385827315734588],
Epoch46,train total loss: 0.002897610088276008,  Spearman:0.8931517216472973
Epoch46,val total loss: 0.030402623116970062,  Spearman:[0.8333333333333335]
Epoch46,test total loss: 0.06477559804916382,  Spearman is [0.18725259568320754],
Epoch47,train total loss: 0.002947162434560223,  Spearman:0.8934387883281397
Epoch47,val total loss: 0.038911670446395874,  Spearman:[0.8333333333333335]
Epoch47,test total loss: 0.06440027058124542,  Spearman is [0.17910619137111372],
Epoch48,train total loss: 0.0028648641389923003,  Spearman:0.8951033034638514
Epoch48,val total loss: 0.04210279881954193,  Spearman:[0.8333333333333335]
Epoch48,test total loss: 0.06399463256821036,  Spearman is [0.17985852266745084],
Epoch49,train total loss: 0.0027393976691737175,  Spearman:0.9004364426580861
Epoch49,val total loss: 0.045328687876462936,  Spearman:[0.8333333333333335]
Epoch49,test total loss: 0.0617257040925324,  Spearman is [0.17890772489683435],
Early stop at epoch 49
ensemble idx 0, best epoch 26, best validation spearman is 0.9285714285714287,best test spearman is [0.16547072257654885],

ensemble 1 models, fold 3, spearman is 0.16547072257654885, ndcg is 0.669284580541666
training on fold 4 
Epoch0,train total loss: 0.10189191684222375,  Spearman:0.05764807317078248
Epoch0,val total loss: 0.13164985179901123,  Spearman:[0.4523809523809524]
Epoch0,test total loss: 0.08524579955264926,  Spearman is [0.0530460409898833],
Epoch1,train total loss: 0.044968772906427965,  Spearman:0.5579892470650255
Epoch1,val total loss: 0.0582374632358551,  Spearman:[0.7619047619047621]
Epoch1,test total loss: 0.1026459977030754,  Spearman is [-0.048919240391205036],
Epoch2,train total loss: 0.031195273843761057,  Spearman:0.647088007845099
Epoch2,val total loss: 0.022686399519443512,  Spearman:[0.880952380952381]
Epoch2,test total loss: 0.40675060376524924,  Spearman is [-0.013423675868657687],
Epoch3,train total loss: 0.02707941788666619,  Spearman:0.6654436817639182
Epoch3,val total loss: 0.03324153274297714,  Spearman:[0.8333333333333335]
Epoch3,test total loss: 0.4608313888311386,  Spearman is [-0.018737158679052523],
Epoch4,train total loss: 0.022366207290010955,  Spearman:0.6946012752797021
Epoch4,val total loss: 0.008478711359202862,  Spearman:[0.8095238095238096]
Epoch4,test total loss: 0.337262524291873,  Spearman is [0.077186850572839],
Epoch5,train total loss: 0.016994731942526042,  Spearman:0.7457502977257626
Epoch5,val total loss: 0.007749962154775858,  Spearman:[0.8095238095238096]
Epoch5,test total loss: 0.19995193798094987,  Spearman is [0.09754364495931274],
Epoch6,train total loss: 0.015140238370244892,  Spearman:0.7684603427986813
Epoch6,val total loss: 0.006969098001718521,  Spearman:[0.7380952380952381]
Epoch6,test total loss: 0.19366348758339882,  Spearman is [0.09887047028015347],
Epoch7,train total loss: 0.01412256373367153,  Spearman:0.7828629410365477
Epoch7,val total loss: 0.00736309913918376,  Spearman:[0.8333333333333335]
Epoch7,test total loss: 0.20891223326325417,  Spearman is [0.09715910136918818],
Epoch8,train total loss: 0.013408056652853982,  Spearman:0.7931541587499101
Epoch8,val total loss: 0.00565398158505559,  Spearman:[0.8095238095238096]
Epoch8,test total loss: 0.213974723033607,  Spearman is [0.11498256130395447],
Epoch9,train total loss: 0.0125560964926337,  Spearman:0.8038708325283282
Epoch9,val total loss: 0.006400479469448328,  Spearman:[0.8095238095238096]
Epoch9,test total loss: 0.1843851126730442,  Spearman is [0.11820835830508591],
Epoch10,train total loss: 0.012085933818852004,  Spearman:0.8130168220356556
Epoch10,val total loss: 0.006713381968438625,  Spearman:[0.8333333333333335]
Epoch10,test total loss: 0.1865815430879593,  Spearman is [0.11089555921761346],
Epoch11,train total loss: 0.011354930948119802,  Spearman:0.8200156147029874
Epoch11,val total loss: 0.00845227763056755,  Spearman:[0.8333333333333335]
Epoch11,test total loss: 0.19813977964222432,  Spearman is [0.11033955716546485],
Epoch12,train total loss: 0.010987616214268386,  Spearman:0.8202514685889576
Epoch12,val total loss: 0.008173029869794846,  Spearman:[0.8333333333333335]
Epoch12,test total loss: 0.20921033900231123,  Spearman is [0.10729291265468437],
Epoch13,train total loss: 0.010410700675446348,  Spearman:0.8302446618365348
Epoch13,val total loss: 0.01095056813210249,  Spearman:[0.7619047619047621]
Epoch13,test total loss: 0.18482240084558726,  Spearman is [0.0953528920509314],
Epoch14,train total loss: 0.010251759700715924,  Spearman:0.8326371427933658
Epoch14,val total loss: 0.011166637763381004,  Spearman:[0.8333333333333335]
Epoch14,test total loss: 0.18507114350795745,  Spearman is [0.10833638072203859],
Epoch15,train total loss: 0.009990947485232774,  Spearman:0.8355647666627806
Epoch15,val total loss: 0.008561959490180016,  Spearman:[0.8333333333333335]
Epoch15,test total loss: 0.21081086061894894,  Spearman is [0.09255558666668426],
Epoch16,train total loss: 0.009324261330617353,  Spearman:0.8415615441737474
Epoch16,val total loss: 0.013135982677340508,  Spearman:[0.8333333333333335]
Epoch16,test total loss: 0.21946095749735833,  Spearman is [0.06680610043460378],
Epoch17,train total loss: 0.008965128937210793,  Spearman:0.8431163995993209
Epoch17,val total loss: 0.012831933796405792,  Spearman:[0.7619047619047621]
Epoch17,test total loss: 0.20151685187593102,  Spearman is [0.07510989037058521],
Epoch18,train total loss: 0.008781516305111254,  Spearman:0.8483691918179923
Epoch18,val total loss: 0.012281149625778198,  Spearman:[0.7619047619047621]
Epoch18,test total loss: 0.20921388622373344,  Spearman is [0.08724689125169284],
Epoch19,train total loss: 0.008359988052129315,  Spearman:0.8528826873721455
Epoch19,val total loss: 0.01601298525929451,  Spearman:[0.7619047619047621]
Epoch19,test total loss: 0.2005793617106974,  Spearman is [0.07486877135978579],
Epoch20,train total loss: 0.00813461732543193,  Spearman:0.853263094039902
Epoch20,val total loss: 0.01309443823993206,  Spearman:[0.7619047619047621]
Epoch20,test total loss: 0.25602929703891275,  Spearman is [0.06917405273383771],
Epoch21,train total loss: 0.007889308971173774,  Spearman:0.8571802884336354
Epoch21,val total loss: 0.014620079658925533,  Spearman:[0.8333333333333335]
Epoch21,test total loss: 0.23734423667192459,  Spearman is [0.07975752407825615],
Epoch22,train total loss: 0.007725542861944399,  Spearman:0.8608636460799486
Epoch22,val total loss: 0.018391892313957214,  Spearman:[0.7857142857142858]
Epoch22,test total loss: 0.25006802482530477,  Spearman is [0.07607956152692674],
Epoch23,train total loss: 0.007503397236667717,  Spearman:0.8617253820171908
Epoch23,val total loss: 0.015979476273059845,  Spearman:[0.7857142857142858]
Epoch23,test total loss: 0.18557322276756166,  Spearman is [0.08857151358151688],
Epoch24,train total loss: 0.007371587282530247,  Spearman:0.8650103459313123
Epoch24,val total loss: 0.018943093717098236,  Spearman:[0.7857142857142858]
Epoch24,test total loss: 0.16588022820651532,  Spearman is [0.07901196615728374],
Epoch25,train total loss: 0.007025326450671762,  Spearman:0.8694583166219487
Epoch25,val total loss: 0.013549769297242165,  Spearman:[0.7619047619047621]
Epoch25,test total loss: 0.22797082010656594,  Spearman is [0.08546079820066006],
Epoch26,train total loss: 0.007006370622921401,  Spearman:0.8697273350709989
Epoch26,val total loss: 0.014240702614188194,  Spearman:[0.8333333333333335]
Epoch26,test total loss: 0.20426584053784608,  Spearman is [0.08605980132223587],
Epoch27,train total loss: 0.006416620947092246,  Spearman:0.8781230294148133
Epoch27,val total loss: 0.01519404724240303,  Spearman:[0.8333333333333335]
Epoch27,test total loss: 0.18200465580448508,  Spearman is [0.093952460525763],
Epoch28,train total loss: 0.00643138636279708,  Spearman:0.8811611471992058
Epoch28,val total loss: 0.014548009261488914,  Spearman:[0.7142857142857144]
Epoch28,test total loss: 0.17785597443580628,  Spearman is [0.09543379114193817],
Epoch29,train total loss: 0.006188579343963796,  Spearman:0.8849632333632603
Epoch29,val total loss: 0.015132769010961056,  Spearman:[0.7142857142857144]
Epoch29,test total loss: 0.21891961079090833,  Spearman is [0.08374972521386119],
Epoch30,train total loss: 0.006091633613836259,  Spearman:0.8878728025369071
Epoch30,val total loss: 0.0156722255051136,  Spearman:[0.7142857142857144]
Epoch30,test total loss: 0.18267767149955033,  Spearman is [0.0903150001286777],
Epoch31,train total loss: 0.005931100527493236,  Spearman:0.8907923315914766
Epoch31,val total loss: 0.014958796091377735,  Spearman:[0.7619047619047621]
Epoch31,test total loss: 0.18362689930945636,  Spearman is [0.08962476029854816],
Epoch32,train total loss: 0.005899866142919144,  Spearman:0.891677187134017
Epoch32,val total loss: 0.013428619131445885,  Spearman:[0.7619047619047621]
Epoch32,test total loss: 0.19414448253810407,  Spearman is [0.0942052323726268],
Epoch33,train total loss: 0.005862869840945141,  Spearman:0.8933685823810674
Epoch33,val total loss: 0.01777687296271324,  Spearman:[0.7619047619047621]
Epoch33,test total loss: 0.13972921455278992,  Spearman is [0.09628260029262098],
Epoch34,train total loss: 0.005685419513984249,  Spearman:0.8946022622848288
Epoch34,val total loss: 0.016061805188655853,  Spearman:[0.7619047619047621]
Epoch34,test total loss: 0.1484017248265445,  Spearman is [0.09309083457062789],
Epoch35,train total loss: 0.005760527078587658,  Spearman:0.8925458308644351
Epoch35,val total loss: 0.018392952159047127,  Spearman:[0.7619047619047621]
Epoch35,test total loss: 0.17657941449433565,  Spearman is [0.09082896122091683],
Epoch36,train total loss: 0.005621010733869834,  Spearman:0.8954677391269353
Epoch36,val total loss: 0.013513370417058468,  Spearman:[0.7619047619047621]
Epoch36,test total loss: 0.16265727560967208,  Spearman is [0.09000325388349258],
Epoch37,train total loss: 0.005479028840244819,  Spearman:0.8970941805064141
Epoch37,val total loss: 0.014920518733561039,  Spearman:[0.7619047619047621]
Epoch37,test total loss: 0.18863501492887735,  Spearman is [0.08564542200004353],
Epoch38,train total loss: 0.005185136184967958,  Spearman:0.9000659622672631
Epoch38,val total loss: 0.012619801796972752,  Spearman:[0.7619047619047621]
Epoch38,test total loss: 0.20216776579618453,  Spearman is [0.09435825491421003],
Epoch39,train total loss: 0.004917390305005635,  Spearman:0.8971861902417646
Epoch39,val total loss: 0.010009799152612686,  Spearman:[0.8333333333333335]
Epoch39,test total loss: 0.22228051740676164,  Spearman is [0.09541010405643938],
Epoch40,train total loss: 0.00448381728776253,  Spearman:0.9007215865448671
Epoch40,val total loss: 0.009457053616642952,  Spearman:[0.7619047619047621]
Epoch40,test total loss: 0.19848268218338488,  Spearman is [0.09508177948184213],
Epoch41,train total loss: 0.004586284701079608,  Spearman:0.8983782215571072
Epoch41,val total loss: 0.006411188282072544,  Spearman:[0.7619047619047621]
Epoch41,test total loss: 0.20276168044656515,  Spearman is [0.09279121464017343],
Epoch42,train total loss: 0.004127112469480683,  Spearman:0.9029239361093793
Epoch42,val total loss: 0.006199946161359549,  Spearman:[0.8333333333333335]
Epoch42,test total loss: 0.18434748165309428,  Spearman is [0.10181532033311835],
Epoch43,train total loss: 0.004003734753216402,  Spearman:0.9058211134281989
Epoch43,val total loss: 0.007089774124324322,  Spearman:[0.8333333333333335]
Epoch43,test total loss: 0.18704909896478056,  Spearman is [0.0972362060547722],
Epoch44,train total loss: 0.003931665563588747,  Spearman:0.9050897086736649
Epoch44,val total loss: 0.004683472216129303,  Spearman:[0.8333333333333335]
Epoch44,test total loss: 0.19238488487899302,  Spearman is [0.09808942118748837],
Epoch45,train total loss: 0.004050811535144487,  Spearman:0.9019062805763385
Epoch45,val total loss: 0.0037893352564424276,  Spearman:[0.9047619047619048]
Epoch45,test total loss: 0.1909749730490148,  Spearman is [0.10235511543769925],
Epoch46,train total loss: 0.003833169500397232,  Spearman:0.9047460246099182
Epoch46,val total loss: 0.0046808454208076,  Spearman:[0.7619047619047621]
Epoch46,test total loss: 0.1977742807008326,  Spearman is [0.09703026913931385],
Epoch47,train total loss: 0.003952756615875002,  Spearman:0.904182925066817
Epoch47,val total loss: 0.003807698143646121,  Spearman:[0.9047619047619048]
Epoch47,test total loss: 0.20279015135020018,  Spearman is [0.09682183988476502],
Epoch48,train total loss: 0.00376026322453235,  Spearman:0.9056242271661747
Epoch48,val total loss: 0.00287830363959074,  Spearman:[0.9047619047619048]
Epoch48,test total loss: 0.19379556272178888,  Spearman is [0.10503777979987511],
Epoch49,train total loss: 0.0035348468059405256,  Spearman:0.9107730522365665
Epoch49,val total loss: 0.003557118121534586,  Spearman:[0.8333333333333335]
Epoch49,test total loss: 0.1714683324098587,  Spearman is [0.10245120530258228],
Early stop at epoch 49
ensemble idx 0, best epoch 45, best validation spearman is 0.9047619047619048,best test spearman is [0.10235977131125093],

ensemble 1 models, fold 4, spearman is 0.10235977131125093, ndcg is 0.777309822486676
ensemble 5 fold, for test dataset SaCas9-mean-2,spearman is 0.14152674202081833, ndcg is 0.8033000902410525
