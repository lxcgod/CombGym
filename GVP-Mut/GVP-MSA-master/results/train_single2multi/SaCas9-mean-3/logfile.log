training on fold 0 
Epoch0,train total loss: 0.05242349816342959,  Spearman:0.09399549064555097
Epoch0,val total loss: 0.0686386451125145,  Spearman:[0.2745299145299145]
Epoch0,test total loss: 0.03571741107632132,  Spearman is [0.053949054035031585],
Epoch1,train total loss: 0.025963481238040213,  Spearman:0.27490136812663046
Epoch1,val total loss: 0.014925003983080387,  Spearman:[0.26700854700854704]
Epoch1,test total loss: 0.03522715892861871,  Spearman is [-0.014096452826066893],
Epoch2,train total loss: 0.022177868695834126,  Spearman:0.30887795024504117
Epoch2,val total loss: 0.017205987125635147,  Spearman:[0.31487179487179484]
Epoch2,test total loss: 0.050778104868881846,  Spearman is [0.0037460110819085702],
Epoch3,train total loss: 0.02017985444324903,  Spearman:0.3339327469287226
Epoch3,val total loss: 0.012013273313641548,  Spearman:[0.28683760683760684]
Epoch3,test total loss: 0.10493153377490885,  Spearman is [0.02716658969504702],
Epoch4,train total loss: 0.01623703564893311,  Spearman:0.42930647429816476
Epoch4,val total loss: 0.01262825820595026,  Spearman:[0.30735042735042734]
Epoch4,test total loss: 0.060314125052708036,  Spearman is [0.13502523039765185],
Epoch5,train total loss: 0.013370016500210533,  Spearman:0.5173002779198033
Epoch5,val total loss: 0.012131303548812866,  Spearman:[0.24376068376068374]
Epoch5,test total loss: 0.013112739303751904,  Spearman is [0.17409192081403582],
Epoch6,train total loss: 0.012220911295093501,  Spearman:0.5512116191569745
Epoch6,val total loss: 0.012922147288918495,  Spearman:[0.2656410256410256]
Epoch6,test total loss: 0.00869953936404165,  Spearman is [0.14164585212048347],
Epoch7,train total loss: 0.011604837159841107,  Spearman:0.5588190637981656
Epoch7,val total loss: 0.013202883303165436,  Spearman:[0.28683760683760684]
Epoch7,test total loss: 0.007878803291960675,  Spearman is [0.18896750147608857],
Epoch8,train total loss: 0.011194213568113552,  Spearman:0.568274476310459
Epoch8,val total loss: 0.00992471445351839,  Spearman:[0.24786324786324784]
Epoch8,test total loss: 0.015203440972768208,  Spearman is [0.16417979913443426],
Epoch9,train total loss: 0.011137474287981885,  Spearman:0.5737176081731522
Epoch9,val total loss: 0.011216860264539719,  Spearman:[0.20068376068376068]
Epoch9,test total loss: 0.028298784485634637,  Spearman is [0.15930105551449042],
Epoch10,train total loss: 0.0107756578661979,  Spearman:0.58615062120314
Epoch10,val total loss: 0.010356903076171875,  Spearman:[0.2547008547008547]
Epoch10,test total loss: 0.02825427636065904,  Spearman is [0.15197348955396311],
Epoch11,train total loss: 0.010533424171929559,  Spearman:0.5837737153960614
Epoch11,val total loss: 0.011886290274560452,  Spearman:[0.24034188034188034]
Epoch11,test total loss: 0.010934543302830528,  Spearman is [0.16590624455265343],
Epoch12,train total loss: 0.01030028546646906,  Spearman:0.5966627590111298
Epoch12,val total loss: 0.010239091701805592,  Spearman:[0.2505982905982906]
Epoch12,test total loss: 0.020190962056136307,  Spearman is [0.15622356605844795],
Epoch13,train total loss: 0.010260812865080645,  Spearman:0.5948733551346413
Epoch13,val total loss: 0.009560512378811836,  Spearman:[0.22188034188034186]
Epoch13,test total loss: 0.02075267950182452,  Spearman is [0.14430727427652912],
Epoch14,train total loss: 0.009908641006451292,  Spearman:0.6063832765211273
Epoch14,val total loss: 0.010166856460273266,  Spearman:[0.24444444444444444]
Epoch14,test total loss: 0.02396291173884974,  Spearman is [0.14911970508235056],
Epoch15,train total loss: 0.009850840755881598,  Spearman:0.6122807329252872
Epoch15,val total loss: 0.010812278836965561,  Spearman:[0.22188034188034186]
Epoch15,test total loss: 0.024311441613142106,  Spearman is [0.14300629365563766],
Epoch16,train total loss: 0.009745404586936228,  Spearman:0.6112039267578645
Epoch16,val total loss: 0.009953551925718784,  Spearman:[0.21162393162393162]
Epoch16,test total loss: 0.020512567545451662,  Spearman is [0.1423918818860168],
Epoch17,train total loss: 0.009636445982883183,  Spearman:0.6121270935017007
Epoch17,val total loss: 0.009690198116004467,  Spearman:[0.27384615384615385]
Epoch17,test total loss: 0.028548657099771148,  Spearman is [0.12869106263691302],
Epoch18,train total loss: 0.00929124337227012,  Spearman:0.620071241589484
Epoch18,val total loss: 0.009942710399627686,  Spearman:[0.20820512820512818]
Epoch18,test total loss: 0.023697156568660456,  Spearman is [0.1496104220281877],
Epoch19,train total loss: 0.009150765621318268,  Spearman:0.6243679606639396
Epoch19,val total loss: 0.008954675868153572,  Spearman:[0.26427350427350427]
Epoch19,test total loss: 0.021862541928010827,  Spearman is [0.1368501692246907],
Epoch20,train total loss: 0.009043038131681103,  Spearman:0.6247159360682377
Epoch20,val total loss: 0.010090360417962074,  Spearman:[0.19589743589743588]
Epoch20,test total loss: 0.02340491843300269,  Spearman is [0.13477081914372666],
Epoch21,train total loss: 0.008873196154570159,  Spearman:0.6271877436448767
Epoch21,val total loss: 0.010499690659344196,  Spearman:[0.25196581196581197]
Epoch21,test total loss: 0.03525810524383012,  Spearman is [0.1341111487724007],
Epoch22,train total loss: 0.008637683254887518,  Spearman:0.6247470592418618
Epoch22,val total loss: 0.008758087642490864,  Spearman:[0.28683760683760684]
Epoch22,test total loss: 0.021852666786050096,  Spearman is [0.11593292055798583],
Epoch23,train total loss: 0.008779834926080627,  Spearman:0.6248998752032217
Epoch23,val total loss: 0.010852077044546604,  Spearman:[0.23282051282051283]
Epoch23,test total loss: 0.03017638289533994,  Spearman is [0.14076220099166825],
Epoch24,train total loss: 0.008280358157860927,  Spearman:0.6345862124393054
Epoch24,val total loss: 0.010782518424093723,  Spearman:[0.228034188034188]
Epoch24,test total loss: 0.02108137573882499,  Spearman is [0.14304314117903197],
Epoch25,train total loss: 0.008342783815281179,  Spearman:0.6390786351245605
Epoch25,val total loss: 0.010059833526611328,  Spearman:[0.2608547008547008]
Epoch25,test total loss: 0.02830457191585618,  Spearman is [0.14768495331435227],
Epoch26,train total loss: 0.008187987592417555,  Spearman:0.6419009835974273
Epoch26,val total loss: 0.010801313444972038,  Spearman:[0.20683760683760682]
Epoch26,test total loss: 0.020610963117659968,  Spearman is [0.12815045198064212],
Epoch27,train total loss: 0.008073955252677059,  Spearman:0.6418333567917637
Epoch27,val total loss: 0.009037037380039692,  Spearman:[0.2629059829059829]
Epoch27,test total loss: 0.02666359397527926,  Spearman is [0.1342285008158189],
Epoch28,train total loss: 0.00803755109723753,  Spearman:0.6472744252273168
Epoch28,val total loss: 0.00898685958236456,  Spearman:[0.2417094017094017]
Epoch28,test total loss: 0.022036847699543134,  Spearman is [0.1361523785312349],
Epoch29,train total loss: 0.007937458538575672,  Spearman:0.6481532448381636
Epoch29,val total loss: 0.012637490406632423,  Spearman:[0.1863247863247863]
Epoch29,test total loss: 0.02221626487067517,  Spearman is [0.14109221649048542],
Epoch30,train total loss: 0.007667172901654759,  Spearman:0.6550441375316426
Epoch30,val total loss: 0.012627665884792805,  Spearman:[0.2246153846153846]
Epoch30,test total loss: 0.026515653028207666,  Spearman is [0.13010227823495973],
Epoch31,train total loss: 0.007632655528887438,  Spearman:0.6619952253598393
Epoch31,val total loss: 0.010701251216232777,  Spearman:[0.22940170940170937]
Epoch31,test total loss: 0.03423054987455115,  Spearman is [0.14453855241343563],
Epoch32,train total loss: 0.0076248132958053015,  Spearman:0.6626860831886743
Epoch32,val total loss: 0.011268246918916702,  Spearman:[0.20478632478632477]
Epoch32,test total loss: 0.0336806286838563,  Spearman is [0.13672719565352384],
Epoch33,train total loss: 0.007312273481287635,  Spearman:0.6663105931026113
Epoch33,val total loss: 0.008815685287117958,  Spearman:[0.20820512820512818]
Epoch33,test total loss: 0.020000016919391995,  Spearman is [0.11309930994633186],
Epoch34,train total loss: 0.007311414389196449,  Spearman:0.6611494634538571
Epoch34,val total loss: 0.010265369899570942,  Spearman:[0.21094017094017092]
Epoch34,test total loss: 0.02296146929866689,  Spearman is [0.13453576503723802],
Epoch35,train total loss: 0.006867661393092324,  Spearman:0.6740262348760991
Epoch35,val total loss: 0.009858896024525166,  Spearman:[0.2458119658119658]
Epoch35,test total loss: 0.01558266834848944,  Spearman is [0.12916437406004144],
Epoch36,train total loss: 0.006432297185081272,  Spearman:0.6820021963475058
Epoch36,val total loss: 0.010913200676441193,  Spearman:[0.2588034188034188]
Epoch36,test total loss: 0.015615697354352212,  Spearman is [0.13509124622540264],
Epoch37,train total loss: 0.005502775074908128,  Spearman:0.6947336693694425
Epoch37,val total loss: 0.011617593467235565,  Spearman:[0.23076923076923075]
Epoch37,test total loss: 0.016450921196819228,  Spearman is [0.13953733373516294],
Epoch38,train total loss: 0.004284671160768574,  Spearman:0.7037482194085315
Epoch38,val total loss: 0.010488614439964294,  Spearman:[0.22188034188034186]
Epoch38,test total loss: 0.0183353905346902,  Spearman is [0.16743318937573046],
Epoch39,train total loss: 0.0035189795169758443,  Spearman:0.7060620867924133
Epoch39,val total loss: 0.009746121242642403,  Spearman:[0.13777777777777778]
Epoch39,test total loss: 0.012931946843095562,  Spearman is [0.15461607428872254],
Epoch40,train total loss: 0.0031313285327110537,  Spearman:0.7118786455201077
Epoch40,val total loss: 0.008954274468123913,  Spearman:[0.1569230769230769]
Epoch40,test total loss: 0.01616023834246923,  Spearman is [0.16306202728486982],
Epoch41,train total loss: 0.0028228705330268266,  Spearman:0.7295042615439821
Epoch41,val total loss: 0.00964516680687666,  Spearman:[0.1323076923076923]
Epoch41,test total loss: 0.012507180464180076,  Spearman is [0.16646255305999616],
Epoch42,train total loss: 0.0026610694241333897,  Spearman:0.7380328263949831
Epoch42,val total loss: 0.010854536667466164,  Spearman:[0.08786324786324784]
Epoch42,test total loss: 0.01457023196031942,  Spearman is [0.15263533428979564],
Epoch43,train total loss: 0.002863178133012321,  Spearman:0.7219328849983954
Epoch43,val total loss: 0.01074034720659256,  Spearman:[0.07487179487179485]
Epoch43,test total loss: 0.014452154124977397,  Spearman is [0.16866128105569914],
Epoch44,train total loss: 0.0026392374409344764,  Spearman:0.7424740126147011
Epoch44,val total loss: 0.008992447517812252,  Spearman:[0.04957264957264957]
Epoch44,test total loss: 0.015103934757301913,  Spearman is [0.1544713464658338],
Epoch45,train total loss: 0.0025940426746204207,  Spearman:0.741298483557381
Epoch45,val total loss: 0.009278197772800922,  Spearman:[0.12478632478632476]
Epoch45,test total loss: 0.015299082336509052,  Spearman is [0.15337772597227647],
Epoch46,train total loss: 0.0025904328716793456,  Spearman:0.74455823675133
Epoch46,val total loss: 0.009571120142936707,  Spearman:[0.08512820512820513]
Epoch46,test total loss: 0.019787492477061117,  Spearman is [0.16792828687054911],
Epoch47,train total loss: 0.0024493120451016016,  Spearman:0.7542649892474569
Epoch47,val total loss: 0.008739585988223553,  Spearman:[0.12615384615384614]
Epoch47,test total loss: 0.012181853882365805,  Spearman is [0.15298450581524642],
Epoch48,train total loss: 0.002531858060720902,  Spearman:0.7465106057829561
Epoch48,val total loss: 0.01006500143557787,  Spearman:[0.03521367521367521]
Epoch48,test total loss: 0.016372968319474775,  Spearman is [0.14962601381269824],
Epoch49,train total loss: 0.002435636666725772,  Spearman:0.7589898485736235
Epoch49,val total loss: 0.009478084743022919,  Spearman:[0.03658119658119658]
Epoch49,test total loss: 0.016689724343664506,  Spearman is [0.1565656095053161],
Early stop at epoch 49
ensemble idx 0, best epoch 2, best validation spearman is 0.31487179487179484,best test spearman is [0.0037482650062752552],

ensemble 1 models, fold 0, spearman is 0.0037482650062752552, ndcg is 0.7366202420820122
training on fold 1 
Epoch0,train total loss: 0.05669400241608039,  Spearman:0.043164191779757236
Epoch0,val total loss: 0.04075707495212555,  Spearman:[0.38502308649573985]
Epoch0,test total loss: 0.011621955973917948,  Spearman is [0.045578334171670176],
Epoch1,train total loss: 0.02545658345274532,  Spearman:0.2443876853812707
Epoch1,val total loss: 0.0458713136613369,  Spearman:[0.25645409846519085]
Epoch1,test total loss: 0.010939431212404194,  Spearman is [-0.0255495307214927],
Epoch2,train total loss: 0.021922866240716897,  Spearman:0.294179054120599
Epoch2,val total loss: 0.022909555584192276,  Spearman:[0.3317373461012312]
Epoch2,test total loss: 0.04564712952603312,  Spearman is [-0.006796358104915326],
Epoch3,train total loss: 0.020242503978526935,  Spearman:0.32914354271626306
Epoch3,val total loss: 0.020341837778687477,  Spearman:[0.2899641006646424]
Epoch3,test total loss: 0.06345641788314371,  Spearman is [-0.010490433695085184],
Epoch4,train total loss: 0.0169606678850519,  Spearman:0.3920408287037701
Epoch4,val total loss: 0.013438570313155651,  Spearman:[0.4452043149355713]
Epoch4,test total loss: 0.05744167209109839,  Spearman is [0.0756863351070862],
Epoch5,train total loss: 0.014490760010607446,  Spearman:0.4592139788415041
Epoch5,val total loss: 0.013489148579537868,  Spearman:[0.5717216701783988]
Epoch5,test total loss: 0.012082591447431375,  Spearman is [0.13287475208068253],
Epoch6,train total loss: 0.013063695180253724,  Spearman:0.4938226888063107
Epoch6,val total loss: 0.010009444318711758,  Spearman:[0.5341084024035042]
Epoch6,test total loss: 0.019813412307378125,  Spearman is [0.13392573381659875],
Epoch7,train total loss: 0.012522800049434105,  Spearman:0.5092125733828982
Epoch7,val total loss: 0.011761080473661423,  Spearman:[0.46024962204552916]
Epoch7,test total loss: 0.013415971565443803,  Spearman is [0.12011162487337441],
Epoch8,train total loss: 0.012207083641372334,  Spearman:0.5118754828982708
Epoch8,val total loss: 0.010314873419702053,  Spearman:[0.59565738603515]
Epoch8,test total loss: 0.025401953662581304,  Spearman is [0.1518058937804589],
Epoch9,train total loss: 0.011788545577870443,  Spearman:0.5255832352496186
Epoch9,val total loss: 0.009124547243118286,  Spearman:[0.5581395348837209]
Epoch9,test total loss: 0.015081288361483636,  Spearman is [0.14576500006170423],
Epoch10,train total loss: 0.011479336065419305,  Spearman:0.5320245791841206
Epoch10,val total loss: 0.010730109177529812,  Spearman:[0.432210640613335]
Epoch10,test total loss: 0.01940316304235774,  Spearman is [0.13085790702429037],
Epoch11,train total loss: 0.011085849516511632,  Spearman:0.5426072221466773
Epoch11,val total loss: 0.010128853842616081,  Spearman:[0.5060694209713099]
Epoch11,test total loss: 0.034233843140742355,  Spearman is [0.1362001296971305],
Epoch12,train total loss: 0.011004486586898565,  Spearman:0.5463373688084877
Epoch12,val total loss: 0.009086306206882,  Spearman:[0.4978628898204238]
Epoch12,test total loss: 0.017394301700679696,  Spearman is [0.15275795784131024],
Epoch13,train total loss: 0.010702316810448583,  Spearman:0.5540467295068248
Epoch13,val total loss: 0.010182199999690056,  Spearman:[0.4534108460864574]
Epoch13,test total loss: 0.012765288195463227,  Spearman is [0.13943196721317128],
Epoch14,train total loss: 0.010693611627898347,  Spearman:0.5597684083302135
Epoch14,val total loss: 0.009098943322896957,  Spearman:[0.4513592132987359]
Epoch14,test total loss: 0.0234658702632741,  Spearman is [0.13521319095092496],
Epoch15,train total loss: 0.01051362400325254,  Spearman:0.5626439014305701
Epoch15,val total loss: 0.009190310724079609,  Spearman:[0.4575141116619005]
Epoch15,test total loss: 0.025092233876314235,  Spearman is [0.1516592779727791],
Epoch16,train total loss: 0.01032875413642241,  Spearman:0.5684892851883908
Epoch16,val total loss: 0.010365101508796215,  Spearman:[0.4287912526337991]
Epoch16,test total loss: 0.02936899752410896,  Spearman is [0.14147754570101861],
Epoch17,train total loss: 0.010159376796740944,  Spearman:0.571539974385276
Epoch17,val total loss: 0.01010190136730671,  Spearman:[0.4075910471606766]
Epoch17,test total loss: 0.03563250379417749,  Spearman is [0.12084644340337874],
Epoch18,train total loss: 0.01005292852791265,  Spearman:0.5794072185780439
Epoch18,val total loss: 0.013042593374848366,  Spearman:[0.4540947236823646]
Epoch18,test total loss: 0.04191598082509111,  Spearman is [0.12752087269275597],
Epoch19,train total loss: 0.010024129356353138,  Spearman:0.574962516091167
Epoch19,val total loss: 0.010343885980546474,  Spearman:[0.4178492110992843]
Epoch19,test total loss: 0.022281460244865978,  Spearman is [0.12603425437628377],
Epoch20,train total loss: 0.009896032700243477,  Spearman:0.581333425317823
Epoch20,val total loss: 0.010682579129934311,  Spearman:[0.41442982311974846]
Epoch20,test total loss: 0.03327329243149828,  Spearman is [0.14027222651176022],
Epoch21,train total loss: 0.009762640063388225,  Spearman:0.5828880903545277
Epoch21,val total loss: 0.010695216245949268,  Spearman:[0.4759788067513942]
Epoch21,test total loss: 0.01814993959851563,  Spearman is [0.14659585125630617],
Epoch22,train total loss: 0.009629159588187646,  Spearman:0.5911615290066876
Epoch22,val total loss: 0.010409550741314888,  Spearman:[0.44793982531919996]
Epoch22,test total loss: 0.03210834427462781,  Spearman is [0.1360896083402598],
Epoch23,train total loss: 0.009618520608338982,  Spearman:0.5915288084024772
Epoch23,val total loss: 0.010067000053822994,  Spearman:[0.47666268434730136]
Epoch23,test total loss: 0.02588742025032201,  Spearman is [0.14782696583327182],
Epoch24,train total loss: 0.00953697200673513,  Spearman:0.5858007432978475
Epoch24,val total loss: 0.014776928350329399,  Spearman:[0.4445204373396641]
Epoch24,test total loss: 0.03960849465254475,  Spearman is [0.1575390035516441],
Epoch25,train total loss: 0.00951829039079782,  Spearman:0.5871783422203103
Epoch25,val total loss: 0.011239496991038322,  Spearman:[0.4793981947309301]
Epoch25,test total loss: 0.02338603722369846,  Spearman is [0.1545328544647295],
Epoch26,train total loss: 0.00918798953987276,  Spearman:0.5970663776831714
Epoch26,val total loss: 0.013698440045118332,  Spearman:[0.4369977837846852]
Epoch26,test total loss: 0.04736794021857135,  Spearman is [0.134459747132757],
Epoch27,train total loss: 0.009183572123173432,  Spearman:0.5934445917296384
Epoch27,val total loss: 0.009739979170262814,  Spearman:[0.48760472588181614]
Epoch27,test total loss: 0.028387686402043876,  Spearman is [0.15212663906181878],
Epoch28,train total loss: 0.009117674210872978,  Spearman:0.5957971813731963
Epoch28,val total loss: 0.009870541281998158,  Spearman:[0.45477860127827174]
Epoch28,test total loss: 0.02317156987812589,  Spearman is [0.14854939578891677],
Epoch29,train total loss: 0.009102688549319282,  Spearman:0.5936830941974639
Epoch29,val total loss: 0.010911031626164913,  Spearman:[0.5122243193344745]
Epoch29,test total loss: 0.03189100848291727,  Spearman is [0.15259334253817844],
Epoch30,train total loss: 0.008775839226123376,  Spearman:0.6012785798342172
Epoch30,val total loss: 0.010414672084152699,  Spearman:[0.510172686546753]
Epoch30,test total loss: 0.02070274913464399,  Spearman is [0.15257018820784746],
Epoch31,train total loss: 0.00889754210276386,  Spearman:0.6026173020893997
Epoch31,val total loss: 0.010451252572238445,  Spearman:[0.5512053423011836]
Epoch31,test total loss: 0.03231578469550347,  Spearman is [0.16124431159065525],
Epoch32,train total loss: 0.008496972618069356,  Spearman:0.611543672783681
Epoch32,val total loss: 0.01112013217061758,  Spearman:[0.44793982531919996]
Epoch32,test total loss: 0.03707892568234135,  Spearman is [0.14121827659858602],
Epoch33,train total loss: 0.008329052277333222,  Spearman:0.6135124671195886
Epoch33,val total loss: 0.012513873167335987,  Spearman:[0.42947513022970624]
Epoch33,test total loss: 0.027216981151415146,  Spearman is [0.13665381880641908],
Epoch34,train total loss: 0.0083710515501503,  Spearman:0.6066777241592031
Epoch34,val total loss: 0.014119328930974007,  Spearman:[0.4315267630174278]
Epoch34,test total loss: 0.04977389030596789,  Spearman is [0.14023420164953548],
Epoch35,train total loss: 0.008041866096811226,  Spearman:0.6196099465079421
Epoch35,val total loss: 0.012012817896902561,  Spearman:[0.40348778158523363]
Epoch35,test total loss: 0.024068710312028143,  Spearman is [0.12768892455247377],
Epoch36,train total loss: 0.007954669506617416,  Spearman:0.6206808635306481
Epoch36,val total loss: 0.011401119641959667,  Spearman:[0.4260557422501704]
Epoch36,test total loss: 0.027688431649414057,  Spearman is [0.13213774857951552],
Epoch37,train total loss: 0.007448865212679196,  Spearman:0.6237659116370342
Epoch37,val total loss: 0.015046145766973495,  Spearman:[0.4342622734010565]
Epoch37,test total loss: 0.050610465874128485,  Spearman is [0.13419440041636216],
Epoch38,train total loss: 0.006822301943499882,  Spearman:0.6409398647288337
Epoch38,val total loss: 0.013417058624327183,  Spearman:[0.5033339105876813]
Epoch38,test total loss: 0.04473390028921559,  Spearman is [0.13147135358820342],
Epoch39,train total loss: 0.0066300550735412305,  Spearman:0.6398026390084818
Epoch39,val total loss: 0.0158273633569479,  Spearman:[0.49170799145725924]
Epoch39,test total loss: 0.05273226878660567,  Spearman is [0.12548860555835134],
Epoch40,train total loss: 0.006161259424586136,  Spearman:0.648534720702756
Epoch40,val total loss: 0.015734534710645676,  Spearman:[0.5826637117129135]
Epoch40,test total loss: 0.033055651124895495,  Spearman is [0.1288226275995449],
Epoch41,train total loss: 0.0059774498744772225,  Spearman:0.6543520096932572
Epoch41,val total loss: 0.013724813237786293,  Spearman:[0.4862369706900018]
Epoch41,test total loss: 0.059827101690804255,  Spearman is [0.13341371870525331],
Epoch42,train total loss: 0.005626128547681639,  Spearman:0.6567019972038273
Epoch42,val total loss: 0.012708141468465328,  Spearman:[0.5252179936567108]
Epoch42,test total loss: 0.05365273868665099,  Spearman is [0.1327866956214944],
Epoch43,train total loss: 0.005267375356290871,  Spearman:0.6671997523237354
Epoch43,val total loss: 0.022566992789506912,  Spearman:[0.5546247302807193]
Epoch43,test total loss: 0.033021124613964385,  Spearman is [0.14024581593799743],
Epoch44,train total loss: 0.005163246423949321,  Spearman:0.6660273557975992
Epoch44,val total loss: 0.017562521621584892,  Spearman:[0.48486921549818746]
Epoch44,test total loss: 0.057833380011074687,  Spearman is [0.1329233199591001],
Epoch45,train total loss: 0.0047351943555837255,  Spearman:0.6792585803990032
Epoch45,val total loss: 0.03377596661448479,  Spearman:[0.4540947236823646]
Epoch45,test total loss: 0.11559716349138933,  Spearman is [0.12364831889989289],
Epoch46,train total loss: 0.0044762845134708835,  Spearman:0.6839512689494404
Epoch46,val total loss: 0.033776335418224335,  Spearman:[0.46640452040869373]
Epoch46,test total loss: 0.1281917673699996,  Spearman is [0.1422635201335361],
Epoch47,train total loss: 0.0041093955727634374,  Spearman:0.6899742501240385
Epoch47,val total loss: 0.010673876851797104,  Spearman:[0.4609334996414364]
Epoch47,test total loss: 0.07415645553127807,  Spearman is [0.1325373755625114],
Epoch48,train total loss: 0.003929751814725116,  Spearman:0.6909664002574684
Epoch48,val total loss: 0.006100043188780546,  Spearman:[0.6018122843983145]
Epoch48,test total loss: 0.047326926785685564,  Spearman is [0.13835710989430725],
Epoch49,train total loss: 0.003738398024907861,  Spearman:0.7037935051932775
Epoch49,val total loss: 0.008115443401038647,  Spearman:[0.5012822777999597]
Epoch49,test total loss: 0.05451857178088497,  Spearman is [0.13687974058198013],
Early stop at epoch 49
ensemble idx 0, best epoch 48, best validation spearman is 0.6018122843983145,best test spearman is [0.13836102375041912],

ensemble 1 models, fold 1, spearman is 0.13836102375041912, ndcg is 0.7638781752011273
training on fold 2 
Epoch0,train total loss: 0.06521380379294547,  Spearman:0.036066499602492856
Epoch0,val total loss: 0.04938138648867607,  Spearman:[0.6642735042735042]
Epoch0,test total loss: 0.007257519098108306,  Spearman is [0.03143744463888979],
Epoch1,train total loss: 0.025666107053462513,  Spearman:0.21392379036610917
Epoch1,val total loss: 0.07256504893302917,  Spearman:[0.6608547008547008]
Epoch1,test total loss: 0.024298547411008793,  Spearman is [0.001038471185011314],
Epoch2,train total loss: 0.02128834966629839,  Spearman:0.25429366851530105
Epoch2,val total loss: 0.034974660724401474,  Spearman:[0.6902564102564103]
Epoch2,test total loss: 0.018168540726251462,  Spearman is [-0.006376790608395728],
Epoch3,train total loss: 0.019657484685572293,  Spearman:0.27581522882490933
Epoch3,val total loss: 0.025679657235741615,  Spearman:[0.6964102564102563]
Epoch3,test total loss: 0.07359658532282885,  Spearman is [-0.013588818263703013],
Epoch4,train total loss: 0.017468495563102458,  Spearman:0.3221917391795603
Epoch4,val total loss: 0.02049093507230282,  Spearman:[0.8140170940170939]
Epoch4,test total loss: 0.06343247095013366,  Spearman is [0.07225673648750856],
Epoch5,train total loss: 0.01458323487223914,  Spearman:0.41794556887254347
Epoch5,val total loss: 0.016735898330807686,  Spearman:[0.8058119658119658]
Epoch5,test total loss: 0.04314247409210486,  Spearman is [0.10776303760758046],
Epoch6,train total loss: 0.012932498472181555,  Spearman:0.4760964325492777
Epoch6,val total loss: 0.018805434927344322,  Spearman:[0.7982905982905983]
Epoch6,test total loss: 0.031573356622282195,  Spearman is [0.13219725192040271],
Epoch7,train total loss: 0.011933911454457885,  Spearman:0.49856215742662846
Epoch7,val total loss: 0.013113615103065968,  Spearman:[0.7894017094017093]
Epoch7,test total loss: 0.02418519077165162,  Spearman is [0.13832660515127845],
Epoch8,train total loss: 0.011422066531406764,  Spearman:0.5139100169103582
Epoch8,val total loss: 0.01299432385712862,  Spearman:[0.7634188034188034]
Epoch8,test total loss: 0.02913940478773678,  Spearman is [0.1327481722464316],
Epoch9,train total loss: 0.01101954915196611,  Spearman:0.5226694637358145
Epoch9,val total loss: 0.01686199940741062,  Spearman:[0.7928205128205127]
Epoch9,test total loss: 0.021499701611259404,  Spearman is [0.1355396956465632],
Epoch10,train total loss: 0.010751142688931372,  Spearman:0.5316878871915091
Epoch10,val total loss: 0.016202181577682495,  Spearman:[0.7613675213675213]
Epoch10,test total loss: 0.026427747818696147,  Spearman is [0.13436369325484712],
Epoch11,train total loss: 0.010667646715704065,  Spearman:0.5375933462695128
Epoch11,val total loss: 0.015596555545926094,  Spearman:[0.7442735042735041]
Epoch11,test total loss: 0.019649112953201812,  Spearman is [0.13733393881076295],
Epoch12,train total loss: 0.010256204783964233,  Spearman:0.548679004264396
Epoch12,val total loss: 0.013197415508329868,  Spearman:[0.7716239316239316]
Epoch12,test total loss: 0.020175474284983733,  Spearman is [0.14142032279119926],
Epoch13,train total loss: 0.009982312641416987,  Spearman:0.5514558830980468
Epoch13,val total loss: 0.016063913702964783,  Spearman:[0.749059829059829]
Epoch13,test total loss: 0.021032455610111356,  Spearman is [0.1422899731339234],
Epoch14,train total loss: 0.009771905948396008,  Spearman:0.5569058033932662
Epoch14,val total loss: 0.014201789163053036,  Spearman:[0.7777777777777777]
Epoch14,test total loss: 0.027514052084263635,  Spearman is [0.13112328556065359],
Epoch15,train total loss: 0.009679433195672642,  Spearman:0.5511898761611723
Epoch15,val total loss: 0.016448186710476875,  Spearman:[0.7757264957264958]
Epoch15,test total loss: 0.020851258503492263,  Spearman is [0.12728264719608456],
Epoch16,train total loss: 0.009220358706676425,  Spearman:0.5570070653968671
Epoch16,val total loss: 0.012882499024271965,  Spearman:[0.7935042735042734]
Epoch16,test total loss: 0.02467901087092126,  Spearman is [0.14069320469354504],
Epoch17,train total loss: 0.009048904853466993,  Spearman:0.5556884088887389
Epoch17,val total loss: 0.013270635157823563,  Spearman:[0.7777777777777777]
Epoch17,test total loss: 0.017705929739510313,  Spearman is [0.13844460420072055],
Epoch18,train total loss: 0.00873883645563649,  Spearman:0.5575814669949472
Epoch18,val total loss: 0.013287997804582119,  Spearman:[0.8167521367521368]
Epoch18,test total loss: 0.019599099821575424,  Spearman is [0.15115832560377684],
Epoch19,train total loss: 0.00848412352020088,  Spearman:0.5618667212220544
Epoch19,val total loss: 0.00707578007131815,  Spearman:[0.8393162393162392]
Epoch19,test total loss: 0.01208021103486638,  Spearman is [0.16998939350297024],
Epoch20,train total loss: 0.008159313828517228,  Spearman:0.5743349879815148
Epoch20,val total loss: 0.00961952656507492,  Spearman:[0.7921367521367522]
Epoch20,test total loss: 0.012534804505241267,  Spearman is [0.15274203725045965],
Epoch21,train total loss: 0.008103088142935378,  Spearman:0.5696064060303226
Epoch21,val total loss: 0.009679056704044342,  Spearman:[0.816068376068376]
Epoch21,test total loss: 0.014425753163831198,  Spearman is [0.164212096402349],
Epoch22,train total loss: 0.007786052957481633,  Spearman:0.5840408675787415
Epoch22,val total loss: 0.010337809100747108,  Spearman:[0.7969230769230767]
Epoch22,test total loss: 0.015183736186693697,  Spearman is [0.14933547628799557],
Epoch23,train total loss: 0.007365328598564538,  Spearman:0.5884372803429408
Epoch23,val total loss: 0.007395322434604168,  Spearman:[0.8235897435897435]
Epoch23,test total loss: 0.01332007344428669,  Spearman is [0.17240212139274452],
Epoch24,train total loss: 0.006312797810189808,  Spearman:0.6032846719968404
Epoch24,val total loss: 0.006288778968155384,  Spearman:[0.8133333333333332]
Epoch24,test total loss: 0.0072346539099645965,  Spearman is [0.19322561782591965],
Epoch25,train total loss: 0.004700715915532783,  Spearman:0.6330664994082864
Epoch25,val total loss: 0.004604298621416092,  Spearman:[0.7264957264957265]
Epoch25,test total loss: 0.004464573233717066,  Spearman is [0.21948365254555596],
Epoch26,train total loss: 0.004022051958600059,  Spearman:0.6358095298845405
Epoch26,val total loss: 0.003254828741773963,  Spearman:[0.7429059829059829]
Epoch26,test total loss: 0.003986393553478753,  Spearman is [0.2226123026254428],
Epoch27,train total loss: 0.003661255461898131,  Spearman:0.6446992768251374
Epoch27,val total loss: 0.0036164293996989727,  Spearman:[0.747008547008547]
Epoch27,test total loss: 0.004048178903758526,  Spearman is [0.2294917267578373],
Epoch28,train total loss: 0.0034684947776184296,  Spearman:0.6480697736109837
Epoch28,val total loss: 0.004721641540527344,  Spearman:[0.7046153846153845]
Epoch28,test total loss: 0.004916556960190921,  Spearman is [0.19764063843987625],
Epoch29,train total loss: 0.0033306499804334287,  Spearman:0.6459054185381418
Epoch29,val total loss: 0.004119378514587879,  Spearman:[0.6765811965811965]
Epoch29,test total loss: 0.00370385727899916,  Spearman is [0.20687431596680247],
Epoch30,train total loss: 0.003247349138314931,  Spearman:0.6507545617455992
Epoch30,val total loss: 0.004812630359083414,  Spearman:[0.7018803418803419]
Epoch30,test total loss: 0.004085701903985704,  Spearman is [0.19606296198053122],
Epoch31,train total loss: 0.003073316087232879,  Spearman:0.6621191664748726
Epoch31,val total loss: 0.005929677281528711,  Spearman:[0.7360683760683759]
Epoch31,test total loss: 0.005570439621806145,  Spearman is [0.19288544115053027],
Epoch32,train total loss: 0.0030256376526384163,  Spearman:0.6587736896373074
Epoch32,val total loss: 0.004835236817598343,  Spearman:[0.7613675213675213]
Epoch32,test total loss: 0.00418909578858053,  Spearman is [0.18937980341315935],
Epoch33,train total loss: 0.0028820480302107544,  Spearman:0.6690249173881497
Epoch33,val total loss: 0.004178110510110855,  Spearman:[0.7401709401709401]
Epoch33,test total loss: 0.0038517129415755764,  Spearman is [0.19115677894118005],
Epoch34,train total loss: 0.0028515256204767725,  Spearman:0.6733661574502358
Epoch34,val total loss: 0.007892254739999771,  Spearman:[0.7429059829059829]
Epoch34,test total loss: 0.00752130476757884,  Spearman is [0.18983848825748503],
Epoch35,train total loss: 0.0028998156877395767,  Spearman:0.6701412525892939
Epoch35,val total loss: 0.0034732103813439608,  Spearman:[0.7087179487179487]
Epoch35,test total loss: 0.0036709472016595744,  Spearman is [0.1853913188687995],
Epoch36,train total loss: 0.0027890496466380474,  Spearman:0.678977555278888
Epoch36,val total loss: 0.005462497007101774,  Spearman:[0.7422222222222221]
Epoch36,test total loss: 0.0053321857292972065,  Spearman is [0.1799104093407984],
Epoch37,train total loss: 0.0026783263478696775,  Spearman:0.6829613848004298
Epoch37,val total loss: 0.006795086897909641,  Spearman:[0.6752136752136751]
Epoch37,test total loss: 0.006018201546633945,  Spearman is [0.18324753335184796],
Epoch38,train total loss: 0.0026889567999228933,  Spearman:0.6835075270508589
Epoch38,val total loss: 0.005819464102387428,  Spearman:[0.6724786324786325]
Epoch38,test total loss: 0.005516825367093962,  Spearman is [0.17098675859215115],
Epoch39,train total loss: 0.0027207858604528247,  Spearman:0.687292409142451
Epoch39,val total loss: 0.004664144478738308,  Spearman:[0.6923076923076923]
Epoch39,test total loss: 0.0048812411396819,  Spearman is [0.1596669851509625],
Epoch40,train total loss: 0.002609409991866694,  Spearman:0.685155753599204
Epoch40,val total loss: 0.006053402554243803,  Spearman:[0.718974358974359]
Epoch40,test total loss: 0.006581814754206468,  Spearman is [0.16453025365961324],
Epoch41,train total loss: 0.002559144549125519,  Spearman:0.6977956273974253
Epoch41,val total loss: 0.006825592368841171,  Spearman:[0.6779487179487179]
Epoch41,test total loss: 0.006102567319484318,  Spearman is [0.1852321129602938],
Epoch42,train total loss: 0.002627217839173495,  Spearman:0.6958475773905599
Epoch42,val total loss: 0.004344651009887457,  Spearman:[0.6136752136752136]
Epoch42,test total loss: 0.004230361253790119,  Spearman is [0.1493022668476537],
Epoch43,train total loss: 0.0024333099669699245,  Spearman:0.7091317700803931
Epoch43,val total loss: 0.008193416520953178,  Spearman:[0.6854700854700854]
Epoch43,test total loss: 0.009221213787574978,  Spearman is [0.1387827019715085],
Epoch44,train total loss: 0.002523706029303587,  Spearman:0.6988576223838622
Epoch44,val total loss: 0.004702480975538492,  Spearman:[0.6895726495726495]
Epoch44,test total loss: 0.005587508134982165,  Spearman is [0.14382136214591873],
Epoch45,train total loss: 0.002497023087179957,  Spearman:0.7048722746747292
Epoch45,val total loss: 0.00405049929395318,  Spearman:[0.6758974358974358]
Epoch45,test total loss: 0.004835781408473849,  Spearman is [0.14842709043708602],
Epoch46,train total loss: 0.0024446064945107373,  Spearman:0.7074264014108185
Epoch46,val total loss: 0.004914335440844297,  Spearman:[0.6464957264957265]
Epoch46,test total loss: 0.004980454440502559,  Spearman is [0.14646929263536748],
Epoch47,train total loss: 0.002349610850125408,  Spearman:0.713762602358244
Epoch47,val total loss: 0.004057479556649923,  Spearman:[0.6376068376068377]
Epoch47,test total loss: 0.00412479430601439,  Spearman is [0.150353747096408],
Epoch48,train total loss: 0.0023113360116556766,  Spearman:0.7202012927970667
Epoch48,val total loss: 0.007387396413832903,  Spearman:[0.6950427350427351]
Epoch48,test total loss: 0.006443845847731128,  Spearman is [0.16201851836781564],
Epoch49,train total loss: 0.0023352628937946297,  Spearman:0.7146924462455776
Epoch49,val total loss: 0.005216480698436499,  Spearman:[0.6758974358974358]
Epoch49,test total loss: 0.005762558320865911,  Spearman is [0.13383333923505356],
Early stop at epoch 49
ensemble idx 0, best epoch 19, best validation spearman is 0.8393162393162392,best test spearman is [0.16998334770897633],

ensemble 1 models, fold 2, spearman is 0.16998334770897633, ndcg is 0.7735652674106805
training on fold 3 
Epoch0,train total loss: 0.050919117800031714,  Spearman:0.008168071349605266
Epoch0,val total loss: 0.027083424851298332,  Spearman:[0.3490598290598291]
Epoch0,test total loss: 0.007735329762320308,  Spearman is [0.031059285527900247],
Epoch1,train total loss: 0.027364716680051807,  Spearman:0.18929333691912179
Epoch1,val total loss: 0.023431086912751198,  Spearman:[0.2594871794871795]
Epoch1,test total loss: 0.012405406793250758,  Spearman is [-0.02646352749349479],
Epoch2,train total loss: 0.022811465254889276,  Spearman:0.28411073185311964
Epoch2,val total loss: 0.04707471281290054,  Spearman:[0.24376068376068374]
Epoch2,test total loss: 0.014469281195060295,  Spearman is [-0.023756295189625295],
Epoch3,train total loss: 0.01959426810917182,  Spearman:0.33767941369540777
Epoch3,val total loss: 0.014961245469748974,  Spearman:[0.2451282051282051]
Epoch3,test total loss: 0.04096428688396426,  Spearman is [0.05084082648952546],
Epoch4,train total loss: 0.014949949086607935,  Spearman:0.4425354770682306
Epoch4,val total loss: 0.013523525558412075,  Spearman:[0.26974358974358975]
Epoch4,test total loss: 0.024248081697698903,  Spearman is [0.09964257106808301],
Epoch5,train total loss: 0.01292740528543408,  Spearman:0.5036052017244662
Epoch5,val total loss: 0.013347056694328785,  Spearman:[0.44752136752136745]
Epoch5,test total loss: 0.014023460625835201,  Spearman is [0.17367179116474135],
Epoch6,train total loss: 0.011876222270075232,  Spearman:0.5272981987372445
Epoch6,val total loss: 0.013333595357835293,  Spearman:[0.40376068376068375]
Epoch6,test total loss: 0.015187602531274451,  Spearman is [0.1752987991817453],
Epoch7,train total loss: 0.011252619300742084,  Spearman:0.5390123761580532
Epoch7,val total loss: 0.013958850875496864,  Spearman:[0.44068376068376064]
Epoch7,test total loss: 0.01856099217034438,  Spearman is [0.15638866926776168],
Epoch8,train total loss: 0.010983903395334402,  Spearman:0.5492964062901143
Epoch8,val total loss: 0.01489984430372715,  Spearman:[0.37025641025641026]
Epoch8,test total loss: 0.02765640106928699,  Spearman is [0.16736144595366967],
Epoch9,train total loss: 0.010470538606079152,  Spearman:0.5597836125074653
Epoch9,val total loss: 0.015511341392993927,  Spearman:[0.3524786324786324]
Epoch9,test total loss: 0.023399259840302607,  Spearman is [0.16427880166274822],
Epoch10,train total loss: 0.010095586998758312,  Spearman:0.5679791249421157
Epoch10,val total loss: 0.0158836729824543,  Spearman:[0.4782905982905982]
Epoch10,test total loss: 0.017233097925782204,  Spearman is [0.16322890180575722],
Epoch11,train total loss: 0.009976710421212304,  Spearman:0.5761323064998504
Epoch11,val total loss: 0.014993829652667046,  Spearman:[0.44478632478632474]
Epoch11,test total loss: 0.02814016748657998,  Spearman is [0.1582034257049161],
Epoch12,train total loss: 0.009509751544101164,  Spearman:0.5784017156494748
Epoch12,val total loss: 0.01518071535974741,  Spearman:[0.4659829059829059]
Epoch12,test total loss: 0.021810633253634852,  Spearman is [0.15629797175119728],
Epoch13,train total loss: 0.009403693218094608,  Spearman:0.5860418024630157
Epoch13,val total loss: 0.016486521810293198,  Spearman:[0.40786324786324785]
Epoch13,test total loss: 0.020768261103726485,  Spearman is [0.1487621228842525],
Epoch14,train total loss: 0.009297171585226001,  Spearman:0.5932041192000259
Epoch14,val total loss: 0.018479302525520325,  Spearman:[0.3846153846153845]
Epoch14,test total loss: 0.021397972150760537,  Spearman is [0.14755021696153764],
Epoch15,train total loss: 0.009064706499115206,  Spearman:0.5872451904721557
Epoch15,val total loss: 0.01703828200697899,  Spearman:[0.40307692307692305]
Epoch15,test total loss: 0.017260777490103945,  Spearman is [0.16231425802773122],
Epoch16,train total loss: 0.00876746825629081,  Spearman:0.598082262121672
Epoch16,val total loss: 0.015331575646996498,  Spearman:[0.4461538461538461]
Epoch16,test total loss: 0.025225747267113012,  Spearman is [0.157041986252066],
Epoch17,train total loss: 0.00864520650327158,  Spearman:0.598418774697144
Epoch17,val total loss: 0.014013189822435379,  Spearman:[0.40786324786324785]
Epoch17,test total loss: 0.018029419554616597,  Spearman is [0.14697116778345298],
Epoch18,train total loss: 0.008579403164987572,  Spearman:0.6024446045402565
Epoch18,val total loss: 0.013957258313894272,  Spearman:[0.401025641025641]
Epoch18,test total loss: 0.03733794188455624,  Spearman is [0.15799213050815786],
Epoch19,train total loss: 0.008429969151247626,  Spearman:0.6041567736605243
Epoch19,val total loss: 0.017054909840226173,  Spearman:[0.45572649572649565]
Epoch19,test total loss: 0.013289585079559508,  Spearman is [0.15076584750701233],
Epoch20,train total loss: 0.008466120883941842,  Spearman:0.599675254310439
Epoch20,val total loss: 0.018091116100549698,  Spearman:[0.47008547008547]
Epoch20,test total loss: 0.023470996755777913,  Spearman is [0.1572386548700215],
Epoch21,train total loss: 0.008340554837232981,  Spearman:0.605510541489141
Epoch21,val total loss: 0.013313669711351395,  Spearman:[0.41538461538461535]
Epoch21,test total loss: 0.025276270859381732,  Spearman is [0.15830486776413982],
Epoch22,train total loss: 0.00815135195854311,  Spearman:0.6097816851450656
Epoch22,val total loss: 0.011225559748709202,  Spearman:[0.4974358974358974]
Epoch22,test total loss: 0.026791217846467215,  Spearman is [0.15917643791162342],
Epoch23,train total loss: 0.007971896994441079,  Spearman:0.6152833557299181
Epoch23,val total loss: 0.015166381374001503,  Spearman:[0.4762393162393162]
Epoch23,test total loss: 0.029303741942652884,  Spearman is [0.16130240424627718],
Epoch24,train total loss: 0.007890994649362536,  Spearman:0.6178167221008091
Epoch24,val total loss: 0.013426720164716244,  Spearman:[0.4988034188034188]
Epoch24,test total loss: 0.029884012936450103,  Spearman is [0.14859144057381457],
Epoch25,train total loss: 0.007733599658912191,  Spearman:0.6188594728000113
Epoch25,val total loss: 0.014632755890488625,  Spearman:[0.5111111111111111]
Epoch25,test total loss: 0.02404596996219719,  Spearman is [0.15145897127177113],
Epoch26,train total loss: 0.00777070729721648,  Spearman:0.6222752188569672
Epoch26,val total loss: 0.012277054600417614,  Spearman:[0.5336752136752136]
Epoch26,test total loss: 0.03286987718413858,  Spearman is [0.14872342980269165],
Epoch27,train total loss: 0.007542860003946445,  Spearman:0.6264310974563196
Epoch27,val total loss: 0.017100948840379715,  Spearman:[0.5391452991452992]
Epoch27,test total loss: 0.019745694117291886,  Spearman is [0.15849809982550936],
Epoch28,train total loss: 0.007341539974545295,  Spearman:0.6269747230013641
Epoch28,val total loss: 0.01585434563457966,  Spearman:[0.5576068376068375]
Epoch28,test total loss: 0.013489439789041439,  Spearman is [0.14223120165230912],
Epoch29,train total loss: 0.006987288849464117,  Spearman:0.6349208194617272
Epoch29,val total loss: 0.014606266282498837,  Spearman:[0.5507692307692307]
Epoch29,test total loss: 0.024987822097233114,  Spearman is [0.16814508692183866],
Epoch30,train total loss: 0.0069445642308355905,  Spearman:0.6380743071265141
Epoch30,val total loss: 0.018324414268136024,  Spearman:[0.535042735042735]
Epoch30,test total loss: 0.01834847080959555,  Spearman is [0.16627091199704608],
Epoch31,train total loss: 0.006200875264580528,  Spearman:0.6557892593686752
Epoch31,val total loss: 0.014365820214152336,  Spearman:[0.5261538461538461]
Epoch31,test total loss: 0.02433089485994595,  Spearman is [0.16672827100935553],
Epoch32,train total loss: 0.005446144955781981,  Spearman:0.6640090533330256
Epoch32,val total loss: 0.00977874081581831,  Spearman:[0.6116239316239316]
Epoch32,test total loss: 0.026974845239344764,  Spearman is [0.16210601754793827],
Epoch33,train total loss: 0.004598478662769477,  Spearman:0.6696468252237534
Epoch33,val total loss: 0.01629173755645752,  Spearman:[0.5999999999999999]
Epoch33,test total loss: 0.018581429304664627,  Spearman is [0.19346545553432273],
Epoch34,train total loss: 0.004156989300286231,  Spearman:0.6816889685752078
Epoch34,val total loss: 0.011153004132211208,  Spearman:[0.5439316239316239]
Epoch34,test total loss: 0.026385116116965517,  Spearman is [0.16686374982809923],
Epoch35,train total loss: 0.0036753913218256994,  Spearman:0.6989267117324198
Epoch35,val total loss: 0.008923621848225594,  Spearman:[0.5603418803418803]
Epoch35,test total loss: 0.019203599254765055,  Spearman is [0.1634450442443667],
Epoch36,train total loss: 0.003440472002973995,  Spearman:0.7055474718739605
Epoch36,val total loss: 0.010259832255542278,  Spearman:[0.4947008547008547]
Epoch36,test total loss: 0.025112169520819887,  Spearman is [0.16326138999348225],
Epoch37,train total loss: 0.0032322324151232936,  Spearman:0.7091326696195607
Epoch37,val total loss: 0.011473942548036575,  Spearman:[0.43384615384615377]
Epoch37,test total loss: 0.019411502762095016,  Spearman is [0.15871655451515512],
Epoch38,train total loss: 0.003040136625760426,  Spearman:0.7128002822833602
Epoch38,val total loss: 0.016081731766462326,  Spearman:[0.507008547008547]
Epoch38,test total loss: 0.01836793020586757,  Spearman is [0.16191543715060117],
Epoch39,train total loss: 0.0029610695163659654,  Spearman:0.7223139049830837
Epoch39,val total loss: 0.013834557496011257,  Spearman:[0.5179487179487179]
Epoch39,test total loss: 0.020477043451083934,  Spearman is [0.15887874089403323],
Epoch40,train total loss: 0.002929574401768593,  Spearman:0.7236074648174429
Epoch40,val total loss: 0.008640429005026817,  Spearman:[0.5213675213675213]
Epoch40,test total loss: 0.019703770795946613,  Spearman is [0.16757809751177338],
Epoch41,train total loss: 0.0027831663061918402,  Spearman:0.7277613367046282
Epoch41,val total loss: 0.01321618352085352,  Spearman:[0.5295726495726496]
Epoch41,test total loss: 0.01758187183398096,  Spearman is [0.15632782948820217],
Epoch42,train total loss: 0.002831367206780646,  Spearman:0.7284611730823092
Epoch42,val total loss: 0.009465060196816921,  Spearman:[0.5535042735042734]
Epoch42,test total loss: 0.021971253924729192,  Spearman is [0.17615973085313086],
Epoch43,train total loss: 0.0027333361328764558,  Spearman:0.735581851622637
Epoch43,val total loss: 0.012542052194476128,  Spearman:[0.5466666666666666]
Epoch43,test total loss: 0.017641191754271004,  Spearman is [0.18563081716420643],
Epoch44,train total loss: 0.00255551165192185,  Spearman:0.7484425817724404
Epoch44,val total loss: 0.011620822362601757,  Spearman:[0.4673504273504273]
Epoch44,test total loss: 0.020321804769885016,  Spearman is [0.16434233553296465],
Epoch45,train total loss: 0.002483148162868113,  Spearman:0.7522947518034196
Epoch45,val total loss: 0.012012769468128681,  Spearman:[0.548034188034188]
Epoch45,test total loss: 0.01691348270020064,  Spearman is [0.17662864051396548],
Epoch46,train total loss: 0.002478279648363614,  Spearman:0.7518966123508373
Epoch46,val total loss: 0.00900514330714941,  Spearman:[0.606153846153846]
Epoch46,test total loss: 0.015938750974943534,  Spearman is [0.17840138398619043],
Epoch47,train total loss: 0.002508431612976636,  Spearman:0.7487228871704116
Epoch47,val total loss: 0.010282976552844048,  Spearman:[0.5439316239316239]
Epoch47,test total loss: 0.019963327754179343,  Spearman is [0.1683948206404107],
Epoch48,train total loss: 0.002401361577750112,  Spearman:0.7615884879190375
Epoch48,val total loss: 0.011244632303714752,  Spearman:[0.5863247863247864]
Epoch48,test total loss: 0.017899260294678455,  Spearman is [0.16271217777054828],
Epoch49,train total loss: 0.002362347281469295,  Spearman:0.7633898542247559
Epoch49,val total loss: 0.005301919300109148,  Spearman:[0.5473504273504273]
Epoch49,test total loss: 0.02988361011204474,  Spearman is [0.1707771498537175],
Early stop at epoch 49
ensemble idx 0, best epoch 32, best validation spearman is 0.6116239316239316,best test spearman is [0.1621026234179768],

ensemble 1 models, fold 3, spearman is 0.1621026234179768, ndcg is 0.7635023536090224
training on fold 4 
Epoch0,train total loss: 0.04469214613513591,  Spearman:0.006986883902230802
Epoch0,val total loss: 0.039805762469768524,  Spearman:[0.3483760683760683]
Epoch0,test total loss: 0.007537043461685672,  Spearman is [-0.0058604055547249075],
Epoch1,train total loss: 0.030708891103784434,  Spearman:0.06860057050517296
Epoch1,val total loss: 0.027218211442232132,  Spearman:[0.372991452991453]
Epoch1,test total loss: 0.007720327771761838,  Spearman is [0.058552512501787154],
Epoch2,train total loss: 0.02484646569400166,  Spearman:0.2596162242445842
Epoch2,val total loss: 0.0190040972083807,  Spearman:[0.2492307692307692]
Epoch2,test total loss: 0.017260869280161226,  Spearman is [-0.022508729689002607],
Epoch3,train total loss: 0.021953252215798084,  Spearman:0.28760663560985883
Epoch3,val total loss: 0.01869497261941433,  Spearman:[0.2875213675213675]
Epoch3,test total loss: 0.033748905010083145,  Spearman is [-0.00933229291229137],
Epoch4,train total loss: 0.01905840324261823,  Spearman:0.34017470532746286
Epoch4,val total loss: 0.012550996616482735,  Spearman:[0.455042735042735]
Epoch4,test total loss: 0.044355477699462104,  Spearman is [0.06517248721859487],
Epoch5,train total loss: 0.014484601872913444,  Spearman:0.46435373259622015
Epoch5,val total loss: 0.0429452508687973,  Spearman:[0.5165811965811965]
Epoch5,test total loss: 0.10120595202726476,  Spearman is [0.136323729061009],
Epoch6,train total loss: 0.012641071722520372,  Spearman:0.5137531973382433
Epoch6,val total loss: 0.010010221973061562,  Spearman:[0.5268376068376068]
Epoch6,test total loss: 0.019621984608580962,  Spearman is [0.1621575128634476],
Epoch7,train total loss: 0.011638923079515688,  Spearman:0.5403928218355656
Epoch7,val total loss: 0.010962115600705147,  Spearman:[0.5015384615384615]
Epoch7,test total loss: 0.023309770177173263,  Spearman is [0.15692487816173878],
Epoch8,train total loss: 0.010997759182758342,  Spearman:0.5537796811218776
Epoch8,val total loss: 0.01786724664270878,  Spearman:[0.49196581196581196]
Epoch8,test total loss: 0.03018815497703412,  Spearman is [0.14407298384928183],
Epoch9,train total loss: 0.010551658521692913,  Spearman:0.5667020875915254
Epoch9,val total loss: 0.012988017871975899,  Spearman:[0.5063247863247863]
Epoch9,test total loss: 0.02403455542619614,  Spearman is [0.14911636398566974],
Epoch10,train total loss: 0.010126215235616725,  Spearman:0.5780501000618549
Epoch10,val total loss: 0.015864668413996696,  Spearman:[0.49333333333333323]
Epoch10,test total loss: 0.030844848876928583,  Spearman is [0.1614657997839541],
Epoch11,train total loss: 0.01000480155627697,  Spearman:0.5840200469212075
Epoch11,val total loss: 0.011054260656237602,  Spearman:[0.4905982905982905]
Epoch11,test total loss: 0.019432330052094424,  Spearman is [0.15122438385815218],
Epoch12,train total loss: 0.009755611643553354,  Spearman:0.5896128366195384
Epoch12,val total loss: 0.010167964734137058,  Spearman:[0.4926495726495726]
Epoch12,test total loss: 0.020758130505461905,  Spearman is [0.17052461597792726],
Epoch13,train total loss: 0.00948428990952193,  Spearman:0.6004203496392618
Epoch13,val total loss: 0.012345412746071815,  Spearman:[0.4892307692307692]
Epoch13,test total loss: 0.03415050713674111,  Spearman is [0.1442278516354305],
Epoch14,train total loss: 0.009313396317735076,  Spearman:0.604404781795312
Epoch14,val total loss: 0.010662428103387356,  Spearman:[0.5124786324786325]
Epoch14,test total loss: 0.021400320193018105,  Spearman is [0.1451113542710599],
Epoch15,train total loss: 0.009211974224457756,  Spearman:0.6075657205663453
Epoch15,val total loss: 0.01328898686915636,  Spearman:[0.4926495726495726]
Epoch15,test total loss: 0.023958735304939395,  Spearman is [0.1625106720859396],
Epoch16,train total loss: 0.009097199448241064,  Spearman:0.6136696176616554
Epoch16,val total loss: 0.010301974602043629,  Spearman:[0.4892307692307692]
Epoch16,test total loss: 0.024084011394092265,  Spearman is [0.15942397605237665],
Epoch17,train total loss: 0.008909769489083631,  Spearman:0.6128055331565996
Epoch17,val total loss: 0.009727999567985535,  Spearman:[0.5282051282051281]
Epoch17,test total loss: 0.02792799292022691,  Spearman is [0.1562224735728666],
Epoch18,train total loss: 0.008648763503282307,  Spearman:0.6187146335214305
Epoch18,val total loss: 0.008955278433859348,  Spearman:[0.4748717948717948]
Epoch18,test total loss: 0.018573570859563703,  Spearman is [0.15577195585376075],
Epoch19,train total loss: 0.008303106749036279,  Spearman:0.6230549522160521
Epoch19,val total loss: 0.012471066787838936,  Spearman:[0.4926495726495726]
Epoch19,test total loss: 0.017208095338633832,  Spearman is [0.14154062348502147],
Epoch20,train total loss: 0.008280585711009992,  Spearman:0.6249078215497966
Epoch20,val total loss: 0.013018959201872349,  Spearman:[0.4782905982905982]
Epoch20,test total loss: 0.01864427570527529,  Spearman is [0.1446191736066769],
Epoch21,train total loss: 0.008206048271415804,  Spearman:0.6266806136123739
Epoch21,val total loss: 0.007898774929344654,  Spearman:[0.5247863247863247]
Epoch21,test total loss: 0.02355202244978179,  Spearman is [0.14362332526932248],
Epoch22,train total loss: 0.008026641342812816,  Spearman:0.6330405495182476
Epoch22,val total loss: 0.009739009663462639,  Spearman:[0.49333333333333323]
Epoch22,test total loss: 0.025882596286999827,  Spearman is [0.1411273351289306],
Epoch23,train total loss: 0.008008263717877129,  Spearman:0.6291268115320392
Epoch23,val total loss: 0.011212648823857307,  Spearman:[0.5008547008547009]
Epoch23,test total loss: 0.022066013312295955,  Spearman is [0.14431898402489624],
Epoch24,train total loss: 0.00787146971337139,  Spearman:0.6319721558999679
Epoch24,val total loss: 0.010840967297554016,  Spearman:[0.47350427350427343]
Epoch24,test total loss: 0.021203590721330223,  Spearman is [0.16062994224765895],
Epoch25,train total loss: 0.007845018346322319,  Spearman:0.6364767057686492
Epoch25,val total loss: 0.010742472484707832,  Spearman:[0.4871794871794871]
Epoch25,test total loss: 0.020986031549160972,  Spearman is [0.15482666944617626],
Epoch26,train total loss: 0.007782090100077674,  Spearman:0.6391554842332194
Epoch26,val total loss: 0.010674634017050266,  Spearman:[0.4994871794871794]
Epoch26,test total loss: 0.01585558248574243,  Spearman is [0.15139276452420997],
Epoch27,train total loss: 0.007593735012237747,  Spearman:0.6357453978660272
Epoch27,val total loss: 0.011654751375317574,  Spearman:[0.4789743589743589]
Epoch27,test total loss: 0.01372013330076109,  Spearman is [0.15134824838843394],
Epoch28,train total loss: 0.00745205648500138,  Spearman:0.6425180882719513
Epoch28,val total loss: 0.009493936784565449,  Spearman:[0.4823931623931623]
Epoch28,test total loss: 0.018546405111384744,  Spearman is [0.14448964512202192],
Epoch29,train total loss: 0.007273721696737294,  Spearman:0.6476286754363619
Epoch29,val total loss: 0.009515439160168171,  Spearman:[0.49606837606837606]
Epoch29,test total loss: 0.012973694281433435,  Spearman is [0.15388481959517777],
Epoch30,train total loss: 0.007153173084728993,  Spearman:0.6511721414947892
Epoch30,val total loss: 0.012408651411533356,  Spearman:[0.4899145299145299]
Epoch30,test total loss: 0.0295826436349136,  Spearman is [0.15553297728450416],
Epoch31,train total loss: 0.006786825822648377,  Spearman:0.6579469667248775
Epoch31,val total loss: 0.012310377322137356,  Spearman:[0.4892307692307692]
Epoch31,test total loss: 0.028867756893091342,  Spearman is [0.15171824037420367],
Epoch32,train total loss: 0.00645714485943198,  Spearman:0.6661232935360558
Epoch32,val total loss: 0.008941650390625,  Spearman:[0.5056410256410256]
Epoch32,test total loss: 0.01767890636042199,  Spearman is [0.15623311204896462],
Epoch33,train total loss: 0.006239111571071239,  Spearman:0.6659132140273812
Epoch33,val total loss: 0.011380559764802456,  Spearman:[0.5076923076923077]
Epoch33,test total loss: 0.02695047329453861,  Spearman is [0.1466982903412061],
Epoch34,train total loss: 0.005864789115432172,  Spearman:0.6760870773461685
Epoch34,val total loss: 0.01074859220534563,  Spearman:[0.5213675213675213]
Epoch34,test total loss: 0.02690795294063933,  Spearman is [0.15366353292834536],
Epoch35,train total loss: 0.0056040971390664196,  Spearman:0.6746877964772238
Epoch35,val total loss: 0.007608968764543533,  Spearman:[0.5247863247863247]
Epoch35,test total loss: 0.014466637307230164,  Spearman is [0.1774796023992055],
Epoch36,train total loss: 0.005206670013602632,  Spearman:0.678495706818577
Epoch36,val total loss: 0.00733596459031105,  Spearman:[0.5466666666666666]
Epoch36,test total loss: 0.02149485399508301,  Spearman is [0.17061076323901206],
Epoch37,train total loss: 0.004676146711109397,  Spearman:0.6822309127683787
Epoch37,val total loss: 0.0063538807444274426,  Spearman:[0.5295726495726496]
Epoch37,test total loss: 0.011872349334332873,  Spearman is [0.15967075051388852],
Epoch38,train total loss: 0.004179213144547807,  Spearman:0.6866707591001912
Epoch38,val total loss: 0.008109872229397297,  Spearman:[0.509059829059829]
Epoch38,test total loss: 0.02248829567585798,  Spearman is [0.19108480217268442],
Epoch39,train total loss: 0.0038404176940765376,  Spearman:0.6907080673008775
Epoch39,val total loss: 0.005258087068796158,  Spearman:[0.4297435897435897]
Epoch39,test total loss: 0.00846186259706669,  Spearman is [0.18731898316045378],
Epoch40,train total loss: 0.0036093855779677727,  Spearman:0.6981402231395684
Epoch40,val total loss: 0.004595398437231779,  Spearman:[0.45777777777777773]
Epoch40,test total loss: 0.009703176383696058,  Spearman is [0.1785030169652245],
Epoch41,train total loss: 0.0033925335375944343,  Spearman:0.6997180628086891
Epoch41,val total loss: 0.0043017929419875145,  Spearman:[0.4570940170940171]
Epoch41,test total loss: 0.014450972420437372,  Spearman is [0.17227759924978273],
Epoch42,train total loss: 0.0031238357963350913,  Spearman:0.706395552724764
Epoch42,val total loss: 0.003471213625743985,  Spearman:[0.4372649572649573]
Epoch42,test total loss: 0.012550061965799508,  Spearman is [0.17469986252341757],
Epoch43,train total loss: 0.0029176718533749525,  Spearman:0.7188393212854138
Epoch43,val total loss: 0.0033868385944515467,  Spearman:[0.4994871794871794]
Epoch43,test total loss: 0.015154459705466734,  Spearman is [0.17926178532476952],
Epoch44,train total loss: 0.002842206520234378,  Spearman:0.7163747415822009
Epoch44,val total loss: 0.0029910027515143156,  Spearman:[0.39829059829059826]
Epoch44,test total loss: 0.01242439288591199,  Spearman is [0.1670283863445433],
Epoch45,train total loss: 0.0027241085078388164,  Spearman:0.7160464223613088
Epoch45,val total loss: 0.005622085649520159,  Spearman:[0.45572649572649565]
Epoch45,test total loss: 0.021239325979395825,  Spearman is [0.16608615465392415],
Epoch46,train total loss: 0.0026513297086169655,  Spearman:0.7182765559837635
Epoch46,val total loss: 0.005426518153399229,  Spearman:[0.4564102564102564]
Epoch46,test total loss: 0.02028553976732142,  Spearman is [0.16357107253249895],
Epoch47,train total loss: 0.0026827652846128703,  Spearman:0.71764620837417
Epoch47,val total loss: 0.0033270781859755516,  Spearman:[0.3565811965811965]
Epoch47,test total loss: 0.00866389473188011,  Spearman is [0.15209193408296265],
Epoch48,train total loss: 0.002516846923614279,  Spearman:0.726818770917389
Epoch48,val total loss: 0.0030830376781523228,  Spearman:[0.4461538461538461]
Epoch48,test total loss: 0.013842198134893003,  Spearman is [0.16430685626821107],
Epoch49,train total loss: 0.0024581498351509278,  Spearman:0.7291666579720492
Epoch49,val total loss: 0.0041914344765245914,  Spearman:[0.3839316239316239]
Epoch49,test total loss: 0.013873396948089494,  Spearman is [0.1579787979414029],
Early stop at epoch 49
ensemble idx 0, best epoch 36, best validation spearman is 0.5466666666666666,best test spearman is [0.17060519474454403],

ensemble 1 models, fold 4, spearman is 0.17060519474454403, ndcg is 0.7754808175191786
ensemble 5 fold, for test dataset SaCas9-mean-3,spearman is 0.13601303888966002, ndcg is 0.7903625894078283
